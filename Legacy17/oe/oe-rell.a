/* ---------------------------------------------------------- oe/oe-rell.a bg */
/*                                                                            */
/* add module - order entry release lines                                     */
/*                                                                            */
/* -------------------------------------------------------------------------- */

/** Find last actual release for this order number and add 1 to
    the get the next release. **/
/* === rel-no logic moved to line (oe-rell) ========*/
DEF BUFFER bf-rell FOR oe-rell .
DEF VAR li-nxt-rel-no AS INT NO-UNDO.
for each bf-rell
    where bf-rell.company eq cocode
      and bf-rell.ord-no  eq oe-rel.ord-no no-lock 
      by bf-rell.rel-no desc:
    
      li-nxt-rel-no =  bf-rell.rel-no.
      leave.  
end.
li-nxt-rel-no = li-nxt-rel-no + 1.
/*========== */ 

create oe-rell.
assign
 oe-rell.company    = cocode
 fil_id             = recid(oe-rell)
 oe-rell.loc        = locode
 nufile             = true
 oe-rell.r-no       = oe-relh.r-no
 oe-rell.rel-no     = li-nxt-rel-no
 oe-rell.po-no      = oe-relh.po-no.

/* end ---------------------------------- copr. 1993  advanced software, inc. */
