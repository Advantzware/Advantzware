/* jobs.p - generated 12/02/2005 - 16:52:40 by NoSweat */

/* this program was generated by auditgn1.p and should not be modified */
/* modifications should be made to the auto generation program         */

DEFINE INPUT PARAMETER action AS CHARACTER NO-UNDO.

DEFINE VARIABLE i AS INTEGER NO-UNDO.

{methods/defines/audit.i}
FIND FIRST ttbl_header.

DEFINE WORK-TABLE ttbl_jobs1 NO-UNDO LIKE jobs.
DEFINE WORK-TABLE ttbl_jobs2 NO-UNDO LIKE jobs.

CREATE ttbl_jobs1.
IMPORT STREAM s_audit_file ttbl_jobs1.
CREATE ttbl_jobs2.
IF action = "UPDATE" THEN
IMPORT STREAM s_audit_file ttbl_jobs2.

PUT STREAM s-audit-rpt UNFORMATTED
  "Action    User ID/(User Name)            DB.Table/(Database)  Date       Time" SKIP
  "--------- ------------------------------ -------------------- ---------- --------" SKIP
  ttbl_header.v_action AT 1
  ttbl_header.v_userid AT 11
  ttbl_header.v_file AT 42
  ttbl_header.v_date FORMAT "99/99/9999" AT 63
  STRING(ttbl_header.v_time,"HH:MM:SS") AT 74.
FIND users WHERE users.user_id = v_userid NO-LOCK NO-ERROR.
IF AVAILABLE users THEN
PUT STREAM s-audit-rpt UNFORMATTED "(" AT 10 users.user_name ")".
ELSE
PUT STREAM s-audit-rpt UNFORMATTED "(user record does not exist)" AT 10.
PUT STREAM s-audit-rpt UNFORMATTED
  "(" AT 41 ttbl_header.v_db ")" SKIP(1)
  "Label: Value (database field-name)" AT 3.
IF action = "UPDATE" THEN
PUT STREAM s-audit-rpt UNFORMATTED " ( * - denotes field value change )".
PUT STREAM s-audit-rpt UNFORMATTED FILL("-",75) AT 3.
IF NOT v_field_changed OR ttbl_jobs1.address1 NE ttbl_jobs2.address1 OR action NE "UPDATE" THEN
DO:
  PUT STREAM s-audit-rpt UNFORMATTED "Customer Address1: " AT 3 ttbl_jobs1.address1 " (address1)".
  IF action = "UPDATE" THEN
  DO:
    IF ttbl_jobs1.address1 NE ttbl_jobs2.address1 THEN
    PUT STREAM s-audit-rpt UNFORMATTED "*" AT 1.
    PUT STREAM s-audit-rpt UNFORMATTED "Customer Address1: " AT 3 ttbl_jobs2.address1.
  END.
END.
IF NOT v_field_changed OR ttbl_jobs1.address2 NE ttbl_jobs2.address2 OR action NE "UPDATE" THEN
DO:
  PUT STREAM s-audit-rpt UNFORMATTED "Customer Address2: " AT 3 ttbl_jobs1.address2 " (address2)".
  IF action = "UPDATE" THEN
  DO:
    IF ttbl_jobs1.address2 NE ttbl_jobs2.address2 THEN
    PUT STREAM s-audit-rpt UNFORMATTED "*" AT 1.
    PUT STREAM s-audit-rpt UNFORMATTED "Customer Address2: " AT 3 ttbl_jobs2.address2.
  END.
END.
IF NOT v_field_changed OR ttbl_jobs1.cadcam_status NE ttbl_jobs2.cadcam_status OR action NE "UPDATE" THEN
DO:
  PUT STREAM s-audit-rpt UNFORMATTED "CADCAM Status: " AT 3 ttbl_jobs1.cadcam_status " (cadcam_status)".
  IF action = "UPDATE" THEN
  DO:
    IF ttbl_jobs1.cadcam_status NE ttbl_jobs2.cadcam_status THEN
    PUT STREAM s-audit-rpt UNFORMATTED "*" AT 1.
    PUT STREAM s-audit-rpt UNFORMATTED "CADCAM Status: " AT 3 ttbl_jobs2.cadcam_status.
  END.
END.
IF NOT v_field_changed OR ttbl_jobs1.city NE ttbl_jobs2.city OR action NE "UPDATE" THEN
DO:
  PUT STREAM s-audit-rpt UNFORMATTED "Customer City: " AT 3 ttbl_jobs1.city " (city)".
  IF action = "UPDATE" THEN
  DO:
    IF ttbl_jobs1.city NE ttbl_jobs2.city THEN
    PUT STREAM s-audit-rpt UNFORMATTED "*" AT 1.
    PUT STREAM s-audit-rpt UNFORMATTED "Customer City: " AT 3 ttbl_jobs2.city.
  END.
END.
IF NOT v_field_changed OR ttbl_jobs1.customer NE ttbl_jobs2.customer OR action NE "UPDATE" THEN
DO:
  PUT STREAM s-audit-rpt UNFORMATTED "Customer: " AT 3 ttbl_jobs1.customer " (customer)".
  IF action = "UPDATE" THEN
  DO:
    IF ttbl_jobs1.customer NE ttbl_jobs2.customer THEN
    PUT STREAM s-audit-rpt UNFORMATTED "*" AT 1.
    PUT STREAM s-audit-rpt UNFORMATTED "Customer: " AT 3 ttbl_jobs2.customer.
  END.
END.
IF NOT v_field_changed OR ttbl_jobs1.date_entered NE ttbl_jobs2.date_entered OR action NE "UPDATE" THEN
DO:
  PUT STREAM s-audit-rpt UNFORMATTED "Date Entered: " AT 3 ttbl_jobs1.date_entered FORMAT "99/99/9999" " (date_entered)".
  IF action = "UPDATE" THEN
  DO:
    IF ttbl_jobs1.date_entered NE ttbl_jobs2.date_entered THEN
    PUT STREAM s-audit-rpt UNFORMATTED "*" AT 1.
    PUT STREAM s-audit-rpt UNFORMATTED "Date Entered: " AT 3 ttbl_jobs2.date_entered FORMAT "99/99/9999".
  END.
END.
IF NOT v_field_changed OR ttbl_jobs1.estimate NE ttbl_jobs2.estimate OR action NE "UPDATE" THEN
DO:
  PUT STREAM s-audit-rpt UNFORMATTED "Estimate: " AT 3 ttbl_jobs1.estimate " (estimate)".
  IF action = "UPDATE" THEN
  DO:
    IF ttbl_jobs1.estimate NE ttbl_jobs2.estimate THEN
    PUT STREAM s-audit-rpt UNFORMATTED "*" AT 1.
    PUT STREAM s-audit-rpt UNFORMATTED "Estimate: " AT 3 ttbl_jobs2.estimate.
  END.
END.
IF NOT v_field_changed OR ttbl_jobs1.estimate_type NE ttbl_jobs2.estimate_type OR action NE "UPDATE" THEN
DO:
  PUT STREAM s-audit-rpt UNFORMATTED "Estimate Type: " AT 3 ttbl_jobs1.estimate_type FORMAT "9" " (estimate_type)".
  IF action = "UPDATE" THEN
  DO:
    IF ttbl_jobs1.estimate_type NE ttbl_jobs2.estimate_type THEN
    PUT STREAM s-audit-rpt UNFORMATTED "*" AT 1.
    PUT STREAM s-audit-rpt UNFORMATTED "Estimate Type: " AT 3 ttbl_jobs2.estimate_type FORMAT "9".
  END.
END.
IF NOT v_field_changed OR ttbl_jobs1.job NE ttbl_jobs2.job OR action NE "UPDATE" THEN
DO:
  PUT STREAM s-audit-rpt UNFORMATTED "Job Number: " AT 3 ttbl_jobs1.job " (job)".
  IF action = "UPDATE" THEN
  DO:
    IF ttbl_jobs1.job NE ttbl_jobs2.job THEN
    PUT STREAM s-audit-rpt UNFORMATTED "*" AT 1.
    PUT STREAM s-audit-rpt UNFORMATTED "Job Number: " AT 3 ttbl_jobs2.job.
  END.
END.
IF NOT v_field_changed OR ttbl_jobs1.name NE ttbl_jobs2.name OR action NE "UPDATE" THEN
DO:
  PUT STREAM s-audit-rpt UNFORMATTED "Customer Name: " AT 3 ttbl_jobs1.name " (name)".
  IF action = "UPDATE" THEN
  DO:
    IF ttbl_jobs1.name NE ttbl_jobs2.name THEN
    PUT STREAM s-audit-rpt UNFORMATTED "*" AT 1.
    PUT STREAM s-audit-rpt UNFORMATTED "Customer Name: " AT 3 ttbl_jobs2.name.
  END.
END.
IF NOT v_field_changed OR ttbl_jobs1.overrun NE ttbl_jobs2.overrun OR action NE "UPDATE" THEN
DO:
  PUT STREAM s-audit-rpt UNFORMATTED "Overrun: " AT 3 ttbl_jobs1.overrun FORMAT ">>9.9<%" " (overrun)".
  IF action = "UPDATE" THEN
  DO:
    IF ttbl_jobs1.overrun NE ttbl_jobs2.overrun THEN
    PUT STREAM s-audit-rpt UNFORMATTED "*" AT 1.
    PUT STREAM s-audit-rpt UNFORMATTED "Overrun: " AT 3 ttbl_jobs2.overrun FORMAT ">>9.9<%".
  END.
END.
IF NOT v_field_changed OR ttbl_jobs1.run_number NE ttbl_jobs2.run_number OR action NE "UPDATE" THEN
DO:
  PUT STREAM s-audit-rpt UNFORMATTED "Run Number: " AT 3 ttbl_jobs1.run_number FORMAT ">>9" " (run_number)".
  IF action = "UPDATE" THEN
  DO:
    IF ttbl_jobs1.run_number NE ttbl_jobs2.run_number THEN
    PUT STREAM s-audit-rpt UNFORMATTED "*" AT 1.
    PUT STREAM s-audit-rpt UNFORMATTED "Run Number: " AT 3 ttbl_jobs2.run_number FORMAT ">>9".
  END.
END.
IF NOT v_field_changed OR ttbl_jobs1.salesrep NE ttbl_jobs2.salesrep OR action NE "UPDATE" THEN
DO:
  PUT STREAM s-audit-rpt UNFORMATTED "Sales Rep(s): " AT 3 ttbl_jobs1.salesrep " (salesrep)".
  IF action = "UPDATE" THEN
  DO:
    IF ttbl_jobs1.salesrep NE ttbl_jobs2.salesrep THEN
    PUT STREAM s-audit-rpt UNFORMATTED "*" AT 1.
    PUT STREAM s-audit-rpt UNFORMATTED "Sales Rep(s): " AT 3 ttbl_jobs2.salesrep.
  END.
END.
IF NOT v_field_changed OR ttbl_jobs1.scheduling_status NE ttbl_jobs2.scheduling_status OR action NE "UPDATE" THEN
DO:
  PUT STREAM s-audit-rpt UNFORMATTED "Scheduling Status: " AT 3 ttbl_jobs1.scheduling_status " (scheduling_status)".
  IF action = "UPDATE" THEN
  DO:
    IF ttbl_jobs1.scheduling_status NE ttbl_jobs2.scheduling_status THEN
    PUT STREAM s-audit-rpt UNFORMATTED "*" AT 1.
    PUT STREAM s-audit-rpt UNFORMATTED "Scheduling Status: " AT 3 ttbl_jobs2.scheduling_status.
  END.
END.
IF NOT v_field_changed OR ttbl_jobs1.ship_address1 NE ttbl_jobs2.ship_address1 OR action NE "UPDATE" THEN
DO:
  PUT STREAM s-audit-rpt UNFORMATTED "Ship To Address1: " AT 3 ttbl_jobs1.ship_address1 " (ship_address1)".
  IF action = "UPDATE" THEN
  DO:
    IF ttbl_jobs1.ship_address1 NE ttbl_jobs2.ship_address1 THEN
    PUT STREAM s-audit-rpt UNFORMATTED "*" AT 1.
    PUT STREAM s-audit-rpt UNFORMATTED "Ship To Address1: " AT 3 ttbl_jobs2.ship_address1.
  END.
END.
IF NOT v_field_changed OR ttbl_jobs1.ship_address2 NE ttbl_jobs2.ship_address2 OR action NE "UPDATE" THEN
DO:
  PUT STREAM s-audit-rpt UNFORMATTED "Ship To Address2: " AT 3 ttbl_jobs1.ship_address2 " (ship_address2)".
  IF action = "UPDATE" THEN
  DO:
    IF ttbl_jobs1.ship_address2 NE ttbl_jobs2.ship_address2 THEN
    PUT STREAM s-audit-rpt UNFORMATTED "*" AT 1.
    PUT STREAM s-audit-rpt UNFORMATTED "Ship To Address2: " AT 3 ttbl_jobs2.ship_address2.
  END.
END.
IF NOT v_field_changed OR ttbl_jobs1.ship_city NE ttbl_jobs2.ship_city OR action NE "UPDATE" THEN
DO:
  PUT STREAM s-audit-rpt UNFORMATTED "Ship To City: " AT 3 ttbl_jobs1.ship_city " (ship_city)".
  IF action = "UPDATE" THEN
  DO:
    IF ttbl_jobs1.ship_city NE ttbl_jobs2.ship_city THEN
    PUT STREAM s-audit-rpt UNFORMATTED "*" AT 1.
    PUT STREAM s-audit-rpt UNFORMATTED "Ship To City: " AT 3 ttbl_jobs2.ship_city.
  END.
END.
IF NOT v_field_changed OR ttbl_jobs1.ship_name NE ttbl_jobs2.ship_name OR action NE "UPDATE" THEN
DO:
  PUT STREAM s-audit-rpt UNFORMATTED "Ship To Name: " AT 3 ttbl_jobs1.ship_name " (ship_name)".
  IF action = "UPDATE" THEN
  DO:
    IF ttbl_jobs1.ship_name NE ttbl_jobs2.ship_name THEN
    PUT STREAM s-audit-rpt UNFORMATTED "*" AT 1.
    PUT STREAM s-audit-rpt UNFORMATTED "Ship To Name: " AT 3 ttbl_jobs2.ship_name.
  END.
END.
IF NOT v_field_changed OR ttbl_jobs1.ship_state NE ttbl_jobs2.ship_state OR action NE "UPDATE" THEN
DO:
  PUT STREAM s-audit-rpt UNFORMATTED "Ship To State: " AT 3 ttbl_jobs1.ship_state " (ship_state)".
  IF action = "UPDATE" THEN
  DO:
    IF ttbl_jobs1.ship_state NE ttbl_jobs2.ship_state THEN
    PUT STREAM s-audit-rpt UNFORMATTED "*" AT 1.
    PUT STREAM s-audit-rpt UNFORMATTED "Ship To State: " AT 3 ttbl_jobs2.ship_state.
  END.
END.
IF NOT v_field_changed OR ttbl_jobs1.ship_zip NE ttbl_jobs2.ship_zip OR action NE "UPDATE" THEN
DO:
  PUT STREAM s-audit-rpt UNFORMATTED "Ship To Zip Code: " AT 3 ttbl_jobs1.ship_zip " (ship_zip)".
  IF action = "UPDATE" THEN
  DO:
    IF ttbl_jobs1.ship_zip NE ttbl_jobs2.ship_zip THEN
    PUT STREAM s-audit-rpt UNFORMATTED "*" AT 1.
    PUT STREAM s-audit-rpt UNFORMATTED "Ship To Zip Code: " AT 3 ttbl_jobs2.ship_zip.
  END.
END.
IF NOT v_field_changed OR ttbl_jobs1.state NE ttbl_jobs2.state OR action NE "UPDATE" THEN
DO:
  PUT STREAM s-audit-rpt UNFORMATTED "Customer State: " AT 3 ttbl_jobs1.state " (state)".
  IF action = "UPDATE" THEN
  DO:
    IF ttbl_jobs1.state NE ttbl_jobs2.state THEN
    PUT STREAM s-audit-rpt UNFORMATTED "*" AT 1.
    PUT STREAM s-audit-rpt UNFORMATTED "Customer State: " AT 3 ttbl_jobs2.state.
  END.
END.
IF NOT v_field_changed OR ttbl_jobs1.underrun NE ttbl_jobs2.underrun OR action NE "UPDATE" THEN
DO:
  PUT STREAM s-audit-rpt UNFORMATTED "Underrun: " AT 3 ttbl_jobs1.underrun FORMAT ">>9.9<%" " (underrun)".
  IF action = "UPDATE" THEN
  DO:
    IF ttbl_jobs1.underrun NE ttbl_jobs2.underrun THEN
    PUT STREAM s-audit-rpt UNFORMATTED "*" AT 1.
    PUT STREAM s-audit-rpt UNFORMATTED "Underrun: " AT 3 ttbl_jobs2.underrun FORMAT ">>9.9<%".
  END.
END.
IF NOT v_field_changed OR ttbl_jobs1.zip NE ttbl_jobs2.zip OR action NE "UPDATE" THEN
DO:
  PUT STREAM s-audit-rpt UNFORMATTED "Customer Zip Code: " AT 3 ttbl_jobs1.zip " (zip)".
  IF action = "UPDATE" THEN
  DO:
    IF ttbl_jobs1.zip NE ttbl_jobs2.zip THEN
    PUT STREAM s-audit-rpt UNFORMATTED "*" AT 1.
    PUT STREAM s-audit-rpt UNFORMATTED "Customer Zip Code: " AT 3 ttbl_jobs2.zip.
  END.
END.
IF v_show_index THEN
DO:
  PUT STREAM s-audit-rpt UNFORMATTED "Index Fields - Label: Value (database field-name)" AT 5.
  PUT STREAM s-audit-rpt UNFORMATTED "Job Number: " AT 7.
  IF action = "UPDATE" THEN
  PUT STREAM s-audit-rpt UNFORMATTED ttbl_jobs2.job " (job)".
  ELSE
  PUT STREAM s-audit-rpt UNFORMATTED ttbl_jobs1.job " (job)".
END.
PUT STREAM s-audit-rpt UNFORMATTED SKIP(1).
