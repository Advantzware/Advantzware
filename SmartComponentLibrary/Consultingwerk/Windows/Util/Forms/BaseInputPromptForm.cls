/**********************************************************************
 * Copyright (C) 2006-2013 by Consultingwerk Ltd. ("CW") -            *
 * www.consultingwerk.de and other contributors as listed             *
 * below.  All Rights Reserved.                                       *
 *                                                                    *
 *  Software is distributed on an "AS IS", WITHOUT WARRANTY OF ANY    *
 *   KIND, either express or implied.                                 *
 *                                                                    *
 *  Contributors:                                                     *
 *                                                                    *
 **********************************************************************/
/*------------------------------------------------------------------------
    File        : BaseInputPromptForm
    Purpose     : 
    Syntax      : 
    Description : 
    Author(s)   : Mike Fechner / Consultingwerk Ltd.
    Created     : Sun Aug 10 11:53:26 CEST 2008
    Notes       : 
  ----------------------------------------------------------------------*/

ROUTINE-LEVEL ON ERROR UNDO, THROW.

USING Consultingwerk.Forms.*              FROM PROPATH .
USING Consultingwerk.Util.Forms.*         FROM PROPATH .
USING Consultingwerk.Windows.Util.Forms.* FROM PROPATH .
USING Progress.Lang.*                     FROM PROPATH .

CLASS Consultingwerk.Windows.Util.Forms.BaseInputPromptForm 
    INHERITS System.Windows.Forms.Form: 
    
    DEFINE PRIVATE VARIABLE components AS System.ComponentModel.IContainer.

    DEFINE PROTECTED VARIABLE ultraGroupBox1 AS Infragistics.Win.Misc.UltraGroupBox NO-UNDO.

    DEFINE PRIVATE VARIABLE fiTitle AS Infragistics.Win.Misc.UltraLabel NO-UNDO.
    DEFINE PRIVATE VARIABLE fiDescription AS Infragistics.Win.Misc.UltraLabel NO-UNDO.

    DEFINE PROTECTED VARIABLE buOk AS Infragistics.Win.Misc.UltraButton NO-UNDO.
    DEFINE PROTECTED VARIABLE buCancel AS Infragistics.Win.Misc.UltraButton NO-UNDO.
        
    DEFINE VARIABLE oFullWindowDragManager AS FullWindowDragManager NO-UNDO EXTENT 2 .              

    /*------------------------------------------------------------------------------
        Purpose: Gets and sets the value of the description 
        Notes:                                                                        
    ------------------------------------------------------------------------------*/
    DEFINE PUBLIC PROPERTY Description AS CHARACTER NO-UNDO 
    GET:
        RETURN fiDescription:Text .
    END GET .  
    SET (arg AS CHARACTER):
        ASSIGN fiDescription:Text = arg .         
    END SET . 
            
    /*------------------------------------------------------------------------------
        Purpose: Gets and sets the value of the title 
        Notes:                                                                        
    ------------------------------------------------------------------------------*/
	DEFINE PUBLIC PROPERTY Title AS CHARACTER NO-UNDO 
    GET:
        RETURN fiTitle:Text .
    END GET .  
    SET (arg AS CHARACTER):
        ASSIGN fiTitle:Text = arg .         
    END SET . 
    /*------------------------------------------------------------------------------
        Purpose: Constructor of the BaseInputPromptForm class                                                              
        Notes:                                                                        
    ------------------------------------------------------------------------------*/
    CONSTRUCTOR PUBLIC BaseInputPromptForm ():
        
        SUPER().
        InitializeComponent ().

        ASSIGN oFullWindowDragManager[1] = NEW FullWindowDragManager (THIS-OBJECT) 
               oFullWindowDragManager[2] = NEW FullWindowDragManager (THIS-OBJECT:ultraGroupBox1) .

    END CONSTRUCTOR.

    /*------------------------------------------------------------------------------
        Purpose: Initializes the Visual Design                                                                        
        Notes:      
    ------------------------------------------------------------------------------*/
    METHOD PRIVATE VOID InitializeComponent ( ):

/*         NOTE: The following method is generated by the OpenEdge Advanced GUI Visual Designer.

        We strongly suggest that the contents of this method only be modified using the
        Visual Designer to avoid any incompatible modifications.

        Modifying the contents of this method using a code editor will invalidate any support for this file. */

        @VisualDesigner.FormMember (NeedsInitialize="true":U).
        DEFINE VARIABLE appearance1 AS Infragistics.Win.Appearance NO-UNDO.
        appearance1 = NEW Infragistics.Win.Appearance().
        @VisualDesigner.FormMember (NeedsInitialize="true":U).
        DEFINE VARIABLE appearance2 AS Infragistics.Win.Appearance NO-UNDO.
        appearance2 = NEW Infragistics.Win.Appearance().
        @VisualDesigner.FormMember (NeedsInitialize="true":U).
        DEFINE VARIABLE resources AS Progress.Util.ResourceManager NO-UNDO.
        resources = NEW Progress.Util.ResourceManager("Consultingwerk.Windows.Util.Forms.BaseInputPromptForm":U).
        THIS-OBJECT:ultraGroupBox1 = NEW Infragistics.Win.Misc.UltraGroupBox().
        THIS-OBJECT:buCancel = NEW Infragistics.Win.Misc.UltraButton().
        THIS-OBJECT:buOk = NEW Infragistics.Win.Misc.UltraButton().
        THIS-OBJECT:fiTitle = NEW Infragistics.Win.Misc.UltraLabel().
        THIS-OBJECT:fiDescription = NEW Infragistics.Win.Misc.UltraLabel().
        CAST(THIS-OBJECT:ultraGroupBox1, System.ComponentModel.ISupportInitialize):BeginInit().
        THIS-OBJECT:ultraGroupBox1:SuspendLayout().
        THIS-OBJECT:SuspendLayout().
        /*  */
        /* ultraGroupBox1 */
        /*  */
        DEFINE VARIABLE nestedvar0 AS System.Windows.Forms.AnchorStyles NO-UNDO.
        nestedvar0 = CAST(Progress.Util.EnumHelper:Or(System.Windows.Forms.AnchorStyles:Bottom, System.Windows.Forms.AnchorStyles:Left), System.Windows.Forms.AnchorStyles).
        THIS-OBJECT:ultraGroupBox1:Anchor = CAST(Progress.Util.EnumHelper:Or(nestedvar0, System.Windows.Forms.AnchorStyles:Right), System.Windows.Forms.AnchorStyles).
        appearance1:BackColor = System.Drawing.SystemColors:ButtonFace.
        THIS-OBJECT:ultraGroupBox1:Appearance = appearance1.
        THIS-OBJECT:ultraGroupBox1:BorderStyle = Infragistics.Win.Misc.GroupBoxBorderStyle:None.
        THIS-OBJECT:ultraGroupBox1:Controls:Add(THIS-OBJECT:buCancel).
        THIS-OBJECT:ultraGroupBox1:Controls:Add(THIS-OBJECT:buOk).
        THIS-OBJECT:ultraGroupBox1:Location = NEW System.Drawing.Point(0, 169).
        THIS-OBJECT:ultraGroupBox1:Name = "ultraGroupBox1":U.
        THIS-OBJECT:ultraGroupBox1:Size = NEW System.Drawing.Size(412, 44).
        THIS-OBJECT:ultraGroupBox1:TabIndex = 3.
        /*  */
        /* buCancel */
        /*  */
        DEFINE VARIABLE nestedvar1 AS System.Windows.Forms.AnchorStyles NO-UNDO.
        nestedvar1 = System.Windows.Forms.AnchorStyles:Top.
        THIS-OBJECT:buCancel:Anchor = CAST(Progress.Util.EnumHelper:Or(nestedvar1, System.Windows.Forms.AnchorStyles:Right), System.Windows.Forms.AnchorStyles).
        THIS-OBJECT:buCancel:DialogResult = System.Windows.Forms.DialogResult:Cancel.
        THIS-OBJECT:buCancel:Location = NEW System.Drawing.Point(329, 10).
        THIS-OBJECT:buCancel:Name = "buCancel":U.
        THIS-OBJECT:buCancel:Size = NEW System.Drawing.Size(75, 24).
        THIS-OBJECT:buCancel:TabIndex = 1.
        THIS-OBJECT:buCancel:Text = "&Cancel":U.
        /*  */
        /* buOk */
        /*  */
        DEFINE VARIABLE nestedvar2 AS System.Windows.Forms.AnchorStyles NO-UNDO.
        nestedvar2 = System.Windows.Forms.AnchorStyles:Top.
        THIS-OBJECT:buOk:Anchor = CAST(Progress.Util.EnumHelper:Or(nestedvar2, System.Windows.Forms.AnchorStyles:Right), System.Windows.Forms.AnchorStyles).
        THIS-OBJECT:buOk:DialogResult = System.Windows.Forms.DialogResult:OK.
        THIS-OBJECT:buOk:Location = NEW System.Drawing.Point(251, 10).
        THIS-OBJECT:buOk:Name = "buOk":U.
        THIS-OBJECT:buOk:Size = NEW System.Drawing.Size(75, 24).
        THIS-OBJECT:buOk:TabIndex = 0.
        THIS-OBJECT:buOk:Text = "&OK":U.
        /*  */
        /* fiTitle */
        /*  */
        DEFINE VARIABLE nestedvar3 AS System.Windows.Forms.AnchorStyles NO-UNDO.
        nestedvar3 = CAST(Progress.Util.EnumHelper:Or(System.Windows.Forms.AnchorStyles:Top, System.Windows.Forms.AnchorStyles:Left), System.Windows.Forms.AnchorStyles).
        THIS-OBJECT:fiTitle:Anchor = CAST(Progress.Util.EnumHelper:Or(nestedvar3, System.Windows.Forms.AnchorStyles:Right), System.Windows.Forms.AnchorStyles).
        appearance2:ForeColor = System.Drawing.SystemColors:HotTrack.
        THIS-OBJECT:fiTitle:Appearance = appearance2.
        THIS-OBJECT:fiTitle:Font = NEW System.Drawing.Font("Verdana":U, Progress.Util.CastUtil:ToSingle(10.5), System.Drawing.FontStyle:Regular, System.Drawing.GraphicsUnit:Point, System.Convert:ToByte(0)).
        THIS-OBJECT:fiTitle:Location = NEW System.Drawing.Point(12, 12).
        THIS-OBJECT:fiTitle:Name = "fiTitle":U.
        THIS-OBJECT:fiTitle:Size = NEW System.Drawing.Size(392, 23).
        THIS-OBJECT:fiTitle:TabIndex = 4.
        THIS-OBJECT:fiTitle:Text = "Mochten Sie diesen Prozess beenden?":U.
        /*  */
        /* fiDescription */
        /*  */
        DEFINE VARIABLE nestedvar4 AS System.Windows.Forms.AnchorStyles NO-UNDO.
        nestedvar4 = CAST(Progress.Util.EnumHelper:Or(System.Windows.Forms.AnchorStyles:Top, System.Windows.Forms.AnchorStyles:Left), System.Windows.Forms.AnchorStyles).
        THIS-OBJECT:fiDescription:Anchor = CAST(Progress.Util.EnumHelper:Or(nestedvar4, System.Windows.Forms.AnchorStyles:Right), System.Windows.Forms.AnchorStyles).
        THIS-OBJECT:fiDescription:Font = NEW System.Drawing.Font("Verdana":U, Progress.Util.CastUtil:ToSingle(8.5), System.Drawing.FontStyle:Regular, System.Drawing.GraphicsUnit:Point, System.Convert:ToByte(0)).
        THIS-OBJECT:fiDescription:Location = NEW System.Drawing.Point(12, 41).
        THIS-OBJECT:fiDescription:Name = "fiDescription":U.
        THIS-OBJECT:fiDescription:Size = NEW System.Drawing.Size(392, 71).
        THIS-OBJECT:fiDescription:TabIndex = 5.
        THIS-OBJECT:fiDescription:Text = resources:GetString("fiDescription.Text":U).
        /*  */
        /* BaseInputPromptForm */
        /*  */
        THIS-OBJECT:AcceptButton = THIS-OBJECT:buOk.
        THIS-OBJECT:BackColor = System.Drawing.SystemColors:HighlightText.
        THIS-OBJECT:CancelButton = THIS-OBJECT:buCancel.
        THIS-OBJECT:ClientSize = NEW System.Drawing.Size(412, 213).
        THIS-OBJECT:Controls:Add(THIS-OBJECT:fiDescription).
        THIS-OBJECT:Controls:Add(THIS-OBJECT:fiTitle).
        THIS-OBJECT:Controls:Add(THIS-OBJECT:ultraGroupBox1).
        THIS-OBJECT:StartPosition = System.Windows.Forms.FormStartPosition:CenterParent. 
        THIS-OBJECT:Icon = CAST(resources:GetObject("$this.Icon":U), System.Drawing.Icon).
        THIS-OBJECT:MinimumSize = NEW System.Drawing.Size(428, 249).
        THIS-OBJECT:Name = "BaseInputPromptForm":U.
        THIS-OBJECT:Text = "Input Prompt":U.
        CAST(THIS-OBJECT:ultraGroupBox1, System.ComponentModel.ISupportInitialize):EndInit().
        THIS-OBJECT:ultraGroupBox1:ResumeLayout(FALSE).
        THIS-OBJECT:ResumeLayout(FALSE).
        CATCH e AS Progress.Lang.Error:
            UNDO, THROW e.
        END CATCH.
    END METHOD.

    /*------------------------------------------------------------------------------
        Purpose: Destrcutor of the BaseInputPromptForm class.                                                                      
        Notes:                                                                        
    ------------------------------------------------------------------------------*/
    DESTRUCTOR PUBLIC BaseInputPromptForm ():

        IF VALID-OBJECT(components) THEN DO:
            CAST(components, System.IDisposable):Dispose().
        END.

        /* Mike Fechner, Consultingwerk Ltd. 05.08.2014
           SCL-392: Workaround to issue in OE11.4 with calling into 
                    GarbageCollectorHelper:DeleteObject(Object[])  */
        Consultingwerk.Util.GarbageCollectorHelper:DeleteObject (oFullWindowDragManager[1]) .
        Consultingwerk.Util.GarbageCollectorHelper:DeleteObject (oFullWindowDragManager[2]) .

    END DESTRUCTOR.

END CLASS.