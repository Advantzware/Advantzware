.\jcrep\d-tickt2.w                    06/07/2006 15:37:41   PROGRESS(R) Page 1   

{} Line Blk
-- ---- ---
      1     &ANALYZE-SUSPEND _VERSION-NUMBER UIB_v8r12 GUI
      2     &ANALYZE-RESUME
      3     &Scoped-define WINDOW-NAME CURRENT-WINDOW
      4     &Scoped-define FRAME-NAME Dialog-Frame
      5     &ANALYZE-SUSPEND _UIB-CODE-BLOCK _CUSTOM _DEFINITIONS Dialog-Frame 
      6     /*------------------------------------------------------------------
      6     ------
      7     
      8       File: 
      9     
     10       Description: Cost Estimating Control File
     11     
     12       Input Parameters:
     13           <none>
     14     
     15       Output Parameters:
     16           <none>
     17     
     18       Author: 
     19     
     20     --------------------------------------------------------------------
     20     ----*/
     21     /*          This .W file was created with the Progress UIB.         
     21         */
     22     /*------------------------------------------------------------------
     22     ----*/
     23     
     24     /* ***************************  Definitions  ***********************
     24     *** */
     25     
     26     /* Parameters Definitions ---                                       
     26         */
     27     
     28     DEF INPUT PARAM ip-job-no AS cha NO-UNDO.
     29     DEF INPUT PARAM ip-job-no2 AS INT NO-UNDO.
     30     
     31     /* Local Variable Definitions ---                                   
     31         */
     32     def var list-name as cha no-undo.
     33     DEFINE VARIABLE init-dir AS CHARACTER NO-UNDO.
     34     
     35     {methods/defines/hndldefs.i}
 1    1     /* hndldefs.i */
 1    2     
 1    3     /* handle is declared new & set in mainmenu.w */
 1    4     
 1    5     &IF DEFINED(UIB_is_Running) NE 0 &THEN
 1    6     &Scoped-define NEW NEW
 1    7     &ENDIF
 1    8     
 1    9     DEFINE {&NEW} SHARED VARIABLE miscflds_reckey AS CHARACTER.
.\jcrep\d-tickt2.w                    06/07/2006 15:37:41   PROGRESS(R) Page 2   

{} Line Blk
-- ---- ---
 1   10     DEFINE {&NEW} SHARED VARIABLE table_reckey AS CHARACTER.
 1   11     DEFINE {&NEW} SHARED VARIABLE Persistent-Handle AS HANDLE.
 1   12     DEFINE {&NEW} SHARED VARIABLE ListLogic-Handle AS HANDLE.
 1   13     DEFINE VARIABLE run-proc AS CHARACTER.
 1   14     DEFINE VARIABLE hsignature AS CHARACTER NO-UNDO.
 1   15     DEFINE VARIABLE char-hdl AS CHARACTER NO-UNDO.
 1   16     DEFINE VARIABLE phandle AS WIDGET-HANDLE NO-UNDO.
 1   17     DEFINE VARIABLE is-running AS LOGICAL NO-UNDO.
 1   18     DEFINE VARIABLE help-page AS INTEGER NO-UNDO.
 1   19     
 1   20     &IF DEFINED(UIB_is_Running) NE 0 &THEN
 1   21     RUN nosweat/persist.p PERSISTENT SET Persistent-Handle.
 1   22     RUN lstlogic/persist.p PERSISTENT SET ListLogic-Handle.
 1   23     &ENDIF
     35      
     36     {methods/prgsecur.i}
 1    1     /* prgsecur.i */
 1    2     
 1    3     {methods/defines/globdefs.i}
 2    1     /* globdefs.i */
 2    2     
 2    3     &IF DEFINED(UIB_is_Running) NE 0 &THEN
 2    4     &Scoped-define NEW NEW GLOBAL
 2    5     &ENDIF
 2    6     
 2    7     DEFINE {&NEW} SHARED VARIABLE g_lookup-var AS CHARACTER NO-UNDO.
 2    8     DEFINE {&NEW} SHARED VARIABLE g_track_usage AS LOGICAL NO-UNDO.
 2    9     DEFINE {&NEW} SHARED VARIABLE g_header_line AS CHARACTER NO-UNDO.
 2   10     DEFINE {&NEW} SHARED VARIABLE g_groups AS CHARACTER NO-UNDO.
 2   11     DEFINE {&NEW} SHARED VARIABLE init_menu AS LOGICAL NO-UNDO.
 2   12     DEFINE {&NEW} SHARED VARIABLE g_developer AS CHARACTER NO-UNDO.
 2   13     DEFINE {&NEW} SHARED VARIABLE g_version AS CHARACTER NO-UNDO.
 2   14     DEFINE {&NEW} SHARED VARIABLE g_rec_key AS CHARACTER NO-UNDO.
 2   15     DEFINE {&NEW} SHARED VARIABLE g_pageno AS INTEGER NO-UNDO.
 2   16     DEFINE {&NEW} SHARED VARIABLE g_mainmenu AS WIDGET-HANDLE NO-UNDO.
 2   17     
 2   18     g_lookup-var = "".
 2   19     
 2   20     &Scoped-define NEW {&NEW}
 2   21     {custom/globdefs.i}
 3    1     /* globdefs.i */
 3    2     
 3    3     DEFINE {&NEW} SHARED VARIABLE g_company AS CHARACTER NO-UNDO.
 3    4     DEFINE {&NEW} SHARED VARIABLE g_loc AS CHARACTER NO-UNDO.
 3    5     DEFINE {&NEW} SHARED VARIABLE g_sysdate AS DATE NO-UNDO.
 3    6     DEFINE {&NEW} SHARED VARIABLE g_period AS INTEGER NO-UNDO.
 3    7     DEFINE {&NEW} SHARED VARIABLE g_init AS LOGICAL NO-UNDO.
 3    8     DEFINE {&NEW} SHARED VARIABLE g_batch AS LOGICAL NO-UNDO.
 3    9     DEFINE {&NEW} SHARED VARIABLE g_batch-rowid AS rowid NO-UNDO.
 3   10     
 3   11     &IF '{&NEW}' = 'NEW GLOBAL' &THEN
.\jcrep\d-tickt2.w                    06/07/2006 15:37:41   PROGRESS(R) Page 3   

{} Line Blk
-- ---- ---
 3   12     ASSIGN
 3   13       g_init = yes
 3   14       g_sysdate = TODAY.
 3   15     &ENDIF
 2   21      
 1    3      
 1    4     
 1    5     DEFINE BUFFER b-prgrms FOR prgrms.
 1    6     
 1    7     DEFINE VARIABLE v-prgmname LIKE b-prgrms.prgmname NO-UNDO.
 1    8     DEFINE VARIABLE Audit_File AS CHARACTER NO-UNDO.
 1    9     DEFINE VARIABLE period_pos AS INTEGER NO-UNDO.
 1   10     DEFINE VARIABLE num-groups AS INTEGER NO-UNDO.
 1   11     DEFINE VARIABLE group-ok AS LOGICAL NO-UNDO.
 1   12     DEFINE VARIABLE access-close AS LOGICAL NO-UNDO.
 1   13     
 1   14     IF INDEX(PROGRAM-NAME(1),".uib") NE 0 OR
 1   15        INDEX(PROGRAM-NAME(1),".ab")  NE 0 OR
 1   16        INDEX(PROGRAM-NAME(1),".ped") NE 0 THEN
 1   17     v-prgmname = USERID("NOSWEAT") + "..".
 1   18     ELSE
 1   19     ASSIGN
 1   20       period_pos = INDEX(PROGRAM-NAME(1),".")
 1   21       v-prgmname = SUBSTR(PROGRAM-NAME(1),INDEX(PROGRAM-NAME(1),"/",peri
 1   21     od_pos - 9) + 1)
 1   22       v-prgmname = SUBSTR(v-prgmname,1,INDEX(v-prgmname,".")).
 1   23     
 1   24     FIND b-prgrms WHERE b-prgrms.prgmname = v-prgmname NO-LOCK NO-ERROR.
 1   25     IF AVAILABLE b-prgrms THEN
 1   26   1 DO:
 1   27   2   DO num-groups = 1 TO NUM-ENTRIES(g_groups):
 1   28   2     IF NOT CAN-DO(b-prgrms.can_run,ENTRY(num-groups,g_groups)) AND
 1   29            NOT CAN-DO(b-prgrms.can_update,ENTRY(num-groups,g_groups)) AN
 1   29   2 D
 1   30            NOT CAN-DO(b-prgrms.can_create,ENTRY(num-groups,g_groups)) AN
 1   30   2 D
 1   31            NOT CAN-DO(b-prgrms.can_delete,ENTRY(num-groups,g_groups)) TH
 1   31   2 EN
 1   32   2     NEXT.
 1   33   2     group-ok = yes.
 1   34   2     LEAVE.
 1   35   1   END.
 1   36   1   IF NOT CAN-DO(b-prgrms.can_run,USERID("NOSWEAT")) AND
 1   37   1      NOT CAN-DO(b-prgrms.can_update,USERID("NOSWEAT")) AND
 1   38   1      NOT CAN-DO(b-prgrms.can_create,USERID("NOSWEAT")) AND
 1   39          NOT CAN-DO(b-prgrms.can_delete,USERID("NOSWEAT")) AND NOT group
 1   39   1 -ok THEN
 1   40   2   DO:
 1   41         MESSAGE "Program :" PROGRAM-NAME(1) SKIP "Title :" b-prgrms.prgt
 1   41   2 itle SKIP(1)
 1   42             "Access to this Program Denied - Contact Systems Manager" VI
.\jcrep\d-tickt2.w                    06/07/2006 15:37:41   PROGRESS(R) Page 4   

{} Line Blk
-- ---- ---
 1   42   2 EW-AS ALERT-BOX ERROR.
 1   43         access-close = YES.    /* used later in methods/template/windows
 1   43   2 .i - local-initialize procedure */
 1   44   2 
 1   45   1   END.
 1   46     END. 
 1   47     ELSE
 1   48   1 DO: 
 1   49   1   MESSAGE "Program :" PROGRAM-NAME(1) SKIP(1)
 1   50           "Program Master Record Does Not Exist - Contact Systems Manage
 1   50   1 r" 
 1   51   1           VIEW-AS ALERT-BOX ERROR.
 1   52   1   RETURN.
 1   53     END.
     36      
     37     
     38     {custom/gcompany.i}
 1    1     /* gcompany.i */
 1    2     
 1    3     DEFINE VARIABLE gcompany AS CHARACTER NO-UNDO.
     38      
     39     {custom/gloc.i}
 1    1     /* gloc.i */
 1    2     
 1    3     DEFINE VARIABLE gloc AS CHARACTER NO-UNDO.
     39      
     40     {custom/getcmpny.i}
 1    1     /* getcmpny.i */
 1    2     
 1    3     RUN Get-Company IN Persistent-Handle (OUTPUT gcompany).
     40      
     41     {custom/getloc.i}
 1    1     /* getloc.i */
 1    2     
 1    3     RUN Get-Location IN Persistent-Handle (OUTPUT gloc).
     41      
     42     
     43     {sys/inc/var.i new shared}
 1    1     /* -------------------------------------------------- sys/inc/var.i 
 1    1     01/02 JLF */
 1    2     /*                                                                  
 1    2               */
 1    3     /* vars & constants include file                                    
 1    3               */
 1    4     /*                                                                  
 1    4               */
 1    5     /* -----------------------------------------------------------------
 1    5     --------- */
 1    6     
 1    7     def {1}new {2}shared var cocode     as   char  format "x(3)"  no-und
 1    7     o.
.\jcrep\d-tickt2.w                    06/07/2006 15:37:41   PROGRESS(R) Page 5   

{} Line Blk
-- ---- ---
 1    8     def {1}new {2}shared var locode     as   char  format "x(5)"  no-und
 1    8     o.
 1    9     
 1   10     def {1}new {2}shared var  x  as   int no-undo.
 1   11     def {1}new {2}shared var  y  as   int no-undo.
 1   12     DEF {1}new {2}shared VAR  k  as   int no-undo.
 1   13     
 1   14     def var i          as   int no-undo.
 1   15     def var j          as   int no-undo.
 1   16     
 1   17     def var z          as   int no-undo.
 1   18     def var xxx        as   dec no-undo.
 1   19     def var yyy        as   dec no-undo.
 1   20     def var zzz        as   dec no-undo.
 1   21     def var tmpstore   as   cha no-undo.
 1   22     
 1   23     /* end ---------------------------------- copr. 2001  advanced softw
 1   23     are, inc. */
 1   24     
     43      
     44     
     45     assign
     46      cocode = g_company
     47      locode = g_loc.
     48     
     49     DEF NEW SHARED VAR lv-qty AS int NO-UNDO.
     50     DEF NEW SHARED VAR qty AS INT NO-UNDO.
     51     DEF VAR lv-format-f AS CHAR NO-UNDO.
     52     DEF VAR lv-format-c AS CHAR NO-UNDO.
     53     
     54     {jcrep/r-ticket.i "new shared"}
 1    1     
 1    2     def {1}new shared var fjob-no         like job-hdr.job-no.
 1    3     def {1}new shared var tjob-no         like fjob-no init "zzzzzz".
 1    4     def {1}new shared var fjob-no2        like job-hdr.job-no2.
 1    5     def {1}new shared var tjob-no2        like fjob-no2 init 99.
 1    6     def {1}new shared var reprint         as   log format "Y/N".
 1    7     def {1}new shared var print-box       as   log format "Y/N".
 1    8     def {1}new shared var spec-list       as   CHAR.
     54      
     55     {custom/xprint.i}
 1    1     &ANALYZE-SUSPEND _VERSION-NUMBER UIB_v8r12
 1    2     &ANALYZE-RESUME
 1    3     &ANALYZE-SUSPEND _UIB-CODE-BLOCK _CUSTOM _DEFINITIONS Include 
 1    4     /*------------------------------------------------------------------
 1    4     ------
 1    5         File        : 
 1    6         Purpose     :
 1    7     
 1    8         Syntax      :
 1    9     
.\jcrep\d-tickt2.w                    06/07/2006 15:37:41   PROGRESS(R) Page 6   

{} Line Blk
-- ---- ---
 1   10         Description :
 1   11     
 1   12         Author(s)   :
 1   13         Created     :
 1   14         Notes       :
 1   15       ------------------------------------------------------------------
 1   15     ----*/
 1   16     /*          This .W file was created with the Progress AppBuilder.  
 1   16         */
 1   17     /*------------------------------------------------------------------
 1   17     ----*/
 1   18     
 1   19     /* ***************************  Definitions  ***********************
 1   19     *** */
 1   20     
 1   21     DEF VAR hxPrint         AS INT  NO-UNDO.        /* xPrint DLL Handle
 1   21      */
 1   22     DEF STREAM bxPrint.
 1   23     
 1   24     /* _UIB-CODE-BLOCK-END */
 1   25     &ANALYZE-RESUME
 1   26     
 1   27     
 1   28     &ANALYZE-SUSPEND _UIB-PREPROCESSOR-BLOCK 
 1   29     
 1   30     /* ********************  Preprocessor Definitions  *****************
 1   30     *** */
 1   31     
 1   32     
 1   33     
 1   34     /* _UIB-PREPROCESSOR-BLOCK-END */
 1   35     &ANALYZE-RESUME
 1   36     
 1   37     
 1   38     /* ************************  Function Prototypes *******************
 1   38     *** */
 1   39     
 1   40     &ANALYZE-SUSPEND _UIB-CODE-BLOCK _FUNCTION-FORWARD centerText Includ
 1   40     e 
 1   41     FUNCTION centerText RETURNS CHARACTER
 1   42       ( /* parameter-definitions */ myText as char, myFont as char, myLe
 1   42     ngth as decimal)  FORWARD.
 1   43     
 1   44     /* _UIB-CODE-BLOCK-END */
 1   45     &ANALYZE-RESUME
 1   46     
 1   47     &ANALYZE-SUSPEND _UIB-CODE-BLOCK _FUNCTION-FORWARD decimalALign Incl
 1   47     ude 
 1   48     FUNCTION decimalALign RETURNS CHARACTER
 1   49       ( myText as char, myFont as char, myLength as decimal )  FORWARD.
 1   50     
.\jcrep\d-tickt2.w                    06/07/2006 15:37:41   PROGRESS(R) Page 7   

{} Line Blk
-- ---- ---
 1   51     /* _UIB-CODE-BLOCK-END */
 1   52     &ANALYZE-RESUME
 1   53     
 1   54     &ANALYZE-SUSPEND _UIB-CODE-BLOCK _FUNCTION-FORWARD endLink Include 
 1   55     FUNCTION endLink RETURNS CHARACTER
 1   56       ( /* parameter-definitions */ )  FORWARD.
 1   57     
 1   58     /* _UIB-CODE-BLOCK-END */
 1   59     &ANALYZE-RESUME
 1   60     
 1   61     &ANALYZE-SUSPEND _UIB-CODE-BLOCK _FUNCTION-FORWARD getbackGround Inc
 1   61     lude 
 1   62     FUNCTION getbackGround RETURNS CHARACTER
 1   63       ( /* parameter-definitions */ A as CHAR )  FORWARD.
 1   64     
 1   65     /* _UIB-CODE-BLOCK-END */
 1   66     &ANALYZE-RESUME
 1   67     
 1   68     &ANALYZE-SUSPEND _UIB-CODE-BLOCK _FUNCTION-FORWARD linkto Include 
 1   69     FUNCTION linkto RETURNS CHARACTER
 1   70       ( /* parameter-definitions */ A as char)  FORWARD.
 1   71     
 1   72     /* _UIB-CODE-BLOCK-END */
 1   73     &ANALYZE-RESUME
 1   74     
 1   75     &ANALYZE-SUSPEND _UIB-CODE-BLOCK _FUNCTION-FORWARD mailto Include 
 1   76     FUNCTION mailto RETURNS CHARACTER
 1   77       ( /* parameter-definitions */ A as char)  FORWARD.
 1   78     
 1   79     /* _UIB-CODE-BLOCK-END */
 1   80     &ANALYZE-RESUME
 1   81     
 1   82     &ANALYZE-SUSPEND _UIB-CODE-BLOCK _FUNCTION-FORWARD reduce Include 
 1   83     FUNCTION reduce RETURNS CHARACTER
 1   84       ( /* parameter-definitions */ myText as char, myFont as char, myLe
 1   84     ngth as decimal)  FORWARD.
 1   85     
 1   86     /* _UIB-CODE-BLOCK-END */
 1   87     &ANALYZE-RESUME
 1   88     
 1   89     &ANALYZE-SUSPEND _UIB-CODE-BLOCK _FUNCTION-FORWARD rightJustify Incl
 1   89     ude 
 1   90     FUNCTION rightJustify RETURNS CHARACTER
 1   91       ( /* parameter-definitions */ myText as char, myFont as char, myLe
 1   91     ngth as decimal)  FORWARD.
 1   92     
 1   93     /* _UIB-CODE-BLOCK-END */
 1   94     &ANALYZE-RESUME
 1   95     
 1   96     
 1   97     /* *********************** Procedure Settings **********************
.\jcrep\d-tickt2.w                    06/07/2006 15:37:41   PROGRESS(R) Page 8   

{} Line Blk
-- ---- ---
 1   97     ** */
 1   98     
 1   99     &ANALYZE-SUSPEND _PROCEDURE-SETTINGS
 1  100     /* Settings for THIS-PROCEDURE
 1  101        Type: Include
 1  102        Allow: 
 1  103        Frames: 0
 1  104        Add Fields to: Neither
 1  105        Other Settings: INCLUDE-ONLY
 1  106      */
 1  107     &ANALYZE-RESUME _END-PROCEDURE-SETTINGS
 1  108     
 1  109     /* *************************  Create Window  ***********************
 1  109     *** */
 1  110     
 1  111     &ANALYZE-SUSPEND _CREATE-WINDOW
 1  112     /* DESIGN Window definition (used by the UIB) 
 1  113       CREATE WINDOW Include ASSIGN
 1  114              HEIGHT             = 15
 1  115              WIDTH              = 60.
 1  116     /* END WINDOW DEFINITION */
 1  117                                                                         
 1  117         */
 1  118     &ANALYZE-RESUME
 1  119     
 1  120      
 1  121     
 1  122     
 1  123     &ANALYZE-SUSPEND _UIB-CODE-BLOCK _CUSTOM _MAIN-BLOCK Include 
 1  124     
 1  125     
 1  126     /* ***************************  Main Block  ************************
 1  126     *** */
 1  127     
 1  128     /* _UIB-CODE-BLOCK-END */
 1  129     &ANALYZE-RESUME
 1  130     
 1  131     
 1  132     /* **********************  Internal Procedures  ********************
 1  132     *** */
 1  133     
 1  134     &ANALYZE-SUSPEND _UIB-CODE-BLOCK _PROCEDURE loadxPrint Include 
 1  135     PROCEDURE loadxPrint :
 1  136     /*------------------------------------------------------------------
 1  136     ------------
 1  137       Purpose:     
 1  138       Parameters:  <none>
 1  139       Notes:       
 1  140     --------------------------------------------------------------------
 1  140     ----------*/
 1  141     /*         Run loadLibraryA("xPrint.dll", output hxPrint). */
.\jcrep\d-tickt2.w                    06/07/2006 15:37:41   PROGRESS(R) Page 9   

{} Line Blk
-- ---- ---
 1  142     
 1  143     END PROCEDURE.
 1  144     
 1  145     /* _UIB-CODE-BLOCK-END */
 1  146     &ANALYZE-RESUME
 1  147     
 1  148     &ANALYZE-SUSPEND _UIB-CODE-BLOCK _PROCEDURE unloadxPrint Include 
 1  149     PROCEDURE unloadxPrint :
 1  150     /*------------------------------------------------------------------
 1  150     ------------
 1  151       Purpose:     
 1  152       Parameters:  <none>
 1  153       Notes:       
 1  154     --------------------------------------------------------------------
 1  154     ----------*/
 1  155     /* DEF VAR xretCode    AS INT NO-UNDO.            */
 1  156     /*                                                */
 1  157     /*     Run freeLibrary(hxPrint, OUTPUT xretCode). */
 1  158     
 1  159     END PROCEDURE.
 1  160     
 1  161     /* _UIB-CODE-BLOCK-END */
 1  162     &ANALYZE-RESUME
 1  163     
 1  164     &ANALYZE-SUSPEND _UIB-CODE-BLOCK _PROCEDURE windowsAPI Include 
 1  165     PROCEDURE windowsAPI :
 1  166     /*------------------------------------------------------------------
 1  166     ------------
 1  167       Purpose:     
 1  168       Parameters:  <none>
 1  169       Notes:       
 1  170     --------------------------------------------------------------------
 1  170     ----------*/
 1  171     
 1  172     END PROCEDURE.
 1  173     
 1  174     PROCEDURE LoadLibraryA EXTERNAL "KERNEL32" :
 1  175       DEFINE INPUT  PARAMETER libname AS CHAR.
 1  176       DEFINE RETURN PARAMETER hproc   AS LONG.
 1  177     END PROCEDURE.
 1  178     
 1  179     PROCEDURE FreeLibrary EXTERNAL "KERNEL32" :
 1  180       DEFINE INPUT  PARAMETER hproc       AS LONG.
 1  181       DEFINE RETURN PARAMETER ReturnValue AS LONG.
 1  182     END PROCEDURE.
 1  183     
 1  184     /* _UIB-CODE-BLOCK-END */
 1  185     &ANALYZE-RESUME
 1  186     
 1  187     &ANALYZE-SUSPEND _UIB-CODE-BLOCK _PROCEDURE xPrintAPI Include 
 1  188     PROCEDURE xPrintAPI :
.\jcrep\d-tickt2.w                    06/07/2006 15:37:41   PROGRESS(R) Page 10  

{} Line Blk
-- ---- ---
 1  189     /*------------------------------------------------------------------
 1  189     ------------
 1  190       Purpose:     
 1  191       Parameters:  <none>
 1  192       Notes:       March 2002: all exteranl procedures are now PERSISTEN
 1  192     T
 1  193     --------------------------------------------------------------------
 1  193     ----------*/
 1  194     
 1  195     END PROCEDURE.
 1  196     
 1  197     /*  xPRINT (4GL) entry points
 1  198         =======================*/
 1  199         
 1  200         
 1  201     PROCEDURE printFile EXTERNAL "xPrint.dll"           PERSISTENT :
 1  202         DEF INPUT PARAMETER A AS CHAR.
 1  203         END.
 1  204     
 1  205     PROCEDURE printFileStat EXTERNAL "xPrint.dll"       PERSISTENT :
 1  206         DEF INPUT PARAMETER  A AS CHAR.
 1  207         DEF OUTPUT parameter O as LONG.
 1  208         END.
 1  209             
 1  210     PROCEDURE printPDF EXTERNAL "xPrint.dll"            PERSISTENT :
 1  211         DEF INPUT PARAMETER A AS CHAR.
 1  212         DEF INPUT PARAMETER B AS CHAR.
 1  213         DEF INPUT PARAMETER C AS CHAR.
 1  214         END.
 1  215     
 1  216     PROCEDURE getPrinterList EXTERNAL "xPrint.dll"      PERSISTENT :
 1  217         DEF INPUT PARAMETER L   as LONG.
 1  218         DEF INPUT PARAMETER A   as MEMPTR.
 1  219         end.    
 1  220     
 1  221     PROCEDURE getPrinterFonts EXTERNAL "xPrint.dll"     PERSISTENT :
 1  222         DEF INPUT PARAMETER L   as LONG.
 1  223         DEF INPUT PARAMETER A   as MEMPTR.
 1  224         end.
 1  225         
 1  226     PROCEDURE getTextWidth EXTERNAL "xPrint.dll"        PERSISTENT :
 1  227         DEF INPUT PARAMETER myText   as char.
 1  228         DEF INPUT PARAMETER myFont   as char.
 1  229         DEF OUTPUT PARAMETER lengthInPixels  as LONG.
 1  230         end.
 1  231             
 1  232     PROCEDURE getPrinterRes EXTERNAL "xPrint.dll"       PERSISTENT :
 1  233         DEF OUTPUT PARAMETER PrinterResolution  as LONG.
 1  234         end.
 1  235     
 1  236     PROCEDURE getScreenRes EXTERNAL "xPrint.dll"        PERSISTENT :
.\jcrep\d-tickt2.w                    06/07/2006 15:37:41   PROGRESS(R) Page 11  

{} Line Blk
-- ---- ---
 1  237         DEF OUTPUT PARAMETER ScreenResolution  as LONG.
 1  238         end.
 1  239         
 1  240     PROCEDURE getScreenFonts EXTERNAL "xPrint.dll"      PERSISTENT :
 1  241         DEF INPUT PARAMETER L   as LONG.
 1  242         DEF INPUT PARAMETER A   as MEMPTR.
 1  243         end.
 1  244         
 1  245     PROCEDURE fontDialog EXTERNAL "xPrint.dll"          PERSISTENT :
 1  246         DEF INPUT PARAMETER L   as LONG.
 1  247         DEF INPUT PARAMETER A   as MEMPTR.
 1  248         DEF OUTPUT PARAMETER R  as LONG.
 1  249         end.
 1  250         
 1  251     PROCEDURE getTextHeight EXTERNAL "xPrint.dll"       PERSISTENT :
 1  252         def INPUT  parameter myText          as char.
 1  253         def INPUT  parameter myFont          as char.
 1  254         def INPUT  parameter lengthInPixels  as LONG.
 1  255         DEF OUTPUT PARAMETER numberOfLines   AS LONG.
 1  256         END.
 1  257         
 1  258     PROCEDURE xPrintVersion EXTERNAL "xPrint.dll"       PERSISTENT :
 1  259         DEF INPUT PARAMETER versionNumber   as MEMPTR.
 1  260         end.
 1  261     
 1  262     PROCEDURE getImageDim   EXTERNAL "xPrint.dll"       PERSISTENT :
 1  263         DEF INPUT PARAMETER A   as CHAR.
 1  264         DEF INPUT-OUTPUT PARAMETER H   as LONG.
 1  265         DEF INPUT-OUTPUT PARAMETER W   as LONG.
 1  266         end.
 1  267     
 1  268     PROCEDURE getLPI EXTERNAL "xPrint.dll"              PERSISTENT :
 1  269         DEF INPUT PARAMETER A AS CHAR.
 1  270         DEF INPUT PARAMETER B AS MEMPTR.
 1  271         END.
 1  272     
 1  273     PROCEDURE printerDialog EXTERNAL "xPrint.dll"       PERSISTENT :
 1  274         DEF INPUT PARAMETER A   as MEMPTR.
 1  275         end.
 1  276     
 1  277     PROCEDURE getPrinter EXTERNAL "xPrint.dll"          PERSISTENT :
 1  278         DEF INPUT PARAMETER A   as MEMPTR.
 1  279         end.
 1  280     
 1  281     PROCEDURE setPrinter EXTERNAL "xPrint.dll"          PERSISTENT :
 1  282         DEF INPUT PARAMETER A   as CHAR.
 1  283         end.
 1  284     
 1  285     PROCEDURE saveFromClipBoard EXTERNAL "xPrint.dll"       PERSISTENT :
 1  286         DEF INPUT PARAMETER  A AS CHAR.
 1  287         DEF OUTPUT parameter O as LONG.
.\jcrep\d-tickt2.w                    06/07/2006 15:37:41   PROGRESS(R) Page 12  

{} Line Blk
-- ---- ---
 1  288         END.
 1  289     
 1  290     /* _UIB-CODE-BLOCK-END */
 1  291     &ANALYZE-RESUME
 1  292     
 1  293     /* ************************  Function Implementations **************
 1  293     *** */
 1  294     
 1  295     &ANALYZE-SUSPEND _UIB-CODE-BLOCK _FUNCTION centerText Include 
 1  296     FUNCTION centerText RETURNS CHARACTER
 1  297       ( /* parameter-definitions */ myText as char, myFont as char, myLe
 1  297     ngth as decimal) :
 1  298     /*------------------------------------------------------------------
 1  298     ------------
 1  299       Purpose:  
 1  300         Notes:  Feb. 2002 : make usage of the <SAVE> and <RESTORE> tags 
 1  300     to allow millimeter
 1  301                             setting (<UNITS=MM>)
 1  302     --------------------------------------------------------------------
 1  302     ----------*/
 1  303     
 1  304     def var lengthOfFillChar    as int no-undo.
 1  305     def var lengthOfText        as int no-undo.
 1  306     def var NumberOfFillChar    as int no-undo.
 1  307     def var R                   as INT NO-undo.
 1  308     def var fillChar            as char no-undo initial " ".
 1  309         /* NOTE : if you want to use the '-' char, you have to set the P
 1  309     ROGRESS mode to off
 1  310                   with a </PROGRESS> tag
 1  311         */              
 1  312     def var printerRes          as INT  NO-UNDO.
 1  313     def var saveEuropean        as char NO-UNDO.
 1  314     def var returnValue         as char NO-UNDO.  
 1  315     
 1  316     
 1  317     /* get length of text in pixels             */
 1  318             run getTextWidth( myText, myFont, output lengthOfText).
 1  319     
 1  320     /* how many pixels are in my printable area ? */   
 1  321             run getPrinterRes( Output printerRes).
 1  322             R = printerRes * myLength.                   /* length of my
 1  322      area in pixels */   
 1  323           
 1  324     
 1  325     /* if fill character is a space, more precision is obtained by <AT> 
 1  325     tag than generating spaces.
 1  326             (You can comment this lines, because it's xPrint specific.) 
 1  326                                                                         
 1  326        
 1  327        =================================================================
 1  327     ========================================*/
.\jcrep\d-tickt2.w                    06/07/2006 15:37:41   PROGRESS(R) Page 13  

{} Line Blk
-- ---- ---
 1  328   1         if fillchar = " " then do :
 1  329                 saveEuropean = SESSION:numeric-format.      /* Don't for
 1  329   1 get the european users !                */
 1  330                 SESSION:numeric-format = "AMERICAN".        /* for ., se
 1  330   1 tting */
 1  331   1             returnValue = "<AT=,+"
 1  332                                     + string( (R - lengthofText) / 2 / p
 1  332   1 rinterRes )
 1  333   1                                 + ">" + myText.
 1  334   1             Session:NUMERIC-FORMAT = saveEuropean.
 1  335                 return "<SAVE=UNITS><UNITS=IN>" + returnValue + "<RESTOR
 1  335   1 E=UNITS>".
 1  336                 end.
 1  337     
 1  338     /* otherwise, return the centered text with fillchar left AND right 
 1  338     (if not a space)
 1  339        =================================================================
 1  339     ==============*/
 1  340         /* What's the length of the fill character ?    */      
 1  341             run getTextWidth( fillChar, myFont, output lengthOfFillChar)
 1  341     .
 1  342             
 1  343         /* Then the number of fill char to generate can be obtained with
 1  343         */        
 1  344             NumberOfFillChar = (R - lengthOfText) / 2 / lengthOfFillChar
 1  344     .
 1  345             
 1  346             RETURN fill(fillChar, NumberOfFillChar) + myText 
 1  347                         + (if fillchar <> " " then fill(fillchar, Number
 1  347     OfFillChar) else "")
 1  348                    .
 1  349     
 1  350     END FUNCTION.
 1  351     
 1  352     /* _UIB-CODE-BLOCK-END */
 1  353     &ANALYZE-RESUME
 1  354     
 1  355     &ANALYZE-SUSPEND _UIB-CODE-BLOCK _FUNCTION decimalALign Include 
 1  356     FUNCTION decimalALign RETURNS CHARACTER
 1  357       ( myText as char, myFont as char, myLength as decimal ) :
 1  358     /*------------------------------------------------------------------
 1  358     ------------
 1  359       Purpose:  
 1  360         Notes:  
 1  361     --------------------------------------------------------------------
 1  361     ----------*/
 1  362     DEF VAR I as int NO-UNDO.
 1  363     
 1  364             I = MAX( R-INDEX(myText, ","), R-INDEX(myText, ".")).   /* D
 1  364     etermine the decimal sign as the rightmost character */
 1  365     
.\jcrep\d-tickt2.w                    06/07/2006 15:37:41   PROGRESS(R) Page 14  

{} Line Blk
-- ---- ---
 1  366             IF I = 0 THEN                                       /* no si
 1  366     gn */
 1  367                     RETURN rightJustify(myText, myFont, myLength).
 1  368             else
 1  369                     RETURN RightJustify( SUBSTRING(myText, 1, I), myFont
 1  369     , myLength) + SUBSTRING(myText, I + 1).
 1  370     
 1  371     END FUNCTION.
 1  372     
 1  373     /* _UIB-CODE-BLOCK-END */
 1  374     &ANALYZE-RESUME
 1  375     
 1  376     &ANALYZE-SUSPEND _UIB-CODE-BLOCK _FUNCTION endLink Include 
 1  377     FUNCTION endLink RETURNS CHARACTER
 1  378       ( /* parameter-definitions */ ) :
 1  379     /*------------------------------------------------------------------
 1  379     ------------
 1  380       Purpose:  
 1  381         Notes:  
 1  382     --------------------------------------------------------------------
 1  382     ----------*/
 1  383     
 1  384       RETURN "<HTML-INSERT=\</A\>>".   /* Function return value. */
 1  385     
 1  386     END FUNCTION.
 1  387     
 1  388     /* _UIB-CODE-BLOCK-END */
 1  389     &ANALYZE-RESUME
 1  390     
 1  391     &ANALYZE-SUSPEND _UIB-CODE-BLOCK _FUNCTION getbackGround Include 
 1  392     FUNCTION getbackGround RETURNS CHARACTER
 1  393       ( /* parameter-definitions */ A as CHAR ) :
 1  394     /*------------------------------------------------------------------
 1  394     ------------
 1  395       Purpose:  
 1  396         Notes:  
 1  397     --------------------------------------------------------------------
 1  397     ----------*/
 1  398     Def var ReturnLines     as CHAR NO-UNDO.
 1  399     def var L               as CHAR NO-UNDO.
 1  400     
 1  401   1 IF SEARCH(A) = ? THEN DO :
 1  402   1          A = A + ".XPR".
 1  403   1          IF SEARCH(A) = ? THEN
 1  404   1                 RETURN "".
 1  405              END.
 1  406     
 1  407          FILE-INFO:FILE-NAME = A.
 1  408     
 1  409          Input stream bxPrint From value(File-INFO:FULL-PATHNAME) NO-ECH
 1  409     O.
.\jcrep\d-tickt2.w                    06/07/2006 15:37:41   PROGRESS(R) Page 15  

{} Line Blk
-- ---- ---
 1  410          
 1  411   1      Repeat :
 1  412   1            Import stream bxPrint unformatted L.
 1  413   1            
 1  414   1            ReturnLines = ReturnLines + chr(13) + L.
 1  415                end.
 1  416          
 1  417          Input stream bxPrint Close.
 1  418                
 1  419          Return Substring(ReturnLines, 2).
 1  420          end.
 1  421     
 1  422     /* _UIB-CODE-BLOCK-END */
 1  423     &ANALYZE-RESUME
 1  424     
 1  425     &ANALYZE-SUSPEND _UIB-CODE-BLOCK _FUNCTION linkto Include 
 1  426     FUNCTION linkto RETURNS CHARACTER
 1  427       ( /* parameter-definitions */ A as char) :
 1  428     /*------------------------------------------------------------------
 1  428     ------------
 1  429       Purpose:  
 1  430         Notes:  html syntax
 1  431                 <A HREF=www.4gl.fr>
 1  432     --------------------------------------------------------------------
 1  432     ----------*/
 1  433     
 1  434       Return 
 1  435             "<HTML-INSERT=\<A HREF=~"" + A + "~"\>>".
 1  436     
 1  437     END FUNCTION.
 1  438     
 1  439     /* _UIB-CODE-BLOCK-END */
 1  440     &ANALYZE-RESUME
 1  441     
 1  442     &ANALYZE-SUSPEND _UIB-CODE-BLOCK _FUNCTION mailto Include 
 1  443     FUNCTION mailto RETURNS CHARACTER
 1  444       ( /* parameter-definitions */ A as char) :
 1  445     /*------------------------------------------------------------------
 1  445     ------------
 1  446       Purpose:  
 1  447         Notes:  html syntax
 1  448                 <A HREF=mailto:info@4gl.fr>
 1  449     --------------------------------------------------------------------
 1  449     ----------*/
 1  450     
 1  451       Return 
 1  452             "<HTML-INSERT=\<A HREF=mailto:" + A + "\>>".
 1  453     
 1  454     END FUNCTION.
 1  455     
 1  456     /* _UIB-CODE-BLOCK-END */
.\jcrep\d-tickt2.w                    06/07/2006 15:37:41   PROGRESS(R) Page 16  

{} Line Blk
-- ---- ---
 1  457     &ANALYZE-RESUME
 1  458     
 1  459     &ANALYZE-SUSPEND _UIB-CODE-BLOCK _FUNCTION reduce Include 
 1  460     FUNCTION reduce RETURNS CHARACTER
 1  461       ( /* parameter-definitions */ myText as char, myFont as char, myLe
 1  461     ngth as decimal) :
 1  462     /*------------------------------------------------------------------
 1  462     ------------
 1  463       Purpose:  Reduce a text to fit in a given width
 1  464         Notes:  
 1  465     --------------------------------------------------------------------
 1  465     ----------*/
 1  466     def var lengthOfText        as INT NO-UNDO.
 1  467     def var R                   as INT NO-UNDO.          
 1  468     def var printerRes          as INT  NO-UNDO.
 1  469     
 1  470     /* how many pixels are in my printable area ? */   
 1  471             run getPrinterRes( Output printerRes).
 1  472             R = printerRes * myLength.                   /* length of my
 1  472      area in pixels */   
 1  473     
 1  474     
 1  475     /* get length of text in pixels             */
 1  476             run getTextWidth( myText, myFont, output lengthOfText).
 1  477     
 1  478     DO WHILE R < lengthOfText 
 1  479   1    AND myText > "" :
 1  480             mytext = SUBSTRING(myText, 1, LENGTH(myText) - 1).      /* r
 1  480   1 educe by 1 char */
 1  481   1         run getTextWidth( myText, myFont, output lengthOfText).
 1  482             END.
 1  483             
 1  484     RETURN myText.
 1  485             
 1  486     END FUNCTION.
 1  487     
 1  488     /* _UIB-CODE-BLOCK-END */
 1  489     &ANALYZE-RESUME
 1  490     
 1  491     &ANALYZE-SUSPEND _UIB-CODE-BLOCK _FUNCTION rightJustify Include 
 1  492     FUNCTION rightJustify RETURNS CHARACTER
 1  493       ( /* parameter-definitions */ myText as char, myFont as char, myLe
 1  493     ngth as decimal) :
 1  494     /*------------------------------------------------------------------
 1  494     ------------
 1  495       Purpose:  
 1  496         Notes:  
 1  497     --------------------------------------------------------------------
 1  497     ----------*/
 1  498     
 1  499     def var lengthOfFillChar    as int no-undo.
.\jcrep\d-tickt2.w                    06/07/2006 15:37:41   PROGRESS(R) Page 17  

{} Line Blk
-- ---- ---
 1  500     def var lengthOfText        as int no-undo.
 1  501     def var NumberOfFillChar    as int no-undo.
 1  502     def var R                   as INT NO-undo.
 1  503     def var fillChar            as char no-undo initial " ".
 1  504         /* NOTE : if you want to use the '-' char, you have to set the P
 1  504     ROGRESS mode to off
 1  505                   with a </PROGRESS> tag
 1  506         */              
 1  507     def var printerRes          as INT  NO-UNDO.
 1  508     def var saveEuropean        as char NO-UNDO.
 1  509     def var returnValue         as char NO-UNDO.  
 1  510     
 1  511     
 1  512     /* get length of text in pixels             */
 1  513             run getTextWidth( myText, myFont, output lengthOfText).
 1  514     
 1  515     /* how many pixels are in my printable area ? */   
 1  516             run getPrinterRes( Output printerRes).
 1  517             R = printerRes * myLength.                   /* length of my
 1  517      area in pixels */   
 1  518           
 1  519     
 1  520     /* if fill character is a space, more precision is obtained by <AT> 
 1  520     tag than generating spaces.
 1  521             (You can comment this lines, because it's xPrint specific.) 
 1  521                                                                         
 1  521        
 1  522        =================================================================
 1  522     ========================================*/
 1  523   1         if fillchar = " " then do :
 1  524                 saveEuropean = SESSION:numeric-format.      /* Don't for
 1  524   1 get the european users !                */
 1  525                 SESSION:numeric-format = "AMERICAN".        /* for ., se
 1  525   1 tting */
 1  526   1             returnValue = "<AT=,+"
 1  527                                     + string( (R - lengthofText)  / prin
 1  527   1 terRes )
 1  528   1                                 + ">" + myText.
 1  529   1             Session:numeric-format = saveEuropean.
 1  530                 RETURN "<SAVE=UNITS><UNITS=IN>" + returnValue + "<RESTOR
 1  530   1 E=UNITS>".
 1  531                 end.
 1  532     
 1  533     /* otherwise, return the centered text with fillchar left AND right 
 1  533     (if not a space)
 1  534        =================================================================
 1  534     ==============*/
 1  535         /* What's the length of the fill character ?    */      
 1  536             run getTextWidth( fillChar, myFont, output lengthOfFillChar)
 1  536     .
 1  537             
.\jcrep\d-tickt2.w                    06/07/2006 15:37:41   PROGRESS(R) Page 18  

{} Line Blk
-- ---- ---
 1  538         /* Then the number of fill char to generate can be obtained with
 1  538         */        
 1  539             NumberOfFillChar = (R - lengthOfText) / lengthOfFillChar.
 1  540             
 1  541             RETURN fill(fillChar, NumberOfFillChar) + myText 
 1  542                         + (if fillchar <> " " then fill(fillchar, Number
 1  542     OfFillChar) else "")
 1  543                    .
 1  544     
 1  545     END FUNCTION.
 1  546     
 1  547     /* _UIB-CODE-BLOCK-END */
 1  548     &ANALYZE-RESUME
 1  549     
     55      
     56     
     57     DEF NEW SHARED VAR s-prt-fgimage AS LOG NO-UNDO.
     58     DEF VAR is-xprint-form AS LOG NO-UNDO.
     59     DEF VAR ls-fax-file AS cha NO-UNDO.
     60     
     61     DEF NEW SHARED VAR s-prt-mstandard AS LOG NO-UNDO.
     62     DEF NEW SHARED VAR s-prt-shipto AS LOG NO-UNDO.
     63     DEF NEW SHARED VAR s-prt-sellprc AS LOG NO-UNDO.
     64     DEF NEW SHARED VAR s-run-speed AS LOG NO-UNDO.
     65     DEF NEW SHARED VAR s-committed-board-only AS LOG NO-UNDO.
     66     
     67     {cerep/jc-keyst.i "NEW"}
 1    1     /* cerep/jc-keyst.i*/
 1    2     DEF {1}NEW SHARED TEMP-TABLE tt-keyst FIELD tt-job-no LIKE job-hdr.j
 1    2     ob-no
 1    3                                        FIELD tt-job-no2 LIKE job-hdr.job
 1    3     -no2
 1    4                                        FIELD tt-frm LIKE job-hdr.frm
 1    5                                        FIELD tt-mill AS cha 
 1    6                                        FIELD tt-negs AS cha
 1    7                                        FIELD tt-plate AS cha EXTENT 2
 1    8                                        FIELD tt-die AS cha  EXTENT 2
 1    9                                        FIELD tt-copy AS cha
 1   10                                        FIELD tt-tray-desc AS cha
 1   11                                        FIELD tt-tray-qty AS INT
 1   12                                        FIELD tt-mb AS cha
 1   13                                        FIELD tt-newsize AS cha
 1   14                                        FIELD tt-aql AS cha
 1   15                                        FIELD tt-glue-cnt AS cha
 1   16                                        FIELD tt-plate2 AS cha
 1   17                                        FIELD tt-die2 AS cha
 1   18                                        FIELD tt-size AS cha.
     67      
     68     {cerep/jc-keys2.i "NEW"}
 1    1     /* cerep/jc-keys2.i*/
 1    2     DEF {1}NEW SHARED TEMP-TABLE tt-key2  FIELD tt-job-no AS cha
.\jcrep\d-tickt2.w                    06/07/2006 15:37:41   PROGRESS(R) Page 19  

{} Line Blk
-- ---- ---
 1    3                                        FIELD tt-job-no2 AS INT
 1    4                                        FIELD tt-i-no AS cha
 1    5                                        FIELD tt-frm AS INT
 1    6                                        FIELD tt-tray-desc AS cha
 1    7                                        FIELD tt-tray-qty AS INT
 1    8                                        FIELD tt-mb AS cha
 1    9                                        FIELD tt-newsize AS cha
 1   10                                        FIELD tt-aql AS cha
 1   11                                        FIELD tt-glue-cnt AS cha
 1   12                                        FIELD tt-style AS cha EXTENT 2
 1   13                                        FIELD tt-rowid AS ROWID.
     68      
     69     {cecrep/jc-prem.i "NEW"}
 1    1     /* cecrep/jc-prem.i*/
 1    2     DEF {1}NEW SHARED TEMP-TABLE tt-prem  FIELD tt-job-no LIKE job-hdr.j
 1    2     ob-no
 1    3                                        FIELD tt-job-no2 LIKE job-hdr.job
 1    3     -no2
 1    4                                        FIELD tt-frm LIKE job-hdr.frm
 1    5                                        FIELD tt-#-bundle AS cha 
 1    6                                        FIELD tt-#-unit AS cha
 1    7                                        FIELD tt-pattern AS cha 
 1    8                                        FIELD tt-pallet AS cha  
 1    9                                        .
     69      
     70     DEF VAR lv-pdf-file AS cha NO-UNDO.
     71     DEF NEW SHARED VAR s-prt-label AS LOG NO-UNDO.
     72     DEF NEW SHARED VAR s-prt-set-header AS LOG NO-UNDO.
     73     DEF NEW SHARED VAR s-prt-ship-split AS LOG NO-UNDO.
     74     {cecrep/jc-fibre.i "NEW"}
 1    1     /* cecrep/jc-fibre.i*/
 1    2     DEF {1}NEW SHARED TEMP-TABLE tt-fibre FIELD tt-job-no LIKE job-hdr.j
 1    2     ob-no
 1    3                                        FIELD tt-job-no2 LIKE job-hdr.job
 1    3     -no2
 1    4                                        FIELD tt-frm LIKE job-hdr.frm
 1    5                                        FIELD tt-blank LIKE job-hdr.blank
 1    5     -no
 1    6                                        FIELD tt-sqty1 AS INT
 1    7                                        FIELD tt-sqty2 AS INT
 1    8                                        FIELD tt-sqty3 AS INT
 1    9                                        FIELD tt-sqty4 AS INT
 1   10                                        FIELD tt-oqty1 AS INT
 1   11                                        FIELD tt-oqty2 AS INT
 1   12                                        FIELD tt-oqty3 AS INT
 1   13                                        FIELD tt-oqty4 AS INT
 1   14                                        FIELD tt-order1 AS INT
 1   15                                        FIELD tt-order2 AS INT
 1   16                                        FIELD tt-order3 AS INT
 1   17                                        FIELD tt-order4 AS INT
 1   18                                        .
.\jcrep\d-tickt2.w                    06/07/2006 15:37:41   PROGRESS(R) Page 20  

{} Line Blk
-- ---- ---
     74      
     75     
     76     /* _UIB-CODE-BLOCK-END */
     77     &ANALYZE-RESUME
     78     
     79     
     80     &ANALYZE-SUSPEND _UIB-PREPROCESSOR-BLOCK 
     81     
     82     /* ********************  Preprocessor Definitions  *****************
     82     *** */
     83     
     84     &Scoped-define PROCEDURE-TYPE Dialog-Box
     85     &Scoped-define DB-AWARE no
     86     
     87     /* Name of first Frame and/or Browse and/or first Query             
     87         */
     88     &Scoped-define FRAME-NAME Dialog-Frame
     89     
     90     /* Standard List Definitions                                        
     90         */
     91     &Scoped-Define ENABLED-OBJECTS RECT-42 RECT-6 RECT-7 begin_job1 begi
     91     n_job2 ~
     92     end_job1 end_job2 tb_fold tb_corr tb_reprint tb_box tb_fgimage spec_
     92     codes ~
     93     tb_prt-label tb_committed tb_prompt-ship tb_prt-set-header lines-per
     93     -page ~
     94     rd-dest lv-ornt td-show-parm btn-ok btn-cancel 
     95     &Scoped-Define DISPLAYED-OBJECTS begin_job1 begin_job2 end_job1 end_
     95     job2 ~
     96     tb_fold tb_corr tb_reprint tb_box tb_fgimage spec_codes tb_prt-mch ~
     97     rd_print-speed tb_prt-shipto tb_prt-sellprc tb_prt-label tb_committe
     97     d ~
     98     tb_prompt-ship tb_prt-set-header lines-per-page rd-dest lv-ornt lv-f
     98     ont-no ~
     99     lv-font-name td-show-parm v-run-speed 
    100     
    101     /* Custom List Definitions                                          
    101         */
    102     /* List-1,List-2,List-3,List-4,List-5,F1                            
    102         */
    103     &Scoped-define List-1 begin_job1 begin_job2 end_job1 end_job2 tb_rep
    103     rint ~
    104     tb_box tb_fgimage tb_prt-mch tb_prt-shipto tb_prt-sellprc tb_prt-lab
    104     el ~
    105     td-show-parm 
    106     
    107     /* _UIB-PREPROCESSOR-BLOCK-END */
    108     &ANALYZE-RESUME
    109     
    110     
    111     
.\jcrep\d-tickt2.w                    06/07/2006 15:37:41   PROGRESS(R) Page 21  

{} Line Blk
-- ---- ---
    112     /* ***********************  Control Definitions  *******************
    112     *** */
    113     
    114     /* Define a dialog box                                              
    114         */
    115     
    116     /* Definitions of the field level widgets                           
    116         */
    117     DEFINE BUTTON btn-cancel 
    118          LABEL "&Cancel" 
    119          SIZE 15 BY 1.14.
    120     
    121     DEFINE BUTTON btn-ok 
    122          LABEL "&OK" 
    123          SIZE 15 BY 1.14.
    124     
    125     DEFINE VARIABLE begin_job1 AS CHARACTER FORMAT "x(6)" 
    126          LABEL "Beginning  Job#" 
    127          VIEW-AS FILL-IN 
    128          SIZE 14 BY 1.
    129     
    130     DEFINE VARIABLE begin_job2 AS INTEGER FORMAT ">9" INITIAL 0 
    131          LABEL "-" 
    132          VIEW-AS FILL-IN 
    133          SIZE 5 BY 1.
    134     
    135     DEFINE VARIABLE end_job1 AS CHARACTER FORMAT "x(6)" INITIAL "zzzzzz"
    135      
    136          LABEL "Ending Job#" 
    137          VIEW-AS FILL-IN 
    138          SIZE 14 BY 1.
    139     
    140     DEFINE VARIABLE end_job2 AS INTEGER FORMAT ">9" INITIAL 99 
    141          LABEL "-" 
    142          VIEW-AS FILL-IN 
    143          SIZE 5 BY 1.
    144     
    145     DEFINE VARIABLE lines-per-page AS INTEGER FORMAT ">>":U INITIAL 99 
    146          LABEL "Lines Per Page" 
    147          VIEW-AS FILL-IN 
    148          SIZE 4 BY 1 NO-UNDO.
    149     
    150     DEFINE VARIABLE lv-font-name AS CHARACTER FORMAT "X(256)":U INITIAL 
    150     "Courier New Size=7 (17 cpi for 132 column Report)" 
    151          VIEW-AS FILL-IN 
    152          SIZE 62 BY 1 NO-UNDO.
    153     
    154     DEFINE VARIABLE lv-font-no AS CHARACTER FORMAT "X(256)":U INITIAL "1
    154     1" 
    155          LABEL "Font" 
    156          VIEW-AS FILL-IN 
.\jcrep\d-tickt2.w                    06/07/2006 15:37:41   PROGRESS(R) Page 22  

{} Line Blk
-- ---- ---
    157          SIZE 7 BY 1 NO-UNDO.
    158     
    159     DEFINE VARIABLE spec_codes AS CHARACTER FORMAT "X(256)":U INITIAL "Q
    159     A" 
    160          LABEL "Spec Codes" 
    161          VIEW-AS FILL-IN 
    162          SIZE 52 BY 1 NO-UNDO.
    163     
    164     DEFINE VARIABLE v-run-speed AS CHARACTER FORMAT "X(256)":U INITIAL "
    164     Print Machine's Speed or Run Hour ?" 
    165           VIEW-AS TEXT 
    166          SIZE 37 BY .62 NO-UNDO.
    167     
    168     DEFINE VARIABLE lv-ornt AS CHARACTER INITIAL "P" 
    169          VIEW-AS RADIO-SET HORIZONTAL
    170          RADIO-BUTTONS 
    171               "Portrait", "P",
    172     "Landscape", "L"
    173          SIZE 30 BY .95 NO-UNDO.
    174     
    175     DEFINE VARIABLE rd-dest AS INTEGER INITIAL 2 
    176          VIEW-AS RADIO-SET VERTICAL
    177          RADIO-BUTTONS 
    178               "To Printer", 1,
    179     "To Screen", 2,
    180     "To File", 3,
    181     "To Fax", 4,
    182     "To Email", 5,
    183     "To Port Directly", 6
    184          SIZE 19 BY 6.67 NO-UNDO.
    185     
    186     DEFINE VARIABLE rd_print-speed AS CHARACTER 
    187          VIEW-AS RADIO-SET HORIZONTAL
    188          RADIO-BUTTONS 
    189               "Speed", "S",
    190     "Run Hour", "H"
    191          SIZE 27 BY .95 NO-UNDO.
    192     
    193     DEFINE RECTANGLE RECT-42
    194          EDGE-PIXELS 2 GRAPHIC-EDGE  NO-FILL 
    195          SIZE 95 BY 14.76.
    196     
    197     DEFINE RECTANGLE RECT-6
    198          EDGE-PIXELS 2 GRAPHIC-EDGE  NO-FILL 
    199          SIZE 94 BY 8.1.
    200     
    201     DEFINE RECTANGLE RECT-7
    202          EDGE-PIXELS 2 GRAPHIC-EDGE  NO-FILL 
    203          SIZE 94 BY 25.
    204     
    205     DEFINE VARIABLE tb_box AS LOGICAL INITIAL yes 
.\jcrep\d-tickt2.w                    06/07/2006 15:37:41   PROGRESS(R) Page 23  

{} Line Blk
-- ---- ---
    206          LABEL "Print Box Design?" 
    207          VIEW-AS TOGGLE-BOX
    208          SIZE 22 BY 1 NO-UNDO.
    209     
    210     DEFINE VARIABLE tb_committed AS LOGICAL INITIAL no 
    211          LABEL "Print Only Committed Board?" 
    212          VIEW-AS TOGGLE-BOX
    213          SIZE 35 BY .81 NO-UNDO.
    214     
    215     DEFINE VARIABLE tb_corr AS LOGICAL INITIAL no 
    216          LABEL "Corrware" 
    217          VIEW-AS TOGGLE-BOX
    218          SIZE 13.4 BY 1 NO-UNDO.
    219     
    220     DEFINE VARIABLE tb_fgimage AS LOGICAL INITIAL no 
    221          LABEL "Print FG Item Image?" 
    222          VIEW-AS TOGGLE-BOX
    223          SIZE 26 BY 1 NO-UNDO.
    224     
    225     DEFINE VARIABLE tb_fold AS LOGICAL INITIAL no 
    226          LABEL "Foldware" 
    227          VIEW-AS TOGGLE-BOX
    228          SIZE 13.4 BY 1 NO-UNDO.
    229     
    230     DEFINE VARIABLE tb_prompt-ship AS LOGICAL INITIAL no 
    231          LABEL "Prompt Split Shipment or Split Order?" 
    232          VIEW-AS TOGGLE-BOX
    233          SIZE 44 BY .81 NO-UNDO.
    234     
    235     DEFINE VARIABLE tb_prt-label AS LOGICAL INITIAL no 
    236          LABEL "Print Label Info?" 
    237          VIEW-AS TOGGLE-BOX
    238          SIZE 31 BY 1 NO-UNDO.
    239     
    240     DEFINE VARIABLE tb_prt-mch AS LOGICAL INITIAL no 
    241          LABEL "Print Machine Standard?" 
    242          VIEW-AS TOGGLE-BOX
    243          SIZE 31 BY 1 NO-UNDO.
    244     
    245     DEFINE VARIABLE tb_prt-sellprc AS LOGICAL INITIAL no 
    246          LABEL "Print Sell Price in place of UPC#?" 
    247          VIEW-AS TOGGLE-BOX
    248          SIZE 40 BY 1 NO-UNDO.
    249     
    250     DEFINE VARIABLE tb_prt-set-header AS LOGICAL INITIAL no 
    251          LABEL "Print Set Unitization Page?" 
    252          VIEW-AS TOGGLE-BOX
    253          SIZE 35 BY .81 NO-UNDO.
    254     
    255     DEFINE VARIABLE tb_prt-shipto AS LOGICAL INITIAL no 
    256          LABEL "Print Shipto?" 
.\jcrep\d-tickt2.w                    06/07/2006 15:37:41   PROGRESS(R) Page 24  

{} Line Blk
-- ---- ---
    257          VIEW-AS TOGGLE-BOX
    258          SIZE 31 BY 1 NO-UNDO.
    259     
    260     DEFINE VARIABLE tb_reprint AS LOGICAL INITIAL no 
    261          LABEL "Reprint Tickets?" 
    262          VIEW-AS TOGGLE-BOX
    263          SIZE 21 BY 1 NO-UNDO.
    264     
    265     DEFINE VARIABLE td-show-parm AS LOGICAL INITIAL no 
    266          LABEL "Show Parameters?" 
    267          VIEW-AS TOGGLE-BOX
    268          SIZE 24 BY .81 NO-UNDO.
    269     
    270     
    271     /* ************************  Frame Definitions  ********************
    271     *** */
    272     
    273     DEFINE FRAME Dialog-Frame
    274          begin_job1 AT ROW 2.43 COL 22 COLON-ALIGNED HELP
    275               "Enter Beginning Job Number"
    276          begin_job2 AT ROW 2.43 COL 38 COLON-ALIGNED HELP
    277               "Enter Beginning Run#"
    278          end_job1 AT ROW 2.43 COL 64 COLON-ALIGNED HELP
    279               "Enter Ending Customer Number"
    280          end_job2 AT ROW 2.43 COL 80 COLON-ALIGNED HELP
    281               "Enter Ending Run#"
    282          tb_fold AT ROW 3.62 COL 37
    283          tb_corr AT ROW 4.57 COL 37
    284          tb_reprint AT ROW 5.76 COL 37
    285          tb_box AT ROW 6.71 COL 58 RIGHT-ALIGNED
    286          tb_fgimage AT ROW 7.67 COL 62 RIGHT-ALIGNED
    287          spec_codes AT ROW 8.62 COL 35 COLON-ALIGNED
    288          tb_prt-mch AT ROW 9.81 COL 37
    289          rd_print-speed AT ROW 10.76 COL 55 NO-LABEL
    290          tb_prt-shipto AT ROW 11.95 COL 8
    291          tb_prt-sellprc AT ROW 11.95 COL 46
    292          tb_prt-label AT ROW 13 COL 8
    293          tb_committed AT ROW 13 COL 46
    294          tb_prompt-ship AT ROW 13.86 COL 46
    295          tb_prt-set-header AT ROW 14.1 COL 8
    296          lines-per-page AT ROW 16.48 COL 54 COLON-ALIGNED
    297          rd-dest AT ROW 17.19 COL 5 NO-LABEL
    298          lv-ornt AT ROW 17.91 COL 31 NO-LABEL
    299          lv-font-no AT ROW 19.57 COL 35 COLON-ALIGNED
    300          lv-font-name AT ROW 20.52 COL 29 COLON-ALIGNED NO-LABEL
    301          td-show-parm AT ROW 22.19 COL 31
    302          btn-ok AT ROW 24.57 COL 24
    303          btn-cancel AT ROW 24.57 COL 58
    304          v-run-speed AT ROW 11 COL 15 COLON-ALIGNED NO-LABEL
    305          "Output Destination" VIEW-AS TEXT
    306               SIZE 18 BY .62 AT ROW 16.24 COL 3
.\jcrep\d-tickt2.w                    06/07/2006 15:37:41   PROGRESS(R) Page 25  

{} Line Blk
-- ---- ---
    307          "Selection Parameters" VIEW-AS TEXT
    308               SIZE 21 BY .71 AT ROW 1.24 COL 5
    309          RECT-42 AT ROW 1 COL 1
    310          RECT-6 AT ROW 16 COL 1
    311          RECT-7 AT ROW 1 COL 1
    312          SPACE(1.00) SKIP(0.13)
    313         WITH VIEW-AS DIALOG-BOX KEEP-TAB-ORDER 
    314              SIDE-LABELS NO-UNDERLINE THREE-D  SCROLLABLE 
    315              TITLE "".
    316     
    317     
    318     /* *********************** Procedure Settings **********************
    318     ** */
    319     
    320     &ANALYZE-SUSPEND _PROCEDURE-SETTINGS
    321     /* Settings for THIS-PROCEDURE
    322        Type: Dialog-Box
    323        Allow: Basic,Browse,DB-Fields,Query
    324        Other Settings: COMPILE
    325      */
    326     &ANALYZE-RESUME _END-PROCEDURE-SETTINGS
    327     
    328     
    329     
    330     /* ***********  Runtime Attributes and AppBuilder Settings  ********
    330     *** */
    331     
    332     &ANALYZE-SUSPEND _RUN-TIME-ATTRIBUTES
    333     /* SETTINGS FOR DIALOG-BOX Dialog-Frame
    334                                                                         
    334         */
    335     ASSIGN 
    336            FRAME Dialog-Frame:SCROLLABLE       = FALSE
    337            FRAME Dialog-Frame:HIDDEN           = TRUE.
    338     
    339     /* SETTINGS FOR FILL-IN begin_job1 IN FRAME Dialog-Frame
    340        1                                                                
    340         */
    341     ASSIGN 
    342            begin_job1:PRIVATE-DATA IN FRAME Dialog-Frame     = 
    343                     "parm".
    344     
    345     /* SETTINGS FOR FILL-IN begin_job2 IN FRAME Dialog-Frame
    346        1                                                                
    346         */
    347     ASSIGN 
    348            begin_job2:PRIVATE-DATA IN FRAME Dialog-Frame     = 
    349                     "parm".
    350     
    351     /* SETTINGS FOR FILL-IN end_job1 IN FRAME Dialog-Frame
    352        1                                                                
.\jcrep\d-tickt2.w                    06/07/2006 15:37:41   PROGRESS(R) Page 26  

{} Line Blk
-- ---- ---
    352         */
    353     ASSIGN 
    354            end_job1:PRIVATE-DATA IN FRAME Dialog-Frame     = 
    355                     "parm".
    356     
    357     /* SETTINGS FOR FILL-IN end_job2 IN FRAME Dialog-Frame
    358        1                                                                
    358         */
    359     ASSIGN 
    360            end_job2:PRIVATE-DATA IN FRAME Dialog-Frame     = 
    361                     "parm".
    362     
    363     /* SETTINGS FOR FILL-IN lv-font-name IN FRAME Dialog-Frame
    364        NO-ENABLE                                                        
    364         */
    365     /* SETTINGS FOR FILL-IN lv-font-no IN FRAME Dialog-Frame
    366        NO-ENABLE                                                        
    366         */
    367     /* SETTINGS FOR RADIO-SET rd_print-speed IN FRAME Dialog-Frame
    368        NO-ENABLE                                                        
    368         */
    369     /* SETTINGS FOR TOGGLE-BOX tb_box IN FRAME Dialog-Frame
    370        ALIGN-R 1                                                        
    370         */
    371     ASSIGN 
    372            tb_box:PRIVATE-DATA IN FRAME Dialog-Frame     = 
    373                     "parm".
    374     
    375     /* SETTINGS FOR TOGGLE-BOX tb_fgimage IN FRAME Dialog-Frame
    376        ALIGN-R 1                                                        
    376         */
    377     ASSIGN 
    378            tb_fgimage:PRIVATE-DATA IN FRAME Dialog-Frame     = 
    379                     "parm".
    380     
    381     /* SETTINGS FOR TOGGLE-BOX tb_prt-label IN FRAME Dialog-Frame
    382        1                                                                
    382         */
    383     ASSIGN 
    384            tb_prt-label:PRIVATE-DATA IN FRAME Dialog-Frame     = 
    385                     "parm".
    386     
    387     /* SETTINGS FOR TOGGLE-BOX tb_prt-mch IN FRAME Dialog-Frame
    388        NO-ENABLE 1                                                      
    388         */
    389     ASSIGN 
    390            tb_prt-mch:PRIVATE-DATA IN FRAME Dialog-Frame     = 
    391                     "parm".
    392     
    393     /* SETTINGS FOR TOGGLE-BOX tb_prt-sellprc IN FRAME Dialog-Frame
    394        NO-ENABLE 1                                                      
.\jcrep\d-tickt2.w                    06/07/2006 15:37:41   PROGRESS(R) Page 27  

{} Line Blk
-- ---- ---
    394         */
    395     ASSIGN 
    396            tb_prt-sellprc:PRIVATE-DATA IN FRAME Dialog-Frame     = 
    397                     "parm".
    398     
    399     /* SETTINGS FOR TOGGLE-BOX tb_prt-shipto IN FRAME Dialog-Frame
    400        NO-ENABLE 1                                                      
    400         */
    401     ASSIGN 
    402            tb_prt-shipto:PRIVATE-DATA IN FRAME Dialog-Frame     = 
    403                     "parm".
    404     
    405     /* SETTINGS FOR TOGGLE-BOX tb_reprint IN FRAME Dialog-Frame
    406        1                                                                
    406         */
    407     ASSIGN 
    408            tb_reprint:PRIVATE-DATA IN FRAME Dialog-Frame     = 
    409                     "parm".
    410     
    411     /* SETTINGS FOR TOGGLE-BOX td-show-parm IN FRAME Dialog-Frame
    412        1                                                                
    412         */
    413     /* SETTINGS FOR FILL-IN v-run-speed IN FRAME Dialog-Frame
    414        NO-ENABLE                                                        
    414         */
    415     /* _RUN-TIME-ATTRIBUTES-END */
    416     &ANALYZE-RESUME
    417     
    418      
    419     
    420     
    421     
    422     /* ************************  Control Triggers  *********************
    422     *** */
    423     
    424     &Scoped-define SELF-NAME Dialog-Frame
    425     &ANALYZE-SUSPEND _UIB-CODE-BLOCK _CONTROL Dialog-Frame Dialog-Frame
    426     ON RETURN OF FRAME Dialog-Frame
    427     ANYWHERE
    428     DO:
    429       
    430   1    IF SELF:TYPE <> "Button" THEN  do:
    431   1       APPLY "tab" TO SELF.
    432   1       RETURN NO-APPLY.
    433        END.
    434   1    ELSE do:
    435   1        APPLY "choose" TO self.
    436   1        RETURN NO-APPLY.
    437        END.
    438     END.
    439     
.\jcrep\d-tickt2.w                    06/07/2006 15:37:41   PROGRESS(R) Page 28  

{} Line Blk
-- ---- ---
    440     /* _UIB-CODE-BLOCK-END */
    441     &ANALYZE-RESUME
    442     
    443     
    444     &ANALYZE-SUSPEND _UIB-CODE-BLOCK _CONTROL Dialog-Frame Dialog-Frame
    445     ON WINDOW-CLOSE OF FRAME Dialog-Frame
    446     DO:
    447       APPLY "END-ERROR":U TO SELF.
    448     END.
    449     
    450     /* _UIB-CODE-BLOCK-END */
    451     &ANALYZE-RESUME
    452     
    453     
    454     &Scoped-define SELF-NAME begin_job1
    455     &ANALYZE-SUSPEND _UIB-CODE-BLOCK _CONTROL begin_job1 Dialog-Frame
    456     ON LEAVE OF begin_job1 IN FRAME Dialog-Frame /* Beginning  Job# */
    457     DO:
    458        assign {&self-name}begin_job1.
    459     END.
    460     
    461     /* _UIB-CODE-BLOCK-END */
    462     &ANALYZE-RESUME
    463     
    464     
    465     &Scoped-define SELF-NAME begin_job2
    466     &ANALYZE-SUSPEND _UIB-CODE-BLOCK _CONTROL begin_job2 Dialog-Frame
    467     ON LEAVE OF begin_job2 IN FRAME Dialog-Frame /* - */
    468     DO:
    469          assign {&self-name}begin_job2.
    470     END.
    471     
    472     /* _UIB-CODE-BLOCK-END */
    473     &ANALYZE-RESUME
    474     
    475     
    476     &Scoped-define SELF-NAME btn-cancel
    477     &ANALYZE-SUSPEND _UIB-CODE-BLOCK _CONTROL btn-cancel Dialog-Frame
    478     ON CHOOSE OF btn-cancel IN FRAME Dialog-Frame /* Cancel */
    479     DO:
    480        apply "close" to this-procedure.
    481     END.
    482     
    483     /* _UIB-CODE-BLOCK-END */
    484     &ANALYZE-RESUME
    485     
    486     
    487     &Scoped-define SELF-NAME btn-ok
    488     &ANALYZE-SUSPEND _UIB-CODE-BLOCK _CONTROL btn-ok Dialog-Frame
    489     ON CHOOSE OF btn-ok IN FRAME Dialog-Frame /* OK */
    490     DO:
.\jcrep\d-tickt2.w                    06/07/2006 15:37:41   PROGRESS(R) Page 29  

{} Line Blk
-- ---- ---
    491       DEF VAR hold-title AS CHAR NO-UNDO.
    492     
    493     
      1       ASSIGN {&DISPLAYED-OBJECTS}begin_job1 begin_job2 end_job1 end_job2
      1      tb_fold tb_corr tb_reprint tb_box tb_fgimage spec_codes tb_prt-mch 
      1     rd_print-speed tb_prt-shipto tb_prt-sellprc tb_prt-label tb_committe
      1     d tb_prompt-ship tb_prt-set-header lines-per-page rd-dest lv-ornt lv
    494     -font-no lv-font-name td-show-parm v-run-speed.
    495       
    496       
    497       ASSIGN s-prt-mstandard = tb_prt-mch
    498              s-prt-shipto  = tb_prt-shipto
    499              s-prt-sellprc = tb_prt-sellprc
    500              s-run-speed = rd_print-speed = "S" .
    501           
    502     
    503       hold-title = FRAME {&FRAME-NAME}Dialog-Frame:TITLE.
    504       
    505     
    506   1   IF tb_fold THEN DO:
    507   1     /*lines-per-page = IF lv-format-f EQ "HOP" THEN 64 ELSE 58. */
    508   1 
    509   1     RUN run-report ("Fold").
    510   1 
    511         FRAME {&FRAME-NAME}Dialog-Frame:TITLE = "Foldware " + TRIM(hold-
    511   1 title).
    512   1 
    513   1     case rd-dest:
    514   1        when 1 then run output-to-printer.
    515   2        when 2 then do:
    516   2            RUN output-to-screen.
    517   1        END.
    518   1        when 3 then run output-to-file.
    519   2        when 4 then do:
    520   2            /*run output-to-fax.*/
    521   2            {custom/asifax.i &begin_cust=begin_job1
    522   2                             &END_cust=END_job1
    523   2                             &fax-subject=hold-title
    524   2                             &fax-body=hold-title
    525   2                             &fax-file=list-name }
 1    1   2 /* custom/asifax.i FAx include file using Window Fax Console */
 1    2   2 DEF VAR fax-ret-code AS INT NO-UNDO.
 1    3     /*DEF VAR ls-fax-file AS cha NO-UNDO. defined from report generating
 1    3   2  program */
 1    4   2 DEF VAR lv-type AS cha NO-UNDO.
 1    5   2 
 1    6   3 IF "{&TYPE}" = "CUSTOMER"  THEN DO:
 1    7   4    IF {&begin_cust}begin_job1 <> {&end_cust}END_job1 THEN DO:
 1    8            MESSAGE "Beginning Customer and Ending Customer must be the s
 1    8   4 ame for Fax."
 1    9   4                     VIEW-AS ALERT-BOX ERROR.
.\jcrep\d-tickt2.w                    06/07/2006 15:37:41   PROGRESS(R) Page 30  

{} Line Blk
-- ---- ---
 1   10   4               APPLY "entry" TO {&END_cust}END_job1 .
 1   11   4               RETURN NO-APPLY.
 1   12   3    END.
 1   13   3    lv-type = "CUSTOMER".
 1   14   2 END.
 1   15   3 ELSE IF "{&TYPE}" = "VENDOR" THEN DO:
 1   16   4    IF {&begin_cust}begin_job1 <> {&end_cust}END_job1 THEN DO:
 1   17           MESSAGE "Beginning Vendor and Ending Vendor must be the same f
 1   17   4 or E-mail."
 1   18   4                     VIEW-AS ALERT-BOX ERROR.
 1   19   4               APPLY "entry" TO {&END_cust}END_job1 .
 1   20   4               RETURN NO-APPLY.
 1   21   3    END.
 1   22   3    lv-type = "VENDOR".
 1   23   2 END.
 1   24   3 ELSE IF "{&TYPE}" = "MULTI" THEN DO:
 1   25   3    lv-type = "MULTI".
 1   26   2 END.
 1   27   2 ELSE lv-type = "".
 1   28   2 
 1   29   2 
 1   30   2 ls-fax-file = "c:\tmp\fax" + STRING(TIME) + ".txt". 
 1   31   2 OS-COPY VALUE({&fax-file}list-name) VALUE(ls-fax-file).
 1   32   2 
 1   33   2 run custom/asifax.p (lv-type,ls-fax-file,{&begin_cust}begin_job1,
 1   34   2                                 '{&fax-subject}hold-title',
 1   35                                     '{&fax-body}hold-title',OUTPUT fax-r
 1   35   2 et-code).
 1   36   2 IF fax-ret-code <> 0 THEN
 1   37   2      MESSAGE "Error: " fax-ret-code view-as alert-box ERROR.
    525   2  
    526   1        END.
    527   2        when 5 then do:
    528   3            IF is-xprint-form THEN DO:
    529                   RUN printPDF (list-name, "ADVANCED SOFTWARE","A1g9f84a
    529   3 aq7479de4m22").
    530   3               {custom/asimail.i &TYPE = hold-title
    531   3                              &begin_cust= begin_job1
    532   3                              &END_cust=end_job1
    533   3                              &mail-subject=hold-title
    534   3                              &mail-body=hold-title
    535   3                              &mail-file=list-name }
 1    1     /* custom/asimail.i - shared by asimailr.i, asimail2.i and asimailr2
 1    1   3 .i */
 1    2   3 
 1    3   3 &SCOPED-DEFINE xpmailProgram custom/xpmail
 1    4   3 &SCOPED-DEFINE xpmailProgrm2 custom/xpmail2
 1    5   3 &SCOPED-DEFINE groupTitle ,
 1    6   3 
 1    7   3 &IF DEFINED(group-title) NE 0 &THEN
 1    8   3 &SCOPED-DEFINE xpmailProgram {&xpmailProgram}custom/xpmail2    
.\jcrep\d-tickt2.w                    06/07/2006 15:37:41   PROGRESS(R) Page 31  

{} Line Blk
-- ---- ---
 1    9   3 &SCOPED-DEFINE groupTitle ,{&group-title},    
 1   10   3 &ENDIF
 1   11   3 
 1   12   3 DEFINE VARIABLE ret-code{&two} AS INTEGER NO-UNDO.
 1   13   3 DEFINE VARIABLE ls-mail-file{&two} AS CHARACTER NO-UNDO.
 1   14   3 
 1   15   3 &IF '{&two}' EQ '' &THEN
 1   16   3 IF INDEX({&mail-file}list-name,'.pdf') EQ 0 THEN
 1   17   3 ls-mail-file{&two} = {&mail-file}list-name + '.pdf'.
 1   18   3 &ELSE
 1   19   3 ls-mail-file{&two} = 'c:\tmp\att' + STRING(TIME) + '.txt'. 
 1   20   3 OS-COPY VALUE({&mail-file}list-name) VALUE(ls-mail-file{&two}).
 1   21   3 &ENDIF
 1   22   3 
 1   23   4 DO WHILE TRUE:
 1   24       &IF '{&begin_cust}begin_job1' NE '' AND '{&end_cust}end_job1' NE '
 1   24   4 ' &THEN
 1   25   5   IF CAN-DO('Customer,Vendor','{&type}hold-title') THEN DO:
 1   26   6     IF {&begin_cust}begin_job1 NE {&end_cust}end_job1 THEN DO:
 1   27   6       FIND FIRST cust NO-LOCK WHERE cust.company EQ cocode
 1   28   6                                 AND cust.active EQ 'X' NO-ERROR.
 1   29   6       IF AVAILABLE cust THEN {&begin_cust}begin_job1 = cust.cust-no.
 1   30           RUN {&xpmailProgrm2}custom/xpmail2.p ("{&type}hold-title",v-pr
 1   30   6 gmname,ls-mail-file{&two},{&begin_cust}begin_job1,
 1   31                                   {&WINDOW-NAME}CURRENT-WINDOW:TITLE,{&W
 1   31   6 INDOW-NAME}CURRENT-WINDOW:TITLE,OUTPUT ret-code{&two}).
 1   32   6       LEAVE.
 1   33   5     END. /* if ne */
 1   34   4   END. /* if can-do */
 1   35   4   &ENDIF
 1   36   4   /*
 1   37   4   &IF '{&type}' EQ 'Customer' AND '{&begin_cust}' NE '' &THEN
 1   38   4   IF NOT CAN-FIND(cust WHERE cust.company EQ cocode
 1   39   4                          AND cust.cust-no EQ STRING({&begin_cust})
 1   40   4                          AND cust.active EQ 'E') THEN LEAVE.
 1   41   4   &ENDIF
 1   42   4   */
 1   43       RUN {&xpmailProgram}custom/xpmail.p ("{&type}hold-title"{&groupTit
 1   43   4 le},ls-mail-file{&two},{&begin_cust}begin_job1,
 1   44                               {&WINDOW-NAME}CURRENT-WINDOW:TITLE,{&WINDO
 1   44   4 W-NAME}CURRENT-WINDOW:TITLE,OUTPUT ret-code{&two}).
 1   45   4   LEAVE.
 1   46   3 END. /* do while */
    535   3  
    536   2            END.
    537   3            ELSE DO:
    538   3                {custom/asimailr.i &TYPE = hold-title
    539   3                                   &begin_cust= begin_job1
    540   3                                   &END_cust=end_job1
    541   3                                   &mail-subject=hold-title
    542   3                                   &mail-body=hold-title
.\jcrep\d-tickt2.w                    06/07/2006 15:37:41   PROGRESS(R) Page 32  

{} Line Blk
-- ---- ---
    543   3                                   &mail-file=list-name }
 1    1     /* custom/asimailr.i  include file for reports using txt extention *
 1    1   3 /
 1    2   3 
 1    3   3 &SCOPED-DEFINE type {&type}hold-title
 1    4   3 &SCOPED-DEFINE begin_cust {&begin_cust}begin_job1
 1    5   3 &SCOPED-DEFINE end_cust {&end_cust}end_job1
 1    6   3 &SCOPED-DEFINE mail-subject {&mail-subject}hold-title
 1    7   3 &SCOPED-DEFINE mail-body {&mail-body}hold-title
 1    8   3 &SCOPED-DEFINE mail-file {&mail-file}list-name
 1    9   3 
 1   10   3 {custom/asimail.i &two=2}
 2    1     /* custom/asimail.i - shared by asimailr.i, asimail2.i and asimailr2
 2    1   3 .i */
 2    2   3 
 2    3   3 &SCOPED-DEFINE xpmailProgram custom/xpmail
 2    4   3 &SCOPED-DEFINE xpmailProgrm2 custom/xpmail2
 2    5   3 &SCOPED-DEFINE groupTitle ,
 2    6   3 
 2    7   3 &IF DEFINED(group-title) NE 0 &THEN
 2    8   3 &SCOPED-DEFINE xpmailProgram {&xpmailProgram}custom/xpmail2    
 2    9   3 &SCOPED-DEFINE groupTitle ,{&group-title},    
 2   10   3 &ENDIF
 2   11   3 
 2   12   3 DEFINE VARIABLE ret-code{&two}2 AS INTEGER NO-UNDO.
 2   13   3 DEFINE VARIABLE ls-mail-file{&two}2 AS CHARACTER NO-UNDO.
 2   14   3 
 2   15   3 &IF '{&two}2' EQ '' &THEN
 2   16   3 IF INDEX({&mail-file}list-name,'.pdf') EQ 0 THEN
 2   17   3 ls-mail-file{&two}2 = {&mail-file}list-name + '.pdf'.
 2   18   3 &ELSE
 2   19   3 ls-mail-file{&two}2 = 'c:\tmp\att' + STRING(TIME) + '.txt'. 
 2   20   3 OS-COPY VALUE({&mail-file}list-name) VALUE(ls-mail-file{&two}2).
 2   21   3 &ENDIF
 2   22   3 
 2   23   4 DO WHILE TRUE:
 2   24       &IF '{&begin_cust}begin_job1' NE '' AND '{&end_cust}end_job1' NE '
 2   24   4 ' &THEN
 2   25   5   IF CAN-DO('Customer,Vendor','{&type}hold-title') THEN DO:
 2   26   6     IF {&begin_cust}begin_job1 NE {&end_cust}end_job1 THEN DO:
 2   27   6       FIND FIRST cust NO-LOCK WHERE cust.company EQ cocode
 2   28   6                                 AND cust.active EQ 'X' NO-ERROR.
 2   29   6       IF AVAILABLE cust THEN {&begin_cust}begin_job1 = cust.cust-no.
 2   30           RUN {&xpmailProgrm2}custom/xpmail2.p ("{&type}hold-title",v-pr
 2   30   6 gmname,ls-mail-file{&two}2,{&begin_cust}begin_job1,
 2   31                                   {&WINDOW-NAME}CURRENT-WINDOW:TITLE,{&W
 2   31   6 INDOW-NAME}CURRENT-WINDOW:TITLE,OUTPUT ret-code{&two}2).
 2   32   6       LEAVE.
 2   33   5     END. /* if ne */
 2   34   4   END. /* if can-do */
 2   35   4   &ENDIF
.\jcrep\d-tickt2.w                    06/07/2006 15:37:41   PROGRESS(R) Page 33  

{} Line Blk
-- ---- ---
 2   36   4   /*
 2   37   4   &IF '{&type}' EQ 'Customer' AND '{&begin_cust}' NE '' &THEN
 2   38   4   IF NOT CAN-FIND(cust WHERE cust.company EQ cocode
 2   39   4                          AND cust.cust-no EQ STRING({&begin_cust})
 2   40   4                          AND cust.active EQ 'E') THEN LEAVE.
 2   41   4   &ENDIF
 2   42   4   */
 2   43       RUN {&xpmailProgram}custom/xpmail.p ("{&type}hold-title"{&groupTit
 2   43   4 le},ls-mail-file{&two}2,{&begin_cust}begin_job1,
 2   44                               {&WINDOW-NAME}CURRENT-WINDOW:TITLE,{&WINDO
 2   44   4 W-NAME}CURRENT-WINDOW:TITLE,OUTPUT ret-code{&two}2).
 2   45   4   LEAVE.
 2   46   3 END. /* do while */
 1   10   3  
    543   3  
    544   3 
    545   2            END.
    546   2  
    547   1        END. 
    548   1        WHEN 6 THEN run output-to-port.
    549   1   end case. 
    550   1 
    551   1     FRAME {&frame-name}Dialog-Frame:TITLE = hold-title.
    552       END.
    553     
    554   1   IF tb_corr THEN DO:
    555   1     /*lines-per-page = 0. ??? */
    556   1 
    557   1     RUN run-report ("Corr").
    558   1 
    559         FRAME {&frame-name}Dialog-Frame:TITLE = "Corrware " + TRIM(FRAME
    559   1  {&frame-name}Dialog-Frame:TITLE).
    560   1 
    561   1     case rd-dest:
    562   1        when 1 then run output-to-printer.
    563   2        when 2 then do:
    564   2            RUN output-to-screen.      
    565   1        END.
    566   1        when 3 then run output-to-file.
    567   1        when 4 then run output-to-fax.
    568   1        when 5 THEN RUN OUTPUT-to-mail.
    569   1        WHEN 6 THEN run output-to-port.
    570   1   end case. 
    571   1       FRAME {&frame-name}Dialog-Frame:TITLE = hold-title.      
    572       END.
    573       
    574   1   IF rd-dest = 2  THEN DO:
    575   1       /* not working well. keep running background
    576   1        APPLY "close":U TO this-procedure.
    577   1        RETURN NO-APPLY. 
    578   1       */  
.\jcrep\d-tickt2.w                    06/07/2006 15:37:41   PROGRESS(R) Page 34  

{} Line Blk
-- ---- ---
    579   1       APPLY "entry" TO btn-cancel.
    580        END.
    581       
    582     END.
    583     
    584     /* _UIB-CODE-BLOCK-END */
    585     &ANALYZE-RESUME
    586     
    587     
    588     &Scoped-define SELF-NAME end_job1
    589     &ANALYZE-SUSPEND _UIB-CODE-BLOCK _CONTROL end_job1 Dialog-Frame
    590     ON LEAVE OF end_job1 IN FRAME Dialog-Frame /* Ending Job# */
    591     DO:
    592          assign {&self-name}end_job1.
    593     END.
    594     
    595     /* _UIB-CODE-BLOCK-END */
    596     &ANALYZE-RESUME
    597     
    598     
    599     &Scoped-define SELF-NAME end_job2
    600     &ANALYZE-SUSPEND _UIB-CODE-BLOCK _CONTROL end_job2 Dialog-Frame
    601     ON LEAVE OF end_job2 IN FRAME Dialog-Frame /* - */
    602     DO:
    603          assign {&self-name}end_job2.
    604     END.
    605     
    606     /* _UIB-CODE-BLOCK-END */
    607     &ANALYZE-RESUME
    608     
    609     
    610     &Scoped-define SELF-NAME lines-per-page
    611     &ANALYZE-SUSPEND _UIB-CODE-BLOCK _CONTROL lines-per-page Dialog-Fram
    611     e
    612     ON LEAVE OF lines-per-page IN FRAME Dialog-Frame /* Lines Per Page *
    612     /
    613     DO:
    614       assign {&self-name}lines-per-page.
    615     END.
    616     
    617     /* _UIB-CODE-BLOCK-END */
    618     &ANALYZE-RESUME
    619     
    620     
    621     &Scoped-define SELF-NAME lv-font-no
    622     &ANALYZE-SUSPEND _UIB-CODE-BLOCK _CONTROL lv-font-no Dialog-Frame
    623     ON HELP OF lv-font-no IN FRAME Dialog-Frame /* Font */
    624     DO:
    625         DEF VAR char-val AS cha NO-UNDO.
    626     
    627         RUN WINDOWS/l-fonts.w (FOCUS:SCREEN-VALUE, OUTPUT char-val).
.\jcrep\d-tickt2.w                    06/07/2006 15:37:41   PROGRESS(R) Page 35  

{} Line Blk
-- ---- ---
    628         IF char-val <> "" THEN ASSIGN FOCUS:SCREEN-VALUE = ENTRY(1,char-
    628     val)
    629                                       LV-FONT-NAME:SCREEN-VALUE = ENTRY(
    629     2,char-val).
    630     
    631     END.
    632     
    633     /* _UIB-CODE-BLOCK-END */
    634     &ANALYZE-RESUME
    635     
    636     
    637     &ANALYZE-SUSPEND _UIB-CODE-BLOCK _CONTROL lv-font-no Dialog-Frame
    638     ON LEAVE OF lv-font-no IN FRAME Dialog-Frame /* Font */
    639     DO:
    640        ASSIGN lv-font-no.
    641     END.
    642     
    643     /* _UIB-CODE-BLOCK-END */
    644     &ANALYZE-RESUME
    645     
    646     
    647     &Scoped-define SELF-NAME lv-ornt
    648     &ANALYZE-SUSPEND _UIB-CODE-BLOCK _CONTROL lv-ornt Dialog-Frame
    649     ON LEAVE OF lv-ornt IN FRAME Dialog-Frame
    650     DO:
    651       ASSIGN lv-ornt.
    652     END.
    653     
    654     /* _UIB-CODE-BLOCK-END */
    655     &ANALYZE-RESUME
    656     
    657     
    658     &ANALYZE-SUSPEND _UIB-CODE-BLOCK _CONTROL lv-ornt Dialog-Frame
    659     ON VALUE-CHANGED OF lv-ornt IN FRAME Dialog-Frame
    660     DO:
    661       {custom/chgfont.i}
 1    1      /* custom/chgfont.i */
 1    2      IF SELF:SCREEN-VALUE BEGINS "L" THEN 
 1    3         ASSIGN lv-font-no = "13"
 1    4                lines-per-page = 55
 1    5                lv-font-name = "Courier New Size=9 (13CPI)".
 1    6         
 1    7      ELSE    ASSIGN lv-font-no = "11"
 1    8                     lines-per-page = 99
 1    9                     lv-font-name = "Courier New Size=7 (17 cpi for 132 C
 1    9     LMN REPORT)".
 1   10      
 1   11      DISPL lv-font-no lines-per-page lv-font-name WITH FRAME {&FRAME-NAM
 1   11     E}Dialog-Frame.
    661      
    662       lines-per-page = IF SELF:SCREEN-VALUE = "L" THEN 58 ELSE 99.
.\jcrep\d-tickt2.w                    06/07/2006 15:37:41   PROGRESS(R) Page 36  

{} Line Blk
-- ---- ---
    663       DISP lines-per-page WITH FRAME {&FRAME-NAME}Dialog-Frame.
    664     END.
    665     
    666     /* _UIB-CODE-BLOCK-END */
    667     &ANALYZE-RESUME
    668     
    669     
    670     &Scoped-define SELF-NAME rd-dest
    671     &ANALYZE-SUSPEND _UIB-CODE-BLOCK _CONTROL rd-dest Dialog-Frame
    672     ON VALUE-CHANGED OF rd-dest IN FRAME Dialog-Frame
    673     DO:
    674       assign {&self-name}rd-dest.
    675     END.
    676     
    677     /* _UIB-CODE-BLOCK-END */
    678     &ANALYZE-RESUME
    679     
    680     
    681     &Scoped-define SELF-NAME spec_codes
    682     &ANALYZE-SUSPEND _UIB-CODE-BLOCK _CONTROL spec_codes Dialog-Frame
    683     ON LEAVE OF spec_codes IN FRAME Dialog-Frame /* Spec Codes */
    684     DO:
    685       assign {&self-name}spec_codes.
    686     END.
    687     
    688     /* _UIB-CODE-BLOCK-END */
    689     &ANALYZE-RESUME
    690     
    691     
    692     &Scoped-define SELF-NAME tb_box
    693     &ANALYZE-SUSPEND _UIB-CODE-BLOCK _CONTROL tb_box Dialog-Frame
    694     ON VALUE-CHANGED OF tb_box IN FRAME Dialog-Frame /* Print Box Design
    694     ? */
    695     DO:
    696       assign {&self-name}tb_box.
    697     END.
    698     
    699     /* _UIB-CODE-BLOCK-END */
    700     &ANALYZE-RESUME
    701     
    702     
    703     &Scoped-define SELF-NAME tb_corr
    704     &ANALYZE-SUSPEND _UIB-CODE-BLOCK _CONTROL tb_corr Dialog-Frame
    705     ON VALUE-CHANGED OF tb_corr IN FRAME Dialog-Frame /* Corrware */
    706     DO:
    707       assign {&self-name}tb_corr.
    708     END.
    709     
    710     /* _UIB-CODE-BLOCK-END */
    711     &ANALYZE-RESUME
    712     
.\jcrep\d-tickt2.w                    06/07/2006 15:37:41   PROGRESS(R) Page 37  

{} Line Blk
-- ---- ---
    713     
    714     &Scoped-define SELF-NAME tb_fgimage
    715     &ANALYZE-SUSPEND _UIB-CODE-BLOCK _CONTROL tb_fgimage Dialog-Frame
    716     ON VALUE-CHANGED OF tb_fgimage IN FRAME Dialog-Frame /* Print FG Ite
    716     m Image? */
    717     DO:
    718       assign {&self-name}tb_fgimage.
    719     END.
    720     
    721     /* _UIB-CODE-BLOCK-END */
    722     &ANALYZE-RESUME
    723     
    724     
    725     &Scoped-define SELF-NAME tb_fold
    726     &ANALYZE-SUSPEND _UIB-CODE-BLOCK _CONTROL tb_fold Dialog-Frame
    727     ON VALUE-CHANGED OF tb_fold IN FRAME Dialog-Frame /* Foldware */
    728     DO:
    729       assign {&self-name}tb_fold.
    730     END.
    731     
    732     /* _UIB-CODE-BLOCK-END */
    733     &ANALYZE-RESUME
    734     
    735     
    736     &Scoped-define SELF-NAME tb_prt-label
    737     &ANALYZE-SUSPEND _UIB-CODE-BLOCK _CONTROL tb_prt-label Dialog-Frame
    738     ON VALUE-CHANGED OF tb_prt-label IN FRAME Dialog-Frame /* Print Labe
    738     l Info? */
    739     DO:
    740       assign {&self-name}tb_prt-label.
    741     END.
    742     
    743     /* _UIB-CODE-BLOCK-END */
    744     &ANALYZE-RESUME
    745     
    746     
    747     &Scoped-define SELF-NAME tb_prt-mch
    748     &ANALYZE-SUSPEND _UIB-CODE-BLOCK _CONTROL tb_prt-mch Dialog-Frame
    749     ON VALUE-CHANGED OF tb_prt-mch IN FRAME Dialog-Frame /* Print Machin
    749     e Standard? */
    750     DO:
    751       assign {&self-name}tb_prt-mch.
    752     END.
    753     
    754     /* _UIB-CODE-BLOCK-END */
    755     &ANALYZE-RESUME
    756     
    757     
    758     &Scoped-define SELF-NAME tb_prt-sellprc
    759     &ANALYZE-SUSPEND _UIB-CODE-BLOCK _CONTROL tb_prt-sellprc Dialog-Fram
    759     e
.\jcrep\d-tickt2.w                    06/07/2006 15:37:41   PROGRESS(R) Page 38  

{} Line Blk
-- ---- ---
    760     ON VALUE-CHANGED OF tb_prt-sellprc IN FRAME Dialog-Frame /* Print Se
    760     ll Price in place of UPC#? */
    761     DO:
    762       assign {&self-name}tb_prt-sellprc.
    763     END.
    764     
    765     /* _UIB-CODE-BLOCK-END */
    766     &ANALYZE-RESUME
    767     
    768     
    769     &Scoped-define SELF-NAME tb_prt-shipto
    770     &ANALYZE-SUSPEND _UIB-CODE-BLOCK _CONTROL tb_prt-shipto Dialog-Frame
    771     ON VALUE-CHANGED OF tb_prt-shipto IN FRAME Dialog-Frame /* Print Shi
    771     pto? */
    772     DO:
    773       assign {&self-name}tb_prt-shipto.
    774     END.
    775     
    776     /* _UIB-CODE-BLOCK-END */
    777     &ANALYZE-RESUME
    778     
    779     
    780     &Scoped-define SELF-NAME tb_reprint
    781     &ANALYZE-SUSPEND _UIB-CODE-BLOCK _CONTROL tb_reprint Dialog-Frame
    782     ON VALUE-CHANGED OF tb_reprint IN FRAME Dialog-Frame /* Reprint Tick
    782     ets? */
    783     DO:
    784       assign {&self-name}tb_reprint.
    785     END.
    786     
    787     /* _UIB-CODE-BLOCK-END */
    788     &ANALYZE-RESUME
    789     
    790     
    791     &Scoped-define SELF-NAME td-show-parm
    792     &ANALYZE-SUSPEND _UIB-CODE-BLOCK _CONTROL td-show-parm Dialog-Frame
    793     ON VALUE-CHANGED OF td-show-parm IN FRAME Dialog-Frame /* Show Param
    793     eters? */
    794     DO:
    795         assign {&self-name}td-show-parm.
    796     END.
    797     
    798     /* _UIB-CODE-BLOCK-END */
    799     &ANALYZE-RESUME
    800     
    801     
    802     &UNDEFINE SELF-NAME
    803     
    804     &ANALYZE-SUSPEND _UIB-CODE-BLOCK _CUSTOM _MAIN-BLOCK Dialog-Frame 
    805     
    806     
.\jcrep\d-tickt2.w                    06/07/2006 15:37:41   PROGRESS(R) Page 39  

{} Line Blk
-- ---- ---
    807     /* ***************************  Main Block  ************************
    807     *** */
    808     {sys/inc/f3helpw.i}
 1    1     /* sys/inc/f3helpw.i for window/menu */
 1    2     on f3 of frame {&frame-name}Dialog-Frame
 1    3     anywhere
 1    4     do:
 1    5        def var ls-prog-name as cha no-undo.
 1    6        
 1    7   1    if not connected("asihlp") then do:
 1    8           if search("asihelp.pf") <> ? then connect -pf value(search("as
 1    8   1 ihelp.pf")).
 1    9           else if search("asihlp.pf") <> ? then connect -pf value(search
 1    9   1 ("asihlp.pf")).
 1   10        end.
 1   11   1    if not connected("asihlp") then do:
 1   12           message "ASI Help Database is not connected. Contact System Ad
 1   12   1 ministrator." view-as alert-box error.
 1   13   1       return no-apply.
 1   14        end.
 1   15     
 1   16        ls-prog-name = if program-name(1) begins "user" then entry(2,prog
 1   16     ram-name(1)," ")      
 1   17                       else program-name(1).
 1   18     /*
 1   19     message "Help Win Debug: "  self:name "," self:type skip
 1   20             "          focus:" focus:name focus:type skip
 1   21             "          Frame: " frame-file "," frame-db "," frame-name
 1   22         SKIP "Program: " ls-prog-name view-as alert-box.
 1   23     */
 1   24        run sys/ref/hlp.w (self:name, frame-file, frame-db,ls-prog-name, 
 1   24     "English") .
 1   25        return no-apply.
 1   26     end.
    808      
    809     /* Set CURRENT-WINDOW: this will parent dialog-boxes and frames.    
    809         */
    810     IF VALID-HANDLE(ACTIVE-WINDOW) AND FRAME {&FRAME-NAME}Dialog-Frame:P
    810     ARENT eq ?
    811     THEN FRAME {&FRAME-NAME}Dialog-Frame:PARENT = ACTIVE-WINDOW.
    812     
    813     /* The CLOSE event can be used from inside or outside the procedure 
    813     to  */
    814     /* terminate it.                                                    
    814         */
    815     
    816     /* Now enable the interface and wait for the exit condition.        
    816         */
    817     /* (NOTE: handle ERROR and END-KEY so cleanup code will always fire.
    817         */
    818     MAIN-BLOCK:
.\jcrep\d-tickt2.w                    06/07/2006 15:37:41   PROGRESS(R) Page 40  

{} Line Blk
-- ---- ---
    819     DO ON ERROR   UNDO MAIN-BLOCK, LEAVE MAIN-BLOCK
    820   1    ON END-KEY UNDO MAIN-BLOCK, LEAVE MAIN-BLOCK:
    821   1 
    822   1 /* security check need {methods/prgsecur.i} in definition section */
    823   2   IF access-close THEN DO:
    824   2      APPLY "close" TO THIS-PROCEDURE.
    825   2      RETURN .
    826   1   END.
    827   1 
    828   1   
    829   1   FIND FIRST sys-ctrl
    830   1       WHERE sys-ctrl.company EQ cocode
    831   1         AND sys-ctrl.name    EQ "CEMENU"
    832   1       NO-LOCK NO-ERROR.
    833   1   ASSIGN
    834   1    tb_fold = NOT AVAIL sys-ctrl           OR
    835   1              sys-ctrl.char-fld EQ "Both"  OR
    836   1              sys-ctrl.char-fld EQ "Foldware"
    837   1    tb_corr = AVAIL sys-ctrl AND
    838                  (sys-ctrl.char-fld EQ "Both" OR sys-ctrl.char-fld EQ "C
    838   1 orrware").
    839   1   
    840   2   IF tb_fold THEN DO:
    841   2     {sys/inc/jobcard.i "F"}
 1    1   2 
 1    2   2 find first sys-ctrl
 1    3   2     where sys-ctrl.company eq cocode
 1    4   2       and sys-ctrl.name    eq "JOBCARD" + "{1}F"
 1    5   2     no-lock no-error.
 1    6   2 
 1    7   3 if not avail sys-ctrl then do transaction:
 1    8   3   find first sys-ctrl
 1    9   3       where sys-ctrl.company eq cocode
 1   10   3         and sys-ctrl.name    eq "JOBCARD"
 1   11   3       no-error.
 1   12   3 
 1   13   4   if not avail sys-ctrl then do:
 1   14   4     create sys-ctrl.
 1   15   4     assign
 1   16   4      sys-ctrl.company  = cocode
 1   17   4      sys-ctrl.char-fld = "10 Pitch"
 1   18   4      sys-ctrl.log-fld  = no.
 1   19   3   end.
 1   20   3 
 1   21   3   assign
 1   22   3    sys-ctrl.name     = "JOBCARD" + "{1}F"
 1   23   3    sys-ctrl.descrip  = "Job Card or Factory Ticket Format " +
 1   24   3                        if "{1}F" eq "" then "" 
 1   25   3                        else "(" + (if "{1}F" eq "F" then "Fold" 
 1   26   3                                    else "Corr") + "ware)".
 1   27   3    
.\jcrep\d-tickt2.w                    06/07/2006 15:37:41   PROGRESS(R) Page 41  

{} Line Blk
-- ---- ---
 1   28      /* if new sys-ctrl then message sys-ctrl.descrip update sys-ctrl.ch
 1   28   3 ar-fld.*/
 1   29   2 end.
    841   2  
    842   2     lv-format-f = sys-ctrl.char-fld.
    843         IF lookup(lv-format-f,"Interpac,Dayton,FibreFC,Livngstn,CentBox,
    843     Frankstn,Colonial,Unipak,Ottpkg,Shelby,CCC") > 0 THEN lines-per-page
    843   2  = 55.
    844   1   END.  
    845   1 
    846   2   IF tb_corr THEN DO:
    847   2     {sys/inc/jobcard.i "C"}
 1    1   2 
 1    2   2 find first sys-ctrl
 1    3   2     where sys-ctrl.company eq cocode
 1    4   2       and sys-ctrl.name    eq "JOBCARD" + "{1}C"
 1    5   2     no-lock no-error.
 1    6   2 
 1    7   3 if not avail sys-ctrl then do transaction:
 1    8   3   find first sys-ctrl
 1    9   3       where sys-ctrl.company eq cocode
 1   10   3         and sys-ctrl.name    eq "JOBCARD"
 1   11   3       no-error.
 1   12   3 
 1   13   4   if not avail sys-ctrl then do:
 1   14   4     create sys-ctrl.
 1   15   4     assign
 1   16   4      sys-ctrl.company  = cocode
 1   17   4      sys-ctrl.char-fld = "10 Pitch"
 1   18   4      sys-ctrl.log-fld  = no.
 1   19   3   end.
 1   20   3 
 1   21   3   assign
 1   22   3    sys-ctrl.name     = "JOBCARD" + "{1}C"
 1   23   3    sys-ctrl.descrip  = "Job Card or Factory Ticket Format " +
 1   24   3                        if "{1}C" eq "" then "" 
 1   25   3                        else "(" + (if "{1}C" eq "F" then "Fold" 
 1   26   3                                    else "Corr") + "ware)".
 1   27   3    
 1   28      /* if new sys-ctrl then message sys-ctrl.descrip update sys-ctrl.ch
 1   28   3 ar-fld.*/
 1   29   2 end.
    847   2  
    848   2     lv-format-c = sys-ctrl.char-fld.
    849   1   END.
    850   1 
    851   1   ASSIGN begin_job1 = ip-job-no
    852   1          begin_job2 = ip-job-no2
    853   1          end_job1 = ip-job-no
    854   1          end_job2 = ip-job-no2.
    855   1   
.\jcrep\d-tickt2.w                    06/07/2006 15:37:41   PROGRESS(R) Page 42  

{} Line Blk
-- ---- ---
    856   1   FIND FIRST job WHERE job.company = g_company
    857   1                    AND job.job-no = ip-job-no
    858   1                    AND job.job-no2 = ip-job-no2 NO-LOCK NO-ERROR.
    859   1   IF AVAIL job THEN FIND FIRST est WHERE est.company = g_company
    860                                          AND est.est-no = job.est-no NO-
    860   1 LOCK NO-ERROR.
    861   2   IF AVAIL est THEN DO:
    862   2      IF est.est-type < 5 THEN ASSIGN tb_fold = YES
    863   2                                      tb_corr = NO.
    864   2      ELSE ASSIGN tb_fold = NO
    865   2                  tb_corr = YES.
    866   1   END.
    867   1 
    868   1   RUN enable_UI.
    869   1   
    870   2   DO WITH FRAME {&frame-name}Dialog-Frame:
    871   2      v-prgmname = "r-ticket.".
    872   2     {custom/usrprint.i}
 1    1   2 /*custom/usrprint.i */
 1    2   2 
 1    3   2 DEF VAR lv-group-hdl AS HANDLE NO-UNDO.
 1    4   2 DEF VAR lv-field-hdl AS HANDLE NO-UNDO.
 1    5   2 DEF VAR lv-frame-hdl AS HANDLE NO-UNDO.
 1    6   2 DEF VAR li AS INT NO-UNDO.
 1    7   2 
 1    8   2 &SCOPED-DEFINE where-phrase                   ~
 1    9   2     WHERE user-print.company    EQ cocode     ~
 1   10   2       AND user-print.program-id EQ v-prgmname ~
 1   11   2       AND user-print.batch      EQ ""
 1   12   2 
 1   13   2 RELEASE user-print.
 1   14   2 
 1   15   2 IF g_batch THEN
 1   16     FIND FIRST user-print NO-LOCK WHERE ROWID(user-print) EQ g_batch-row
 1   16   2 id NO-ERROR.
 1   17   2 
 1   18   2 ELSE
 1   19   2 FIND FIRST user-print NO-LOCK
 1    1          {&where-phrase}WHERE user-print.company    EQ cocode           
 1    1     AND user-print.program-id EQ v-prgmname       AND user-print.batch  
 1   20   2     EQ "" AND user-print.user-id EQ USERID("nosweat") NO-ERROR.
 1   21   2 
 1   22   2 IF NOT AVAIL user-print THEN
 1    1     FIND FIRST user-print NO-LOCK {&where-phrase}WHERE user-print.compan
 1    1     y    EQ cocode           AND user-print.program-id EQ v-prgmname    
 1   23        AND user-print.batch      EQ "" AND user-print.user-id EQ "" NO-E
 1   23   2 RROR.
 1   24   2 
 1   25   3 IF AVAIL user-print THEN DO:
 1   26   3   ASSIGN
 1   27   3    lv-frame-hdl = FRAME {&frame-name}Dialog-Frame:HANDLE
.\jcrep\d-tickt2.w                    06/07/2006 15:37:41   PROGRESS(R) Page 43  

{} Line Blk
-- ---- ---
 1   28   3    lv-group-hdl = lv-frame-hdl:FIRST-CHILD
 1   29   3    lv-field-hdl = lv-group-hdl:FIRST-CHILD.
 1   30   3 
 1   31   4   DO WHILE VALID-HANDLE(lv-field-hdl):
 1   32   5     DO li = 1 TO EXTENT(user-print.field-name):
 1   33   5       IF TRIM(user-print.field-name[li]) NE ""          AND 
 1   34   6          user-print.field-name[li] EQ lv-field-hdl:NAME THEN DO:
 1   35             lv-field-hdl:SCREEN-VALUE = user-print.field-value[li] NO-ER
 1   35   6 ROR.
 1   36   6         LEAVE.
 1   37   5       END.
 1   38   4     END.
 1   39   4     lv-field-hdl = lv-field-hdl:NEXT-SIBLING.
 1   40   3   END.
 1   41   2 END.
    872   2   
    873   2 
    874   2    FIND FIRST sys-ctrl
    875   2       WHERE sys-ctrl.company EQ cocode
    876   2         AND sys-ctrl.name    EQ "CEMENU"
    877   2       NO-LOCK NO-ERROR.
    878   2   ASSIGN
    879   2    tb_fold = NOT AVAIL sys-ctrl           OR
    880   2              sys-ctrl.char-fld EQ "Both"  OR
    881   2              sys-ctrl.char-fld EQ "Foldware"
    882   2    tb_corr = AVAIL sys-ctrl AND
    883                  (sys-ctrl.char-fld EQ "Both" OR sys-ctrl.char-fld EQ "C
    883   2 orrware").
    884   2   
    885   3   IF tb_fold THEN DO:
    886   3     {sys/inc/jobcard.i "F"}
 1    1   3 
 1    2   3 find first sys-ctrl
 1    3   3     where sys-ctrl.company eq cocode
 1    4   3       and sys-ctrl.name    eq "JOBCARD" + "{1}F"
 1    5   3     no-lock no-error.
 1    6   3 
 1    7   4 if not avail sys-ctrl then do transaction:
 1    8   4   find first sys-ctrl
 1    9   4       where sys-ctrl.company eq cocode
 1   10   4         and sys-ctrl.name    eq "JOBCARD"
 1   11   4       no-error.
 1   12   4 
 1   13   5   if not avail sys-ctrl then do:
 1   14   5     create sys-ctrl.
 1   15   5     assign
 1   16   5      sys-ctrl.company  = cocode
 1   17   5      sys-ctrl.char-fld = "10 Pitch"
 1   18   5      sys-ctrl.log-fld  = no.
 1   19   4   end.
 1   20   4 
.\jcrep\d-tickt2.w                    06/07/2006 15:37:41   PROGRESS(R) Page 44  

{} Line Blk
-- ---- ---
 1   21   4   assign
 1   22   4    sys-ctrl.name     = "JOBCARD" + "{1}F"
 1   23   4    sys-ctrl.descrip  = "Job Card or Factory Ticket Format " +
 1   24   4                        if "{1}F" eq "" then "" 
 1   25   4                        else "(" + (if "{1}F" eq "F" then "Fold" 
 1   26   4                                    else "Corr") + "ware)".
 1   27   4    
 1   28      /* if new sys-ctrl then message sys-ctrl.descrip update sys-ctrl.ch
 1   28   4 ar-fld.*/
 1   29   3 end.
    886   3  
    887   3     lv-format-f = sys-ctrl.char-fld.
    888         IF lookup(lv-format-f,"Interpac,Dayton,FibreFC,Livngstn,Frankstn
    888     ,CentBox,Colonial,Unipak,Ottpkg,Shelby,CCC") > 0 THEN lines-per-page
    888   3  = 55.
    889   2   END.  
    890   2 
    891   3   IF tb_corr THEN DO:
    892   3     {sys/inc/jobcard.i "C"}
 1    1   3 
 1    2   3 find first sys-ctrl
 1    3   3     where sys-ctrl.company eq cocode
 1    4   3       and sys-ctrl.name    eq "JOBCARD" + "{1}C"
 1    5   3     no-lock no-error.
 1    6   3 
 1    7   4 if not avail sys-ctrl then do transaction:
 1    8   4   find first sys-ctrl
 1    9   4       where sys-ctrl.company eq cocode
 1   10   4         and sys-ctrl.name    eq "JOBCARD"
 1   11   4       no-error.
 1   12   4 
 1   13   5   if not avail sys-ctrl then do:
 1   14   5     create sys-ctrl.
 1   15   5     assign
 1   16   5      sys-ctrl.company  = cocode
 1   17   5      sys-ctrl.char-fld = "10 Pitch"
 1   18   5      sys-ctrl.log-fld  = no.
 1   19   4   end.
 1   20   4 
 1   21   4   assign
 1   22   4    sys-ctrl.name     = "JOBCARD" + "{1}C"
 1   23   4    sys-ctrl.descrip  = "Job Card or Factory Ticket Format " +
 1   24   4                        if "{1}C" eq "" then "" 
 1   25   4                        else "(" + (if "{1}C" eq "F" then "Fold" 
 1   26   4                                    else "Corr") + "ware)".
 1   27   4    
 1   28      /* if new sys-ctrl then message sys-ctrl.descrip update sys-ctrl.ch
 1   28   4 ar-fld.*/
 1   29   3 end.
    892   3  
    893   3     lv-format-c = sys-ctrl.char-fld.
.\jcrep\d-tickt2.w                    06/07/2006 15:37:41   PROGRESS(R) Page 45  

{} Line Blk
-- ---- ---
    894   2   END.
    895   2     ASSIGN begin_job1 = ip-job-no
    896   2          begin_job2 = ip-job-no2
    897   2          end_job1 = ip-job-no
    898   2          end_job2 = ip-job-no2.
    899   2   
    900   2   FIND FIRST job WHERE job.company = g_company
    901   2                    AND job.job-no = ip-job-no
    902   2                    AND job.job-no2 = ip-job-no2 NO-LOCK NO-ERROR.
    903   2   IF AVAIL job THEN FIND FIRST est WHERE est.company = g_company
    904                                          AND est.est-no = job.est-no NO-
    904   2 LOCK NO-ERROR.
    905   3   IF AVAIL est THEN DO:
    906   3      IF est.est-type < 5 THEN ASSIGN tb_fold = YES
    907   3                                      tb_corr = NO.
    908   3      ELSE ASSIGN tb_fold = NO
    909   3                  tb_corr = YES.
    910   2   END.
    911   2   tb_reprint = NO.
    912       DISPLAY begin_job1 begin_job2 END_job1 END_job2 tb_fold tb_corr li
    912   2 nes-per-page tb_reprint.
    913   2 
    914   3   IF lv-format-c = "pacific" THEN DO:
    915   3       lv-ornt = "L".
    916   3       APPLY "value-changed" TO lv-ornt .
    917   2   END.
    918       IF tb_corr:SCREEN-VALUE EQ "No" AND lv-format-f NE "ASI" THEN spec
    918   2 _codes:HIDDEN = YES.
    919   2 
    920         IF tb_fold AND (lv-format-f = "Interpac" OR lv-format-f = "Dayto
    920   2 n" 
    921                         OR lv-format-f = "Livngstn" OR lv-format-f = "Fi
    921   2 breFC"
    922                         OR lv-format-f = "CentBox" OR lv-format-f = "Key
    922   2 stone" OR lv-format-f = "Ottpkg"
    923                         OR lv-format-f = "Frankstn" OR lv-format-f = "Co
    923   2 lonial" OR lv-format-f = "Unipak"
    924                         OR lv-format-f = "MWFibre"  OR lv-format-f = "Sh
    924   2 elby"  OR lv-format-f = "CCC" )
    925   2     THEN
    926   2             assign tb_prt-mch:SENSITIVE = YES
    927   2                    tb_prt-shipto:SENSITIVE = YES
    928   2                    tb_prt-sellprc:SENSITIVE = YES
    929   2                    rd_print-speed:SENSITIVE = YES .            
    930   3     ELSE do:
    931   3         ASSIGN tb_prt-mch = NO
    932   3                tb_prt-shipto = NO
    933   3                tb_prt-sellprc = NO.
    934   3         ASSIGN tb_prt-mch:SCREEN-VALUE = "No"
    935   3                tb_prt-shipto:SCREEN-VALUE = "No"
    936   3                tb_prt-sellprc:SCREEN-VALUE = "No" 
.\jcrep\d-tickt2.w                    06/07/2006 15:37:41   PROGRESS(R) Page 46  

{} Line Blk
-- ---- ---
    937   3                rd_print-speed:SCREEN-VALUE = "S".
    938   2     END.
    939         IF lookup(lv-format-c,"Artios,Premier,Xprint,Suthrlnd") <= 0 THE
    939   2 N 
    940   3     do:
    941   3        ASSIGN tb_prt-set-header:SCREEN-VALUE = "No"
    942   3               tb_prt-set-header:SENSITIVE = NO  .
    943   3 
    944   2     END.
    945   1   END.
    946   1   {methods/nowait.i}
 1    1   1 /* nowait.i */
 1    2   1 
 1    3   1 RUN Set_Cursor IN Persistent-Handle ("").
    946   1  
    947   1   /*APPLY "entry" TO begin_job1 IN FRAME {&FRAME-NAME}. */
    948   1   APPLY "choose" TO btn-ok IN FRAME {&FRAME-NAME}Dialog-Frame.
    949   1 
    950   1   WAIT-FOR CLOSE OF THIS-PROCEDURE.
    951     END.
    952     RUN DISABLE_ui.
    953     
    954     /* _UIB-CODE-BLOCK-END */
    955     &ANALYZE-RESUME
    956     
    957     
    958     /* **********************  Internal Procedures  ********************
    958     *** */
    959     
    960     &ANALYZE-SUSPEND _UIB-CODE-BLOCK _PROCEDURE disable_UI Dialog-Frame 
    960      _DEFAULT-DISABLE
    961     PROCEDURE disable_UI :
    962     /*------------------------------------------------------------------
    962     ------------
    963       Purpose:     DISABLE the User Interface
    964       Parameters:  <none>
    965       Notes:       Here we clean-up the user-interface by deleting
    966                    dynamic widgets we have created and/or hide 
    967                    frames.  This procedure is usually called when
    968                    we are ready to "clean-up" after running.
    969     --------------------------------------------------------------------
    969     ----------*/
    970       /* Hide all frames. */
    971       HIDE FRAME Dialog-Frame.
    972     END PROCEDURE.
    973     
    974     /* _UIB-CODE-BLOCK-END */
    975     &ANALYZE-RESUME
    976     
    977     &ANALYZE-SUSPEND _UIB-CODE-BLOCK _PROCEDURE enable_UI Dialog-Frame  
    977     _DEFAULT-ENABLE
.\jcrep\d-tickt2.w                    06/07/2006 15:37:41   PROGRESS(R) Page 47  

{} Line Blk
-- ---- ---
    978     PROCEDURE enable_UI :
    979     /*------------------------------------------------------------------
    979     ------------
    980       Purpose:     ENABLE the User Interface
    981       Parameters:  <none>
    982       Notes:       Here we display/view/enable the widgets in the
    983                    user-interface.  In addition, OPEN all queries
    984                    associated with each FRAME and BROWSE.
    985                    These statements here are based on the "Other 
    986                    Settings" section of the widget Property Sheets.
    987     --------------------------------------------------------------------
    987     ----------*/
    988       DISPLAY begin_job1 begin_job2 end_job1 end_job2 tb_fold tb_corr tb
    988     _reprint 
    989               tb_box tb_fgimage spec_codes tb_prt-mch rd_print-speed tb_
    989     prt-shipto 
    990               tb_prt-sellprc tb_prt-label tb_committed tb_prompt-ship 
    991               tb_prt-set-header lines-per-page rd-dest lv-ornt lv-font-n
    991     o 
    992               lv-font-name td-show-parm v-run-speed 
    993           WITH FRAME Dialog-Frame.
    994       ENABLE RECT-42 RECT-6 RECT-7 begin_job1 begin_job2 end_job1 end_jo
    994     b2 tb_fold 
    995              tb_corr tb_reprint tb_box tb_fgimage spec_codes tb_prt-labe
    995     l 
    996              tb_committed tb_prompt-ship tb_prt-set-header lines-per-pag
    996     e rd-dest 
    997              lv-ornt td-show-parm btn-ok btn-cancel 
    998           WITH FRAME Dialog-Frame.
    999       VIEW FRAME Dialog-Frame.
   1000       {&OPEN-BROWSERS-IN-QUERY-Dialog-Frame}
   1001     END PROCEDURE.
   1002     
   1003     /* _UIB-CODE-BLOCK-END */
   1004     &ANALYZE-RESUME
   1005     
   1006     &ANALYZE-SUSPEND _UIB-CODE-BLOCK _PROCEDURE output-to-fax Dialog-Fra
   1006     me 
   1007     PROCEDURE output-to-fax :
   1008     /*------------------------------------------------------------------
   1008     ------------
   1009       Purpose:     
   1010       Parameters:  <none>
   1011       Notes:       
   1012     --------------------------------------------------------------------
   1012     ----------*/
   1013        /*run output-to-fax.*/
   1014   1    DO WITH FRAME {&FRAME-NAME}Dialog-Frame:
   1015   1 
   1016   1    
   1017   1            {custom/asifax.i &begin_cust=begin_job1
.\jcrep\d-tickt2.w                    06/07/2006 15:37:41   PROGRESS(R) Page 48  

{} Line Blk
-- ---- ---
   1018   1                             &END_cust=END_job1
   1019   1                             &fax-subject=c-win:title
   1020   1                             &fax-body=c-win:title
   1021   1                             &fax-file=list-name }
 1    1   1 /* custom/asifax.i FAx include file using Window Fax Console */
 1    2   1 DEF VAR fax-ret-code AS INT NO-UNDO.
 1    3     /*DEF VAR ls-fax-file AS cha NO-UNDO. defined from report generating
 1    3   1  program */
 1    4   1 DEF VAR lv-type AS cha NO-UNDO.
 1    5   1 
 1    6   2 IF "{&TYPE}" = "CUSTOMER"  THEN DO:
 1    7   3    IF {&begin_cust}begin_job1 <> {&end_cust}END_job1 THEN DO:
 1    8            MESSAGE "Beginning Customer and Ending Customer must be the s
 1    8   3 ame for Fax."
 1    9   3                     VIEW-AS ALERT-BOX ERROR.
 1   10   3               APPLY "entry" TO {&END_cust}END_job1 .
 1   11   3               RETURN NO-APPLY.
 1   12   2    END.
 1   13   2    lv-type = "CUSTOMER".
 1   14   1 END.
 1   15   2 ELSE IF "{&TYPE}" = "VENDOR" THEN DO:
 1   16   3    IF {&begin_cust}begin_job1 <> {&end_cust}END_job1 THEN DO:
 1   17           MESSAGE "Beginning Vendor and Ending Vendor must be the same f
 1   17   3 or E-mail."
 1   18   3                     VIEW-AS ALERT-BOX ERROR.
 1   19   3               APPLY "entry" TO {&END_cust}END_job1 .
 1   20   3               RETURN NO-APPLY.
 1   21   2    END.
 1   22   2    lv-type = "VENDOR".
 1   23   1 END.
 1   24   2 ELSE IF "{&TYPE}" = "MULTI" THEN DO:
 1   25   2    lv-type = "MULTI".
 1   26   1 END.
 1   27   1 ELSE lv-type = "".
 1   28   1 
 1   29   1 
 1   30   1 ls-fax-file = "c:\tmp\fax" + STRING(TIME) + ".txt". 
 1   31   1 OS-COPY VALUE({&fax-file}list-name) VALUE(ls-fax-file).
 1   32   1 
 1   33   1 run custom/asifax.p (lv-type,ls-fax-file,{&begin_cust}begin_job1,
 1   34   1                                 '{&fax-subject}c-win:title',
 1   35                                     '{&fax-body}c-win:title',OUTPUT fax-
 1   35   1 ret-code).
 1   36   1 IF fax-ret-code <> 0 THEN
 1   37   1      MESSAGE "Error: " fax-ret-code view-as alert-box ERROR.
   1021   1  
   1022                                END.
   1023     END PROCEDURE.
   1024     
   1025     /* _UIB-CODE-BLOCK-END */
   1026     &ANALYZE-RESUME
.\jcrep\d-tickt2.w                    06/07/2006 15:37:41   PROGRESS(R) Page 49  

{} Line Blk
-- ---- ---
   1027     
   1028     &ANALYZE-SUSPEND _UIB-CODE-BLOCK _PROCEDURE output-to-file Dialog-Fr
   1028     ame 
   1029     PROCEDURE output-to-file :
   1030     /*------------------------------------------------------------------
   1030     ------------
   1031       Purpose:     
   1032       Parameters:  <none>
   1033       Notes:       
   1034     --------------------------------------------------------------------
   1034     ----------*/
   1035      /*    DEFINE VARIABLE OKpressed AS LOGICAL NO-UNDO.
   1036          DEF VAR lv-save-as AS cha NO-UNDO.
   1037     
   1038          if init-dir = "" then init-dir = "c:\temp" .
   1039          SYSTEM-DIALOG GET-FILE  lv-save-as
   1040              TITLE      "Enter Listing Name to SAVE AS ..."
   1041              FILTERS    "Listing Files (*.rpt)" "*.rpt",
   1042                         "All Files (*.*)" "*.*"
   1043              INITIAL-DIR init-dir
   1044              ASK-OVERWRITE
   1045         /*     CREATE-TEST-FILE*/
   1046              SAVE-AS
   1047              USE-FILENAME
   1048        
   1049              UPDATE OKpressed.
   1050              
   1051          IF NOT OKpressed THEN  RETURN NO-APPLY.
   1052          OS-COPY VALUE(list-name) VALUE(lv-save-as).
   1053        */
   1054        {custom/out2file.i}
 1    1          /* custom/out2file.i */
 1    2          
 1    3          DEFINE VARIABLE OKpressed AS LOGICAL NO-UNDO.
 1    4          DEF VAR ldummy AS LOG NO-UNDO.
 1    5          DEF VAR lv-output AS cha NO-UNDO.
 1    6     
 1    7          lv-output = list-name.
 1    8          if init-dir = "" then init-dir = "c:\temp" .
 1    9          SYSTEM-DIALOG GET-FILE lv-output
 1   10              TITLE      "Enter Listing Name to SAVE AS ..."
 1   11              FILTERS    "Listing Files (*.rpt)" "*.rpt",
 1   12                         "All Files (*.*)" "*.*"
 1   13              INITIAL-DIR init-dir
 1   14              ASK-OVERWRITE
 1   15         /*     CREATE-TEST-FILE*/
 1   16              SAVE-AS
 1   17              USE-FILENAME
 1   18        
 1   19              UPDATE OKpressed.
 1   20              
.\jcrep\d-tickt2.w                    06/07/2006 15:37:41   PROGRESS(R) Page 50  

{} Line Blk
-- ---- ---
 1   21          IF NOT OKpressed THEN  RETURN NO-APPLY.
 1   22          OS-COPY VALUE(list-name) VALUE(lv-output).
 1   23          IF OS-ERROR = 0 THEN OS-DELETE VALUE(list-name).
 1   24     
   1054      
   1055     
   1056     END PROCEDURE.
   1057     
   1058     /* _UIB-CODE-BLOCK-END */
   1059     &ANALYZE-RESUME
   1060     
   1061     &ANALYZE-SUSPEND _UIB-CODE-BLOCK _PROCEDURE output-to-mail Dialog-Fr
   1061     ame 
   1062     PROCEDURE output-to-mail :
   1063     /*------------------------------------------------------------------
   1063     ------------
   1064       Purpose:     
   1065       Parameters:  <none>
   1066       Notes:       
   1067     --------------------------------------------------------------------
   1067     ----------*/
   1068   1  DO WITH FRAME {&FRAME-NAME}Dialog-Frame:
   1069   2   IF is-xprint-form THEN DO:
   1070                   RUN printPDF (list-name, "ADVANCED SOFTWARE","A1g9f84a
   1070   2 aq7479de4m22").
   1071   2               {custom/asimail.i &TYPE = ''
   1072   2                              &begin_cust= begin_job1
   1073   2                              &END_cust=end_job1
   1074   2                              &mail-subject="Dialog-Frame:title"
   1075   2                              &mail-body="Dialog-Frame:title"
   1076   2                              &mail-file=list-name }
 1    1     /* custom/asimail.i - shared by asimailr.i, asimail2.i and asimailr2
 1    1   2 .i */
 1    2   2 
 1    3   2 &SCOPED-DEFINE xpmailProgram custom/xpmail
 1    4   2 &SCOPED-DEFINE xpmailProgrm2 custom/xpmail2
 1    5   2 &SCOPED-DEFINE groupTitle ,
 1    6   2 
 1    7   2 &IF DEFINED(group-title) NE 0 &THEN
 1    8   2 &SCOPED-DEFINE xpmailProgram {&xpmailProgram}custom/xpmail2    
 1    9   2 &SCOPED-DEFINE groupTitle ,{&group-title},    
 1   10   2 &ENDIF
 1   11   2 
 1   12   2 DEFINE VARIABLE ret-code{&two} AS INTEGER NO-UNDO.
 1   13   2 DEFINE VARIABLE ls-mail-file{&two} AS CHARACTER NO-UNDO.
 1   14   2 
 1   15   2 &IF '{&two}' EQ '' &THEN
 1   16   2 IF INDEX({&mail-file}list-name,'.pdf') EQ 0 THEN
 1   17   2 ls-mail-file{&two} = {&mail-file}list-name + '.pdf'.
 1   18   2 &ELSE
 1   19   2 ls-mail-file{&two} = 'c:\tmp\att' + STRING(TIME) + '.txt'. 
.\jcrep\d-tickt2.w                    06/07/2006 15:37:41   PROGRESS(R) Page 51  

{} Line Blk
-- ---- ---
 1   20   2 OS-COPY VALUE({&mail-file}list-name) VALUE(ls-mail-file{&two}).
 1   21   2 &ENDIF
 1   22   2 
 1   23   3 DO WHILE TRUE:
 1   24       &IF '{&begin_cust}begin_job1' NE '' AND '{&end_cust}end_job1' NE '
 1   24   3 ' &THEN
 1   25   4   IF CAN-DO('Customer,Vendor','{&type}''') THEN DO:
 1   26   5     IF {&begin_cust}begin_job1 NE {&end_cust}end_job1 THEN DO:
 1   27   5       FIND FIRST cust NO-LOCK WHERE cust.company EQ cocode
 1   28   5                                 AND cust.active EQ 'X' NO-ERROR.
 1   29   5       IF AVAILABLE cust THEN {&begin_cust}begin_job1 = cust.cust-no.
 1   30           RUN {&xpmailProgrm2}custom/xpmail2.p ("{&type}''",v-prgmname,l
 1   30   5 s-mail-file{&two},{&begin_cust}begin_job1,
 1   31                                   {&WINDOW-NAME}CURRENT-WINDOW:TITLE,{&W
 1   31   5 INDOW-NAME}CURRENT-WINDOW:TITLE,OUTPUT ret-code{&two}).
 1   32   5       LEAVE.
 1   33   4     END. /* if ne */
 1   34   3   END. /* if can-do */
 1   35   3   &ENDIF
 1   36   3   /*
 1   37   3   &IF '{&type}' EQ 'Customer' AND '{&begin_cust}' NE '' &THEN
 1   38   3   IF NOT CAN-FIND(cust WHERE cust.company EQ cocode
 1   39   3                          AND cust.cust-no EQ STRING({&begin_cust})
 1   40   3                          AND cust.active EQ 'E') THEN LEAVE.
 1   41   3   &ENDIF
 1   42   3   */
 1   43       RUN {&xpmailProgram}custom/xpmail.p ("{&type}''"{&groupTitle},ls-m
 1   43   3 ail-file{&two},{&begin_cust}begin_job1,
 1   44                               {&WINDOW-NAME}CURRENT-WINDOW:TITLE,{&WINDO
 1   44   3 W-NAME}CURRENT-WINDOW:TITLE,OUTPUT ret-code{&two}).
 1   45   3   LEAVE.
 1   46   2 END. /* do while */
   1076   2  
   1077   1            END.
   1078   2            ELSE DO:
   1079   2                {custom/asimailr.i &TYPE = ''
   1080   2                                   &begin_cust= begin_job1
   1081   2                                   &END_cust=end_job1
   1082                                       &mail-subject="frame Dialog-Frame:
   1082   2 title"
   1083                                       &mail-body="frame Dialog-Frame:tit
   1083   2 le"
   1084   2                                   &mail-file=list-name }
 1    1     /* custom/asimailr.i  include file for reports using txt extention *
 1    1   2 /
 1    2   2 
 1    3   2 &SCOPED-DEFINE type {&type}''
 1    4   2 &SCOPED-DEFINE begin_cust {&begin_cust}begin_job1
 1    5   2 &SCOPED-DEFINE end_cust {&end_cust}end_job1
 1    6   2 &SCOPED-DEFINE mail-subject {&mail-subject}frame Dialog-Frame:title
 1    7   2 &SCOPED-DEFINE mail-body {&mail-body}frame Dialog-Frame:title
.\jcrep\d-tickt2.w                    06/07/2006 15:37:41   PROGRESS(R) Page 52  

{} Line Blk
-- ---- ---
 1    8   2 &SCOPED-DEFINE mail-file {&mail-file}list-name
 1    9   2 
 1   10   2 {custom/asimail.i &two=2}
 2    1     /* custom/asimail.i - shared by asimailr.i, asimail2.i and asimailr2
 2    1   2 .i */
 2    2   2 
 2    3   2 &SCOPED-DEFINE xpmailProgram custom/xpmail
 2    4   2 &SCOPED-DEFINE xpmailProgrm2 custom/xpmail2
 2    5   2 &SCOPED-DEFINE groupTitle ,
 2    6   2 
 2    7   2 &IF DEFINED(group-title) NE 0 &THEN
 2    8   2 &SCOPED-DEFINE xpmailProgram {&xpmailProgram}custom/xpmail2    
 2    9   2 &SCOPED-DEFINE groupTitle ,{&group-title},    
 2   10   2 &ENDIF
 2   11   2 
 2   12   2 DEFINE VARIABLE ret-code{&two}2 AS INTEGER NO-UNDO.
 2   13   2 DEFINE VARIABLE ls-mail-file{&two}2 AS CHARACTER NO-UNDO.
 2   14   2 
 2   15   2 &IF '{&two}2' EQ '' &THEN
 2   16   2 IF INDEX({&mail-file}list-name,'.pdf') EQ 0 THEN
 2   17   2 ls-mail-file{&two}2 = {&mail-file}list-name + '.pdf'.
 2   18   2 &ELSE
 2   19   2 ls-mail-file{&two}2 = 'c:\tmp\att' + STRING(TIME) + '.txt'. 
 2   20   2 OS-COPY VALUE({&mail-file}list-name) VALUE(ls-mail-file{&two}2).
 2   21   2 &ENDIF
 2   22   2 
 2   23   3 DO WHILE TRUE:
 2   24       &IF '{&begin_cust}begin_job1' NE '' AND '{&end_cust}end_job1' NE '
 2   24   3 ' &THEN
 2   25   4   IF CAN-DO('Customer,Vendor','{&type}''') THEN DO:
 2   26   5     IF {&begin_cust}begin_job1 NE {&end_cust}end_job1 THEN DO:
 2   27   5       FIND FIRST cust NO-LOCK WHERE cust.company EQ cocode
 2   28   5                                 AND cust.active EQ 'X' NO-ERROR.
 2   29   5       IF AVAILABLE cust THEN {&begin_cust}begin_job1 = cust.cust-no.
 2   30           RUN {&xpmailProgrm2}custom/xpmail2.p ("{&type}''",v-prgmname,l
 2   30   5 s-mail-file{&two}2,{&begin_cust}begin_job1,
 2   31                                   {&WINDOW-NAME}CURRENT-WINDOW:TITLE,{&W
 2   31   5 INDOW-NAME}CURRENT-WINDOW:TITLE,OUTPUT ret-code{&two}2).
 2   32   5       LEAVE.
 2   33   4     END. /* if ne */
 2   34   3   END. /* if can-do */
 2   35   3   &ENDIF
 2   36   3   /*
 2   37   3   &IF '{&type}' EQ 'Customer' AND '{&begin_cust}' NE '' &THEN
 2   38   3   IF NOT CAN-FIND(cust WHERE cust.company EQ cocode
 2   39   3                          AND cust.cust-no EQ STRING({&begin_cust})
 2   40   3                          AND cust.active EQ 'E') THEN LEAVE.
 2   41   3   &ENDIF
 2   42   3   */
 2   43       RUN {&xpmailProgram}custom/xpmail.p ("{&type}''"{&groupTitle},ls-m
 2   43   3 ail-file{&two}2,{&begin_cust}begin_job1,
.\jcrep\d-tickt2.w                    06/07/2006 15:37:41   PROGRESS(R) Page 53  

{} Line Blk
-- ---- ---
 2   44                               {&WINDOW-NAME}CURRENT-WINDOW:TITLE,{&WINDO
 2   44   3 W-NAME}CURRENT-WINDOW:TITLE,OUTPUT ret-code{&two}2).
 2   45   3   LEAVE.
 2   46   2 END. /* do while */
 1   10   2  
   1084   2  
   1085   2 
   1086   1            END.
   1087   1  
   1088      END.
   1089     END PROCEDURE.
   1090     
   1091     /* _UIB-CODE-BLOCK-END */
   1092     &ANALYZE-RESUME
   1093     
   1094     &ANALYZE-SUSPEND _UIB-CODE-BLOCK _PROCEDURE output-to-port Dialog-Fr
   1094     ame 
   1095     PROCEDURE output-to-port :
   1096     /*------------------------------------------------------------------
   1096     ------------
   1097       Purpose:     
   1098       Parameters:  <none>
   1099       Notes:       
   1100     --------------------------------------------------------------------
   1100     ----------*/
   1101     RUN custom/d-print.w (list-name).
   1102     
   1103     END PROCEDURE.
   1104     
   1105     /* _UIB-CODE-BLOCK-END */
   1106     &ANALYZE-RESUME
   1107     
   1108     &ANALYZE-SUSPEND _UIB-CODE-BLOCK _PROCEDURE output-to-printer Dialog
   1108     -Frame 
   1109     PROCEDURE output-to-printer :
   1110     /*------------------------------------------------------------------
   1110     ------------
   1111       Purpose:     
   1112       Parameters:  <none>
   1113       Notes:       
   1114     --------------------------------------------------------------------
   1114     ----------*/
   1115        DEFINE VARIABLE result AS LOGICAL NO-UNDO.
   1116     
   1117     
   1118   1    IF tb_corr THEN DO:
   1119   1        FILE-INFO:FILE-NAME = list-name.
   1120   1        RUN printfile (FILE-INFO:FILE-NAME).
   1121        END.
   1122   1    ELSE DO:
   1123           IF lookup(lv-format-f,"Interpac,FibreFC,Dayton,Livngstn,CentBo
.\jcrep\d-tickt2.w                    06/07/2006 15:37:41   PROGRESS(R) Page 54  

{} Line Blk
-- ---- ---
   1123     x,Keystone,Frankstn,Colonial,Unipak,Ottpkg,MWFibre,Shelby,CCC") > 0 
   1123   2 THEN DO:
   1124   2          FILE-INFO:FILE-NAME = list-name.
   1125   2          RUN printfile (FILE-INFO:FILE-NAME).   
   1126   1       END.
   1127   1       ELSE RUN custom/prntproc.p (list-name, lv-font-no, lv-ornt).
   1128        END.
   1129       
   1130     END PROCEDURE.
   1131     
   1132     /* _UIB-CODE-BLOCK-END */
   1133     &ANALYZE-RESUME
   1134     
   1135     &ANALYZE-SUSPEND _UIB-CODE-BLOCK _PROCEDURE output-to-screen Dialog-
   1135     Frame 
   1136     PROCEDURE output-to-screen :
   1137     /*------------------------------------------------------------------
   1137     ------------
   1138       Purpose:     
   1139       Parameters:  <none>
   1140       Notes:       
   1141     --------------------------------------------------------------------
   1141     ----------*/
   1142        DEF VAR lv-cmd AS cha NO-UNDO.
   1143        DEF VAR lv-file AS cha NO-UNDO.
   1144        DEF VAR lv-xpfile AS cha NO-UNDO.
   1145     
   1146     
   1147   1  IF tb_corr THEN DO:
   1148   1     FILE-INFO:FILE-NAME = list-name.
   1149   1     RUN printfile (FILE-INFO:FILE-NAME).   
   1150      END.
   1151   1  ELSE DO:
   1152          IF lookup(lv-format-f,"Interpac,FibreFC,Dayton,Livngstn,CentBox
   1152     ,Keystone,Frankstn,Colonial,Unipak,Ottpkg,MWFibre,Shelby,CCC") > 0 T
   1152   2 HEN DO:
   1153   2         FILE-INFO:FILE-NAME = list-name.
   1154   2         RUN printfile (FILE-INFO:FILE-NAME).   
   1155   1      END.
   1156          ELSE RUN scr-rpt.w (list-name,FRAME {&frame-name}Dialog-Frame:T
   1156   1 ITLE,lv-font-no,lv-ornt). /* open file-name, title */  
   1157      END.
   1158     END PROCEDURE.
   1159     
   1160     /* _UIB-CODE-BLOCK-END */
   1161     &ANALYZE-RESUME
   1162     
   1163     &ANALYZE-SUSPEND _UIB-CODE-BLOCK _PROCEDURE run-report Dialog-Frame 
   1164     PROCEDURE run-report :
   1165     DEF INPUT PARAMETER ip-industry AS CHAR NO-UNDO.
   1166         
.\jcrep\d-tickt2.w                    06/07/2006 15:37:41   PROGRESS(R) Page 55  

{} Line Blk
-- ---- ---
   1167     IF cocode = ""  THEN cocode = "001".
   1168     IF locode = "" THEN locode = "MAIN".
   1169     
   1170     {sys/form/r-top.i}
 1    1     
 1    2     def var coname     as   char  format "x(35)" no-undo.
 1    3     def var loname     as   char  format "x(30)" no-undo.
 1    4     
 1    5     def var sysdate    as   date  init today     no-undo.
 1    6     def var period     as   int                  no-undo.
 1    7     def var udate      as   date  format 99/99/9999      init today no-u
 1    7     ndo.
 1    8     def var uperiod    as   int   format ">9"    no-undo.
 1    9     
 1   10     def var day_str    as   char  format "x(8) " no-undo.
 1   11     def var tim_str    as   char  format "x(8) " no-undo.
 1   12     def var str-tit    as   char                 no-undo.
 1   13     def var str-tit2   as   char                 no-undo.
 1   14     def var str-tit3   as   char                 no-undo.
 1   15     
 1   16     def var tmp-dir    as   char                 no-undo.
 1   17     
 1   18     find first company where company.company eq cocode no-lock.
 1   19     find first loc     where loc.loc         eq locode no-lock.
 1   20     
 1   21     assign
 1   22      coname  = if avail company then company.name else cocode
 1   23      loname  = if avail loc     then loc.dscr     else locode
 1   24      tim_str = string(time,"hh:mmam")
 1   25      day_str = string(today)
 1   26      str-tit = coname + " - " + loname.
 1   27      
 1   28     find first period
 1   29         where period.company eq cocode
 1   30           and period.pstat   eq yes
 1   31           and period.pst     le sysdate
 1   32           and period.pend    ge sysdate
 1   33         no-lock no-error.
 1   34     if not avail period then
 1   35     find last period
 1   36         where period.company eq cocode
 1   37           and period.pstat   eq yes
 1   38         no-lock no-error.
 1   39     if avail period then period = period.pnum.
 1   40     
   1170      
   1171     
   1172     ASSIGN
   1173      fjob-no   = fill(" ",6 - length(trim(begin_job1))) + trim(begin_job
   1173     1)
   1174      tjob-no   = fill(" ",6 - length(trim(end_job1))) + trim(end_job1)
.\jcrep\d-tickt2.w                    06/07/2006 15:37:41   PROGRESS(R) Page 56  

{} Line Blk
-- ---- ---
   1175      fjob-no2  = begin_job2
   1176      tjob-no2  = end_job2
   1177      fjob-no   = fill(" ",6 - length(trim(fjob-no))) + trim(fjob-no) +
   1178                  string(fjob-no2,"99")
   1179      tjob-no   = fill(" ",6 - length(trim(tjob-no))) + trim(tjob-no) +
   1180                  string(tjob-no2,"99")
   1181      print-box = tb_box
   1182      reprint   = tb_reprint
   1183      spec-list = spec_codes
   1184      s-prt-fgimage = tb_fgimage
   1185      s-prt-label = tb_prt-label
   1186      s-committed-board-only = tb_committed 
   1187      s-prt-set-header = tb_prt-set-header.
   1188     
   1189     {jcrep/tickrrpt.i}
 1    1     
 1    2   1 FOR EACH tt-keyst:
 1    3   1     DELETE tt-keyst.
 1    4     END.
 1    5   1 FOR EACH tt-key2:
 1    6   1     DELETE tt-key2.
 1    7     END.
 1    8   1 FOR EACH tt-prem:
 1    9   1   DELETE tt-prem.
 1   10     END.
 1   11     
 1   12     IF tb_fold  AND LOOKUP(lv-format-f,"Interpac,Dayton,Livngstn,FibreFC
 1   12     ,CentBox,Frankstn,Colonial,Unipak,OTTPkg,MWFibre,Shelby,CCC") > 0 TH
 1   12     EN lines-per-page = 50. /*55*/
 1   13     ELSE lines-per-page = 99.
 1   14     
 1   15     IF tb_fold AND LOOKUP(lv-format-f,"Frankstn,Keystone,FibreFC,MWFibre
 1   15     ") GT 0 THEN
 1   16     {cerep/jobkeyst.i NO-LOCK}
 2    1         
 2    2         
 2    3         for each job-hdr
 2    4             where job-hdr.company               eq cocode
 2    5               and job-hdr.job-no                ge substr(fjob-no,1,6)
 2    6               and job-hdr.job-no                le substr(tjob-no,1,6)
 2    7               and fill(" ",6 - length(trim(job-hdr.job-no))) +
 2    8                   trim(job-hdr.job-no) +
 2    9                   string(job-hdr.job-no2,"99")  ge fjob-no
 2   10               and fill(" ",6 - length(trim(job-hdr.job-no))) +
 2   11                   trim(job-hdr.job-no) +
 2   12                   string(job-hdr.job-no2,"99")  le tjob-no
 2   13               and (job-hdr.ftick-prnt           eq reprint OR
 2   14                    PROGRAM-NAME(2) MATCHES "*r-tickt2*" )
 2   15               and can-find(first job where job.company eq cocode
 2   16                                        and job.job     eq job-hdr.job
 2   17                                        and job.job-no  eq job-hdr.job-no
.\jcrep\d-tickt2.w                    06/07/2006 15:37:41   PROGRESS(R) Page 57  

{} Line Blk
-- ---- ---
 2   18                                        and job.job-no2 eq job-hdr.job-no
 2   18     2
 2   19                                        and job.stat    ne "H")
 2   20             use-index job-no {1}NO-LOCK,
 2   21     
 2   22             first est
 2   23             where est.company  eq job-hdr.company
 2   24               AND est.est-no   EQ job-hdr.est-no
 2   25               and est.est-type le 4  
 2   26             no-lock
 1   16      
 1   17     
 1   18         BREAK BY job-hdr.job
 1   19               BY job-hdr.job-no
 1   20               BY job-hdr.job-no2
 1   21               BY job-hdr.frm
 1   22               BY job-hdr.i-no
 1   23         
 1   24   1     TRANSACTION:
 1   25   1 
 1   26   2   IF LOOKUP(lv-format-f,"Keystone,MWFibre") GT 0 THEN DO:
 1   27         IF FIRST-OF(job-hdr.frm) THEN RUN cerep/d-keyst.w (job-hdr.job-n
 1   27   2 o, job-hdr.job-no2, job-hdr.frm).
 1   28   2 
 1   29   3     IF FIRST-OF(job-hdr.i-no) THEN DO:
 1   30   3       FIND FIRST tt-key2
 1   31   3           WHERE tt-key2.tt-job-no  EQ job-hdr.job-no
 1   32   3             AND tt-key2.tt-job-no2 EQ job-hdr.job-no2
 1   33   3             AND tt-key2.tt-frm     EQ job-hdr.frm
 1   34   3             AND tt-key2.tt-i-no    EQ job-hdr.i-no
 1   35   3           NO-LOCK NO-ERROR.
 1   36   4       IF NOT AVAIL tt-key2 THEN DO:
 1   37   4         CREATE tt-key2.
 1   38   4         ASSIGN
 1   39   4          tt-key2.tt-job-no  = job-hdr.job-no
 1   40   4          tt-key2.tt-job-no2 = job-hdr.job-no2
 1   41   4          tt-key2.tt-frm     = job-hdr.frm
 1   42   4          tt-key2.tt-i-no    = job-hdr.i-no
 1   43   4          tt-key2.tt-rowid   = ROWID(job-hdr).
 1   44   3       END.
 1   45           RUN cerep/d-keys2.w (job-hdr.job-no, job-hdr.job-no2, job-hdr.
 1   45   3 frm, job-hdr.i-no).
 1   46   2     END.
 1   47   1   END.
 1   48   1 
 1   49   1   ELSE
 1   50       IF FIRST-OF(job-hdr.frm) AND LOOKUP(lv-format-f,"Frankstn,FibreFC"
 1   50   1 ) GT 0 THEN
 1   51   1     RUN cerep/d-fibre.w (ROWID(job-hdr)).
 1   52     END.
 1   53     
.\jcrep\d-tickt2.w                    06/07/2006 15:37:41   PROGRESS(R) Page 58  

{} Line Blk
-- ---- ---
 1   54     IF tb_corr                AND
 1   55        tb_prompt-ship         AND
 1   56        lv-format-c = "ARTIOS" THEN 
 1   57     {cecrep/jc-fibr1.i}
 2    1         
 2    2         for each job-hdr NO-LOCK
 2    3             where job-hdr.company               eq cocode
 2    4               and (job-hdr.ftick-prnt           eq reprint OR
 2    5                   PROGRAM-NAME(2) MATCHES "*r-tickt2*")
 2    6               and job-hdr.job-no                ge substr(fjob-no,1,6)
 2    7               and job-hdr.job-no                le substr(tjob-no,1,6)
 2    8     
 2    9               and fill(" ",6 - length(trim(job-hdr.job-no))) +
 2   10                   trim(job-hdr.job-no) +
 2   11                   string(job-hdr.job-no2,"99")  ge fjob-no
 2   12     
 2   13               and fill(" ",6 - length(trim(job-hdr.job-no))) +
 2   14                   trim(job-hdr.job-no) +
 2   15                   string(job-hdr.job-no2,"99")  le tjob-no
 2   16             USE-INDEX job-no,
 2   17     
 2   18             first job
 2   19             where job.company                   eq cocode
 2   20               and job.job                       eq job-hdr.job
 2   21               and job.job-no                    eq job-hdr.job-no
 2   22               and job.job-no2                   eq job-hdr.job-no2
 2   23               and job.stat                      ne "H"
 2   24             USE-INDEX job NO-LOCK,
 2   25             
 2   26             first est
 2   27             where est.company = job.company
 2   28               AND est.est-no                    eq job.est-no
 2   29               and est.est-type                  gt 4
 2   30             USE-INDEX est-no2 NO-LOCK,
 2   31     
 2   32             first cust
 2   33             where cust.company                  eq cocode
 2   34               and cust.cust-no                  eq job-hdr.cust-no
 2   35             no-lock,
 2   36     
 2   37             first itemfg
 2   38             where itemfg.company                eq cocode
 2   39               and itemfg.i-no                   eq job-hdr.i-no
 2   40             no-lock,
 2   41     
 2   42             EACH reftable NO-LOCK
 2   43             WHERE reftable.reftable EQ "jc/jc-calc.p"
 2   44               AND reftable.company  EQ job.company
 2   45               AND reftable.loc      EQ ""
 2   46               AND reftable.code     EQ STRING(job-hdr.job,"999999999")
 2   47               /*AND reftable.code2    EQ eb.stock-no*/
.\jcrep\d-tickt2.w                    06/07/2006 15:37:41   PROGRESS(R) Page 59  

{} Line Blk
-- ---- ---
 2   48               /*AND reftable.val[12]  EQ job-hdr.frm*/
 2   49               /*AND reftable.val[13]  EQ eb.blank-no    */
 2   50               
 2   51             break by job.job-no
 2   52                   by job.job-no2
 2   53                   BY reftable.val[12]
 2   54   1               BY reftable.val[13]:
 2   55   1             
 1   57   1  
 1   58   1   RUN cecrep/d-fibre.w (ROWID(job-hdr),ROWID(reftable)).
 1   59     END.
 1   60     
 1   61     IF tb_corr                                  AND
 1   62        LOOKUP(lv-format-c,"Premier,Xprint,Suthrlnd,United") > 0 AND
 1   63        s-prt-set-header                         THEN
 1   64     {cecrep/jobprem.i NO-LOCK}
 2    1     /*cecrep/jobprem.i*/
 2    2         for each job-hdr
 2    3             where job-hdr.company               eq cocode
 2    4               and job-hdr.ftick-prnt            eq reprint
 2    5     
 2    6               and job-hdr.job-no                ge substr(fjob-no,1,6)
 2    7               and job-hdr.job-no                le substr(tjob-no,1,6)
 2    8     
 2    9               and fill(" ",6 - length(trim(job-hdr.job-no))) +
 2   10                   trim(job-hdr.job-no) +
 2   11                   string(job-hdr.job-no2,"99")  ge fjob-no
 2   12     
 2   13               and fill(" ",6 - length(trim(job-hdr.job-no))) +
 2   14                   trim(job-hdr.job-no) +
 2   15                   string(job-hdr.job-no2,"99")  le tjob-no,
 2   16     
 2   17             first job
 2   18             where job.company                   eq cocode
 2   19               and job.job                       eq job-hdr.job
 2   20               and job.job-no                    eq job-hdr.job-no
 2   21               and job.job-no2                   eq job-hdr.job-no2
 2   22               and job.stat                      ne "H"
 2   23             no-lock,
 2   24             
 2   25             first est
 2   26             where est.company = job.company
 2   27               AND est.est-no                    eq job.est-no
 2   28               and est.est-type                  gt 4
 2   29             no-lock,
 2   30     
 2   31             first cust
 2   32             where cust.company                  eq cocode
 2   33               and cust.cust-no                  eq job-hdr.cust-no
 2   34             no-lock,
 2   35     
.\jcrep\d-tickt2.w                    06/07/2006 15:37:41   PROGRESS(R) Page 60  

{} Line Blk
-- ---- ---
 2   36             first itemfg
 2   37             where itemfg.company                eq cocode
 2   38               and itemfg.i-no                   eq job-hdr.i-no
 2   39             no-lock
 2   40     
 2   41             
 1   64       break by job.job-no
 1   65   1               by job.job-no2:
 1   66   1   IF FIRST-OF(job.job-no2) AND 
 1   67   2       est.est-type = 6 THEN do:
 1   68   2       i = 0.
 1   69   2       FOR EACH eb WHERE eb.company = est.company
 1   70   2                     AND eb.est-no = est.est-no 
 1   71   3                     AND eb.form-no > 0 NO-LOCK:
 1   72   3           i = i + 1.
 1   73   2       END.
 1   74           IF i > 1 THEN RUN cecrep/d-prem.w (job-hdr.job-no, job-hdr.job
 1   74   2 -no2).
 1   75   1   END.
 1   76     END.
 1   77     
 1   78     {sys/inc/print1.i}
 2    1     /* sys/inc/print1.i */
 2    2     
 2    3     if tmp-dir = "" then tmp-dir = "c:\tmp".
 2    4     assign list-name = tmp-dir + "\tmp" + string(time)
 2    5            init-dir = tmp-dir.
 2    6     
 2    7     
 1   78      
 1   79     
 1   80     {sys/inc/outprint.i value(lines-per-page)}
 2    1     /* sys/inc/outprint.i */
 2    2     
 2    3     output to value(list-name) page-size {1}value(lines-per-page) .
 2    4     
 2    5     
 1   80       
 1   81     
 1   82     if td-show-parm then run show-param.
 1   83     
 1   84     SESSION:SET-WAIT-STATE ("general").
 1   85     
 1   86     is-xprint-form = (ip-industry EQ "Corr") OR LOOKUP(lv-format-f,"Inte
 1   86     rpac,FibreFC,Dayton,Livngstn,CentBox,Keystone,Frankstn,Colonial,Unip
 1   86     ak,OTTPkg,MWFibre,Shelby,CCC") GT 0.
 1   87     
 1   88   1 IF is-xprint-form THEN DO:
 1   89   1   IF rd-dest EQ 2 THEN PUT "<PREVIEW>".
 1   90   1   ELSE IF rd-dest EQ 1 THEN PUT "<PRINTER?>".
 1   91   2   ELSE IF rd-dest eq  4 THEN do:
.\jcrep\d-tickt2.w                    06/07/2006 15:37:41   PROGRESS(R) Page 61  

{} Line Blk
-- ---- ---
 1   92   2         ls-fax-file = "c:\tmp\fax" + STRING(TIME) + ".tif".
 1   93   2             /*(IF is-xprint-form THEN ".xpr" ELSE ".txt").*/
 1   94   2         PUT UNFORMATTED "<PRINTER?><EXPORT=" Ls-fax-file ",BW>".
 1   95   1   END.        
 1   96       ELSE IF rd-dest = 5 THEN PUT "<PRINT=NO><PDF-LEFT=5mm><PDF-TOP=10m
 1   96   1 m><PDF-OUTPUT=" + lv-pdf-file + ".pdf></PROGRESS>" FORM "x(120)".
 1   97   1 
 1   98     END.
 1   99     
 1  100   1 IF ip-industry EQ "Fold" THEN DO:
 1  101        spec-list = IF CAN-DO('ASI,CentBox,UniPak',lv-format-f) THEN spec
 1  101   1 _codes ELSE "".
 1  102   1 
 1  103   2    IF lv-format-f EQ "HOP" THEN DO: 
 1  104   3       IF rd-dest = 6 THEN DO:
 1  105   3            PUT CONTROL CHR(27) CHR(38) CHR(107) CHR(50) CHR(83). 
 1  106   3            RUN ce/rep/jobtick.p.
 1  107   3            PUT CONTROL CHR(27) CHR(38) CHR(107) CHR(50) CHR(83). 
 1  108   2       END.
 1  109   2       ELSE RUN ce/rep/jobtick.p.
 1  110   1    END.
 1  111   2    ELSE IF lv-format-f EQ "Interpac" THEN DO:
 1  112   2       PUT UNFORMATTED "<OLANDSCAPE><P10></PROGRESS>".
 1  113   2       RUN cerep/jobintpk.p (lv-format-f).
 1  114   1    END.
 1  115   2    ELSE IF lv-format-f EQ "Frankstn" THEN DO:
 1  116   2       PUT UNFORMATTED "<OLANDSCAPE><P10></PROGRESS>".
 1  117   2       RUN cerep/jobfrank.p (lv-format-f).
 1  118   1    END.
 1  119   2    ELSE IF lv-format-f EQ "OTTPkg" THEN DO:
 1  120   2       PUT UNFORMATTED "<OLANDSCAPE><P10></PROGRESS>".
 1  121   2       RUN cerep/jobottpk.p (lv-format-f).
 1  122   1    END.
 1  123   2    ELSE IF lv-format-f EQ "Colonial" THEN DO:
 1  124   2       PUT UNFORMATTED "<OLANDSCAPE><P10></PROGRESS>".
 1  125   2       RUN cerep/jobcolnl.p (lv-format-f).
 1  126   1    END.
 1  127   2    ELSE IF lv-format-f EQ "CCC" THEN DO:
 1  128   2       PUT UNFORMATTED "<OLANDSCAPE><P10></PROGRESS>".
 1  129   2       RUN cerep/jobccc.p (lv-format-f).
 1  130   1    END.
 1  131   2    ELSE IF lv-format-f EQ "Dayton" THEN DO:
 1  132   2       PUT UNFORMATTED "<OLANDSCAPE><P10></PROGRESS>".
 1  133   2       RUN cerep/jobdaytn.p (lv-format-f).
 1  134   1    END.
 1  135   2    ELSE IF lv-format-f EQ "Livngstn" THEN DO:
 1  136   2       PUT UNFORMATTED "<OLANDSCAPE><P10></PROGRESS>".
 1  137   2       RUN cerep/joblbox.p (lv-format-f).
 1  138   1    END.
 1  139   2    ELSE IF lv-format-f EQ "Shelby" THEN DO:
 1  140   2       PUT UNFORMATTED "<OLANDSCAPE><P10></PROGRESS>".
.\jcrep\d-tickt2.w                    06/07/2006 15:37:41   PROGRESS(R) Page 62  

{} Line Blk
-- ---- ---
 1  141   2       RUN cerep/jobshlby.p (lv-format-f).
 1  142   1    END.
 1  143   2    ELSE IF lv-format-f = "FibreFC" THEN do:  
 1  144                   /* 10x14 works but too much margin paper size is 11x14
 1  144   2  2790,3550*/
 1  145            PUT UNFORMATTED "<FORMAT=10x14><OLANDSCAPE><P12></PROGRESS>" 
 1  145   2 .
 1  146   2        RUN cerep/jobfibre.p (lv-format-f).
 1  147   1    END.
 1  148   2    ELSE IF lv-format-f = "CentBox" THEN do:  
 1  149          /*  PUT UNFORMATTED "<OLANDSCAPE><P10>" .  moved into jobcbox.p
 1  149   2  */
 1  150   2        RUN cerep/jobcbox.p (lv-format-f).
 1  151   1    END.
 1  152   2    ELSE IF lv-format-f = "Unipak" THEN do:  
 1  153   2         RUN cerep/jobunipk.p (lv-format-f).
 1  154   1    END.
 1  155   2    ELSE IF lv-format-f = "Keystone" THEN do:  
 1  156   2     PUT UNFORMATTED "<P10></PROGRESS>" .    
 1  157   2     RUN cerep/jobkeyst.p (lv-format-f).
 1  158   1    END.
 1  159   2    ELSE IF lv-format-f = "MWFibre" THEN do:  
 1  160   2     PUT UNFORMATTED "<P10></PROGRESS>" .    
 1  161   2     RUN cerep/jobmwfbr.p (lv-format-f).
 1  162   1    END.
 1  163   1 
 1  164   1    ELSE RUN cerep/jobtick.p (lv-format-f).
 1  165     END.
 1  166   1 ELSE IF ip-industry EQ "Corr" THEN do:
 1  167   1     spec-list = spec_codes.
 1  168   1 
 1  169   2     IF lv-format-c = "PACIFIC" THEN do:
 1  170   2        PUT UNFORMATTED "<OLANDSCAPE><P10></PROGRESS>" .
 1  171   2        RUN cecrep/jobpacif.p (lv-format-c).
 1  172   1     END.
 1  173   2     IF lv-format-c = "MWBox" THEN do:
 1  174   2        PUT UNFORMATTED "<OLANDSCAPE><P10></PROGRESS>" .
 1  175   2        RUN cecrep/jobmwbox.p (lv-format-c).
 1  176   1     END.
 1  177   2     ELSE IF lv-format-c = "Hughes" THEN do:
 1  178   2        PUT UNFORMATTED "<OLANDSCAPE><P10></PROGRESS>" .
 1  179   2        RUN cecrep/jobhughs.p (lv-format-c).
 1  180   1     END.
 1  181   2     ELSE IF lv-format-c = "MWFIBRE" THEN do:       
 1  182   2        RUN cecrep/jobmidw.p (lv-format-c).
 1  183   1     END.
 1  184   2     ELSE IF lv-format-c = "P&P" THEN do:       
 1  185   2        RUN cecrep/jobpnp.p (lv-format-c).
 1  186   1     END.
 1  187   2     ELSE IF lv-format-c = "CSC" THEN do:       
 1  188   2        RUN cecrep/jobcsc.p (lv-format-c).
.\jcrep\d-tickt2.w                    06/07/2006 15:37:41   PROGRESS(R) Page 63  

{} Line Blk
-- ---- ---
 1  189   1     END.
 1  190   2     ELSE IF lv-format-c = "ARTIOS" THEN do:   /* For Fibre */    
 1  191   2        PUT UNFORMATTED "<OLANDSCAPE><P10></PROGRESS>" .
 1  192   2        RUN cecrep/jobfibre.p (lv-format-c).
 1  193   1     END.
 1  194   2     ELSE IF lv-format-c = "Premier" THEN do:
 1  195   2         PUT UNFORMATTED "</PROGRESS><P7>" skip.
 1  196   2         RUN cecrep/jobprem.p (lv-format-c).
 1  197   1     END.
 1  198   2     ELSE IF lv-format-c = "Suthrlnd" THEN do:
 1  199   2         PUT UNFORMATTED "<OLANDSCAPE><P10></PROGRESS>". 
 1  200   2         RUN cecrep/jobsuthr.p (lv-format-c).
 1  201   1     END.
 1  202   2     ELSE IF lv-format-c = "United" THEN do:
 1  203   2         PUT UNFORMATTED "<OLANDSCAPE><P10></PROGRESS>" skip.
 1  204   2         RUN cecrep/jobuntd.p (lv-format-c).
 1  205   1     END.
 1  206   2     ELSE IF lv-ornt = "P" THEN do:
 1  207   2         PUT UNFORMATTED "</PROGRESS><P7>" skip.
 1  208   2         RUN cecrep/jobtick.p (lv-format-c).
 1  209   1     END.
 1  210   2     ELSE  do:
 1  211   2         PUT UNFORMATTED "<OLANDSCAPE><P10></PROGRESS>" skip.
 1  212   2         RUN cecrep/jobtickL.p (lv-format-c).
 1  213   1     END.
 1  214     END.
   1189      
   1190     
   1191     /*RUN custom/usrprint.p (v-prgmname, FRAME {&FRAME-NAME}:HANDLE). */
   1192     
   1193     SESSION:SET-WAIT-STATE ("").
   1194     
   1195     end procedure.
   1196     
   1197     /* _UIB-CODE-BLOCK-END */
   1198     &ANALYZE-RESUME
   1199     
   1200     &ANALYZE-SUSPEND _UIB-CODE-BLOCK _PROCEDURE show-param Dialog-Frame 
   1201     PROCEDURE show-param :
   1202     /*------------------------------------------------------------------
   1202     ------------
   1203       Purpose:     
   1204       Parameters:  <none>
   1205       Notes:       
   1206     --------------------------------------------------------------------
   1206     ----------*/
   1207       def var lv-frame-hdl as handle no-undo.
   1208       def var lv-group-hdl as handle no-undo.
   1209       def var lv-field-hdl as handle no-undo.
   1210       def var lv-field2-hdl as handle no-undo.
   1211       def var parm-fld-list as cha no-undo.
.\jcrep\d-tickt2.w                    06/07/2006 15:37:41   PROGRESS(R) Page 64  

{} Line Blk
-- ---- ---
   1212       def var parm-lbl-list as cha no-undo.
   1213       def var i as int no-undo.
   1214       def var lv-label as cha.
   1215       
   1216       lv-frame-hdl = frame {&frame-name}Dialog-Frame:handle.
   1217       lv-group-hdl = lv-frame-hdl:first-child.
   1218       lv-field-hdl = lv-group-hdl:first-child .
   1219       
   1220   1   do while true:
   1221   1      if not valid-handle(lv-field-hdl) then leave.
   1222   1      if lookup(lv-field-hdl:private-data,"parm") > 0
   1223   2         then do:
   1224   2            if lv-field-hdl:label <> ? then 
   1225                   assign parm-fld-list = parm-fld-list + lv-field-hdl:sc
   1225   2 reen-value + ","
   1226                          parm-lbl-list = parm-lbl-list + lv-field-hdl:la
   1226   2 bel + "," 
   1227   2                      .
   1228   3            else do:  /* radio set */
   1229                   assign parm-fld-list = parm-fld-list + lv-field-hdl:sc
   1229   3 reen-value + ","
   1230   3                      .
   1231   3               lv-field2-hdl = lv-group-hdl:first-child.
   1232   4               repeat:
   1233   4                   if not valid-handle(lv-field2-hdl) then leave. 
   1234                       if lv-field2-hdl:private-data = lv-field-hdl:name 
   1234   5 then do:
   1235                          parm-lbl-list = parm-lbl-list + lv-field2-hdl:s
   1235   5 creen-value + ",".
   1236   4                   end.
   1237                       lv-field2-hdl = lv-field2-hdl:next-sibling.       
   1237   4           
   1238   3               end.       
   1239   2            end.                 
   1240   1         end.            
   1241   1      lv-field-hdl = lv-field-hdl:next-sibling.   
   1242       end.
   1243     
   1244       put space(28)
   1245           "< Selection Parameters >"
   1246           skip(1).
   1247       
   1248   1   do i = 1 to num-entries(parm-fld-list,","):
   1249   1     if entry(i,parm-fld-list) ne "" or
   1250   2        entry(i,parm-lbl-list) ne "" then do:
   1251   2        
   1252           lv-label = fill(" ",34 - length(trim(entry(i,parm-lbl-list))))
   1252   2  +
   1253   2                  trim(entry(i,parm-lbl-list)) + ":".
   1254   2                  
   1255   2       put lv-label format "x(35)" at 5
.\jcrep\d-tickt2.w                    06/07/2006 15:37:41   PROGRESS(R) Page 65  

{} Line Blk
-- ---- ---
   1256   2           space(1)
   1257   2           trim(entry(i,parm-fld-list)) format "x(40)"
   1258   2           skip.              
   1259   1     end.
   1260       end.
   1261      
   1262       put fill("-",80) format "x(80)" skip.
   1263       
   1264     END PROCEDURE.
   1265     
   1266     /* _UIB-CODE-BLOCK-END */
   1267     &ANALYZE-RESUME
   1268     
.\jcrep\d-tickt2.w                    06/07/2006 15:37:41   PROGRESS(R) Page 66  

     File Name       Line Blk. Type Tran            Blk. Label            
-------------------- ---- --------- ---- --------------------------------
.\custom\xprint.i     135 Procedure No   Procedure loadxPrint             
.\custom\xprint.i     149 Procedure No   Procedure unloadxPrint           
.\custom\xprint.i     165 Procedure No   Procedure windowsAPI             
.\custom\xprint.i     174 Procedure No   Procedure LoadLibraryA           
.\custom\xprint.i     179 Procedure No   Procedure FreeLibrary            
.\custom\xprint.i     188 Procedure No   Procedure xPrintAPI              
.\custom\xprint.i     201 Procedure No   Procedure printFile              
.\custom\xprint.i     205 Procedure No   Procedure printFileStat          
.\custom\xprint.i     210 Procedure No   Procedure printPDF               
.\custom\xprint.i     216 Procedure No   Procedure getPrinterList         
.\custom\xprint.i     221 Procedure No   Procedure getPrinterFonts        
.\custom\xprint.i     226 Procedure No   Procedure getTextWidth           
.\custom\xprint.i     232 Procedure No   Procedure getPrinterRes          
.\custom\xprint.i     236 Procedure No   Procedure getScreenRes           
.\custom\xprint.i     240 Procedure No   Procedure getScreenFonts         
.\custom\xprint.i     245 Procedure No   Procedure fontDialog             
.\custom\xprint.i     251 Procedure No   Procedure getTextHeight          
.\custom\xprint.i     258 Procedure No   Procedure xPrintVersion          
.\custom\xprint.i     262 Procedure No   Procedure getImageDim            
.\custom\xprint.i     268 Procedure No   Procedure getLPI                 
.\custom\xprint.i     273 Procedure No   Procedure printerDialog          
.\custom\xprint.i     277 Procedure No   Procedure getPrinter             
.\custom\xprint.i     281 Procedure No   Procedure setPrinter             
.\custom\xprint.i     285 Procedure No   Procedure saveFromClipBoard      
.\custom\xprint.i     296 Function  No   Function centerText              
.\custom\xprint.i     328 Do        No                                    
.\custom\xprint.i     356 Function  No   Function decimalALign            
.\custom\xprint.i     377 Function  No   Function endLink                 
.\custom\xprint.i     392 Function  No   Function getbackGround           
.\custom\xprint.i     401 Do        No                                    
.\custom\xprint.i     411 Repeat    No                                    
.\custom\xprint.i     426 Function  No   Function linkto                  
.\custom\xprint.i     443 Function  No   Function mailto                  
.\custom\xprint.i     460 Function  No   Function reduce                  
.\custom\xprint.i     478 Do        No                                    
.\custom\xprint.i     492 Function  No   Function rightJustify            
.\custom\xprint.i     523 Do        No                                    
.\jcrep\d-tickt2.w    426 Trigger   No                                    
    Frames:  Dialog-Frame

.\jcrep\d-tickt2.w    430 Do        No                                    
.\jcrep\d-tickt2.w    434 Do        No                                    
.\jcrep\d-tickt2.w    445 Trigger   No                                    
    Frames:  Dialog-Frame

.\jcrep\d-tickt2.w    456 Trigger   No                                    
    Frames:  Dialog-Frame

.\jcrep\d-tickt2.w    467 Trigger   No                                    
    Frames:  Dialog-Frame

.\jcrep\d-tickt2.w    478 Trigger   No                                    
    Frames:  Dialog-Frame

.\jcrep\d-tickt2.w    489 Trigger   No                                    
    Frames:  Dialog-Frame

.\jcrep\d-tickt2.w    506 Do        No                                    
.\jcrep\d-tickt2.w    515 Do        No                                    
.\jcrep\d-tickt2.w    519 Do        No                                    
.\custom\asifax.i       6 Do        No                                    
.\custom\asifax.i       7 Do        No                                    
.\custom\asifax.i      15 Do        No                                    
.\custom\asifax.i      16 Do        No                                    
.\custom\asifax.i      24 Do        No                                    
.\jcrep\d-tickt2.w    527 Do        No                                    
.\jcrep\d-tickt2.w    528 Do        No                                    
.\custom\asimail.i     19 Do        No                                    
.\custom\asimail.i     24 Do        No                                    
.\custom\asimail.i     26 Do        No                                    
.\jcrep\d-tickt2.w    537 Do        No                                    
.\custom\asimail.i     23 Do        No                                    
.\custom\asimail.i     24 Do        No                                    
.\custom\asimail.i     26 Do        No                                    
.\jcrep\d-tickt2.w    554 Do        No                                    
.\jcrep\d-tickt2.w    563 Do        No                                    
.\jcrep\d-tickt2.w    574 Do        No                                    
.\jcrep\d-tickt2.w    590 Trigger   No                                    
    Frames:  Dialog-Frame

.\jcrep\d-tickt2.w    601 Trigger   No                                    
    Frames:  Dialog-Frame

.\jcrep\d-tickt2.w    612 Trigger   No                                    
    Frames:  Dialog-Frame

.\jcrep\d-tickt2.w    623 Trigger   No                                    
    Frames:  Dialog-Frame

.\jcrep\d-tickt2.w    638 Trigger   No                                    
    Frames:  Dialog-Frame

.\jcrep\d-tickt2.w    649 Trigger   No                                    
    Frames:  Dialog-Frame

.\jcrep\d-tickt2.w    659 Trigger   No                                    
    Frames:  Dialog-Frame

.\jcrep\d-tickt2.w    672 Trigger   No                                    
    Frames:  Dialog-Frame

.\jcrep\d-tickt2.w    683 Trigger   No                                    
    Frames:  Dialog-Frame

.\jcrep\d-tickt2.w    694 Trigger   No                                    
    Frames:  Dialog-Frame
.\jcrep\d-tickt2.w                    06/07/2006 15:37:41   PROGRESS(R) Page 67  

     File Name       Line Blk. Type Tran            Blk. Label            
-------------------- ---- --------- ---- --------------------------------

.\jcrep\d-tickt2.w    705 Trigger   No                                    
    Frames:  Dialog-Frame

.\jcrep\d-tickt2.w    716 Trigger   No                                    
    Frames:  Dialog-Frame

.\jcrep\d-tickt2.w    727 Trigger   No                                    
    Frames:  Dialog-Frame

.\jcrep\d-tickt2.w    738 Trigger   No                                    
    Frames:  Dialog-Frame

.\jcrep\d-tickt2.w    749 Trigger   No                                    
    Frames:  Dialog-Frame

.\jcrep\d-tickt2.w    760 Trigger   No                                    
    Frames:  Dialog-Frame

.\jcrep\d-tickt2.w    771 Trigger   No                                    
    Frames:  Dialog-Frame

.\jcrep\d-tickt2.w    782 Trigger   No                                    
    Frames:  Dialog-Frame

.\jcrep\d-tickt2.w    793 Trigger   No                                    
    Frames:  Dialog-Frame

.\sys\inc\f3helpw.i     2 Trigger   No                                    
    Frames:  Dialog-Frame

.\sys\inc\f3helpw.i     7 Do        No                                    
.\sys\inc\f3helpw.i    11 Do        No                                    
.\jcrep\d-tickt2.w    961 Procedure No   Procedure disable_UI             
    Frames:  Dialog-Frame

.\jcrep\d-tickt2.w    978 Procedure No   Procedure enable_UI              
    Frames:  Dialog-Frame

.\jcrep\d-tickt2.w   1007 Procedure No   Procedure output-to-fax          
    Frames:  Dialog-Frame

.\jcrep\d-tickt2.w   1014 Do        No                                    
.\custom\asifax.i       6 Do        No                                    
.\custom\asifax.i       7 Do        No                                    
.\custom\asifax.i      15 Do        No                                    
.\custom\asifax.i      16 Do        No                                    
.\custom\asifax.i      24 Do        No                                    
.\jcrep\d-tickt2.w   1029 Procedure No   Procedure output-to-file         
.\jcrep\d-tickt2.w   1062 Procedure No   Procedure output-to-mail         
    Frames:  Dialog-Frame
.\jcrep\d-tickt2.w                    06/07/2006 15:37:41   PROGRESS(R) Page 68  

     File Name       Line Blk. Type Tran            Blk. Label            
-------------------- ---- --------- ---- --------------------------------

.\jcrep\d-tickt2.w   1068 Do        No                                    
.\jcrep\d-tickt2.w   1069 Do        No                                    
.\custom\asimail.i     19 Do        No                                    
.\custom\asimail.i     24 Do        No                                    
.\custom\asimail.i     26 Do        No                                    
.\jcrep\d-tickt2.w   1078 Do        No                                    
.\custom\asimail.i     23 Do        No                                    
.\custom\asimail.i     24 Do        No                                    
.\custom\asimail.i     26 Do        No                                    
.\jcrep\d-tickt2.w   1095 Procedure No   Procedure output-to-port         
.\jcrep\d-tickt2.w   1109 Procedure No   Procedure output-to-printer      
.\jcrep\d-tickt2.w   1118 Do        No                                    
.\jcrep\d-tickt2.w   1122 Do        No                                    
.\jcrep\d-tickt2.w   1123 Do        No                                    
.\jcrep\d-tickt2.w   1136 Procedure No   Procedure output-to-screen       
    Frames:  Dialog-Frame

.\jcrep\d-tickt2.w   1147 Do        No                                    
.\jcrep\d-tickt2.w   1151 Do        No                                    
.\jcrep\d-tickt2.w   1152 Do        No                                    
.\jcrep\d-tickt2.w   1164 Procedure No   Procedure run-report             
.\jcrep\tickrrpt.i      2 For       No                                    
.\jcrep\tickrrpt.i      5 For       No                                    
.\jcrep\tickrrpt.i      8 For       No                                    
.\jcrep\tickrrpt.i     15 For       Yes                                   
.\jcrep\tickrrpt.i     26 Do        No                                    
.\jcrep\tickrrpt.i     29 Do        No                                    
.\jcrep\tickrrpt.i     36 Do        No                                    
.\cecrep\jc-fibr1.i     1 For       No                                    
.\jcrep\tickrrpt.i     61 For       No                                    
.\jcrep\tickrrpt.i     66 Do        No                                    
.\jcrep\tickrrpt.i     69 For       No                                    
.\jcrep\tickrrpt.i     88 Do        No                                    
.\jcrep\tickrrpt.i     91 Do        No                                    
.\jcrep\tickrrpt.i    100 Do        No                                    
.\jcrep\tickrrpt.i    103 Do        No                                    
.\jcrep\tickrrpt.i    104 Do        No                                    
.\jcrep\tickrrpt.i    111 Do        No                                    
.\jcrep\tickrrpt.i    115 Do        No                                    
.\jcrep\tickrrpt.i    119 Do        No                                    
.\jcrep\tickrrpt.i    123 Do        No                                    
.\jcrep\tickrrpt.i    127 Do        No                                    
.\jcrep\tickrrpt.i    131 Do        No                                    
.\jcrep\tickrrpt.i    135 Do        No                                    
.\jcrep\tickrrpt.i    139 Do        No                                    
.\jcrep\tickrrpt.i    143 Do        No                                    
.\jcrep\tickrrpt.i    148 Do        No                                    
.\jcrep\tickrrpt.i    152 Do        No                                    
.\jcrep\tickrrpt.i    155 Do        No                                    
.\jcrep\tickrrpt.i    159 Do        No                                    
.\jcrep\d-tickt2.w                    06/07/2006 15:37:41   PROGRESS(R) Page 69  

     File Name       Line Blk. Type Tran            Blk. Label            
-------------------- ---- --------- ---- --------------------------------
.\jcrep\tickrrpt.i    166 Do        No                                    
.\jcrep\tickrrpt.i    169 Do        No                                    
.\jcrep\tickrrpt.i    173 Do        No                                    
.\jcrep\tickrrpt.i    177 Do        No                                    
.\jcrep\tickrrpt.i    181 Do        No                                    
.\jcrep\tickrrpt.i    184 Do        No                                    
.\jcrep\tickrrpt.i    187 Do        No                                    
.\jcrep\tickrrpt.i    190 Do        No                                    
.\jcrep\tickrrpt.i    194 Do        No                                    
.\jcrep\tickrrpt.i    198 Do        No                                    
.\jcrep\tickrrpt.i    202 Do        No                                    
.\jcrep\tickrrpt.i    206 Do        No                                    
.\jcrep\tickrrpt.i    210 Do        No                                    
.\jcrep\d-tickt2.w   1201 Procedure No   Procedure show-param             
    Frames:  Dialog-Frame

.\jcrep\d-tickt2.w   1220 Do        No                                    
.\jcrep\d-tickt2.w   1222 Do        No                                    
.\jcrep\d-tickt2.w   1228 Do        No                                    
.\jcrep\d-tickt2.w   1232 Repeat    No                                    
.\jcrep\d-tickt2.w   1234 Do        No                                    
.\jcrep\d-tickt2.w   1248 Do        No                                    
.\jcrep\d-tickt2.w   1249 Do        No                                    
.\jcrep\d-tickt2.w      0 Procedure No                                    
    Buffers: tt-fibre
             asi.eb
             asi.reftable
             asi.itemfg
             asi.job-hdr
             tt-prem
             tt-key2
             tt-keyst
             asi.period
             asi.loc
             asi.company
             asi.user-print
             asi.est
             asi.job
             asi.sys-ctrl
             asi.cust
             NOSWEAT.b-prgrms

.\methods\prgsecur.i   25 Do        No                                    
.\methods\prgsecur.i   27 Do        No                                    
.\methods\prgsecur.i   36 Do        No                                    
.\methods\prgsecur.i   47 Do        No                                    
.\jcrep\d-tickt2.w    819 Do        No   MAIN-BLOCK                       
.\jcrep\d-tickt2.w    823 Do        No                                    
.\jcrep\d-tickt2.w    840 Do        No                                    
.\sys\inc\jobcard.i     7 Do        Yes                                   
.\sys\inc\jobcard.i    13 Do        No                                    
.\jcrep\d-tickt2.w    846 Do        No                                    
.\sys\inc\jobcard.i     7 Do        Yes                                   
.\sys\inc\jobcard.i    13 Do        No                                    
.\jcrep\d-tickt2.w    861 Do        No                                    
.\jcrep\d-tickt2.w    870 Do        No                                    
    Frames:  Dialog-Frame

.\custom\usrprint.i    25 Do        No                                    
.\custom\usrprint.i    31 Do        No                                    
.\custom\usrprint.i    32 Do        No                                    
.\custom\usrprint.i    33 Do        No                                    
.\jcrep\d-tickt2.w    885 Do        No                                    
.\sys\inc\jobcard.i     7 Do        Yes                                   
.\sys\inc\jobcard.i    13 Do        No                                    
.\jcrep\d-tickt2.w    891 Do        No                                    
.\sys\inc\jobcard.i     7 Do        Yes                                   
.\sys\inc\jobcard.i    13 Do        No                                    
.\jcrep\d-tickt2.w    905 Do        No                                    
.\jcrep\d-tickt2.w    914 Do        No                                    
.\jcrep\d-tickt2.w    930 Do        No                                    
.\jcrep\d-tickt2.w    939 Do        No                                    
