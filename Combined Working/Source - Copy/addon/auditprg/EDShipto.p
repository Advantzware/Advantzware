/* EDShipto.p - generated 01/10/2001 - 13:00:01 by nosweat */

/* this program was generated by auditgn1.p and should not be modified */
/* modifications should be made to the auto generation program         */

DEFINE INPUT PARAMETER action AS CHARACTER NO-UNDO.

DEFINE VARIABLE i AS INTEGER NO-UNDO.

{methods/defines/audit.i}
FIND FIRST ttbl_header.

DEFINE WORK-TABLE ttbl_EDShipto1 NO-UNDO LIKE EDShipto.
DEFINE WORK-TABLE ttbl_EDShipto2 NO-UNDO LIKE EDShipto.

CREATE ttbl_EDShipto1.
IMPORT STREAM s_audit_file ttbl_EDShipto1.
CREATE ttbl_EDShipto2.
IF action = "UPDATE" THEN
IMPORT STREAM s_audit_file ttbl_EDShipto2.

PUT STREAM s-audit-rpt UNFORMATTED
  "Action    User ID/(User Name)            DB.Table/(Database)  Date       Time" SKIP
  "--------- ------------------------------ -------------------- ---------- --------" SKIP
  ttbl_header.v_action AT 1
  ttbl_header.v_userid AT 11
  ttbl_header.v_file AT 42
  ttbl_header.v_date FORMAT "99/99/9999" AT 63
  STRING(ttbl_header.v_time,"HH:MM:SS") AT 74.
FIND users WHERE users.user_id = v_userid NO-LOCK NO-ERROR.
IF AVAILABLE users THEN
PUT STREAM s-audit-rpt UNFORMATTED "(" AT 10 users.user_name ")".
ELSE
PUT STREAM s-audit-rpt UNFORMATTED "(user record does not exist)" AT 10.
PUT STREAM s-audit-rpt UNFORMATTED
  "(" AT 41 ttbl_header.v_db ")" SKIP(1)
  "Label: Value (database field-name)" AT 3.
IF action = "UPDATE" THEN
PUT STREAM s-audit-rpt UNFORMATTED " ( * - denotes field value change )".
PUT STREAM s-audit-rpt UNFORMATTED FILL("-",75) AT 3.
IF NOT v_field_changed OR ttbl_EDShipto1.Addr1 NE ttbl_EDShipto2.Addr1 OR action NE "UPDATE" THEN
DO:
  PUT STREAM s-audit-rpt UNFORMATTED "?: " AT 3 ttbl_EDShipto1.Addr1 " (Addr1)".
  IF action = "UPDATE" THEN
  DO:
    IF ttbl_EDShipto1.Addr1 NE ttbl_EDShipto2.Addr1 THEN
    PUT STREAM s-audit-rpt UNFORMATTED "*" AT 1.
    PUT STREAM s-audit-rpt UNFORMATTED "?: " AT 3 ttbl_EDShipto2.Addr1.
  END.
END.
IF NOT v_field_changed OR ttbl_EDShipto1.Addr2 NE ttbl_EDShipto2.Addr2 OR action NE "UPDATE" THEN
DO:
  PUT STREAM s-audit-rpt UNFORMATTED "?: " AT 3 ttbl_EDShipto1.Addr2 " (Addr2)".
  IF action = "UPDATE" THEN
  DO:
    IF ttbl_EDShipto1.Addr2 NE ttbl_EDShipto2.Addr2 THEN
    PUT STREAM s-audit-rpt UNFORMATTED "*" AT 1.
    PUT STREAM s-audit-rpt UNFORMATTED "?: " AT 3 ttbl_EDShipto2.Addr2.
  END.
END.
IF NOT v_field_changed OR ttbl_EDShipto1.Attention NE ttbl_EDShipto2.Attention OR action NE "UPDATE" THEN
DO:
  PUT STREAM s-audit-rpt UNFORMATTED "?: " AT 3 ttbl_EDShipto1.Attention " (Attention)".
  IF action = "UPDATE" THEN
  DO:
    IF ttbl_EDShipto1.Attention NE ttbl_EDShipto2.Attention THEN
    PUT STREAM s-audit-rpt UNFORMATTED "*" AT 1.
    PUT STREAM s-audit-rpt UNFORMATTED "?: " AT 3 ttbl_EDShipto2.Attention.
  END.
END.
IF NOT v_field_changed OR ttbl_EDShipto1.By-code NE ttbl_EDShipto2.By-code OR action NE "UPDATE" THEN
DO:
  PUT STREAM s-audit-rpt UNFORMATTED "Store: " AT 3 ttbl_EDShipto1.By-code " (By-code)".
  IF action = "UPDATE" THEN
  DO:
    IF ttbl_EDShipto1.By-code NE ttbl_EDShipto2.By-code THEN
    PUT STREAM s-audit-rpt UNFORMATTED "*" AT 1.
    PUT STREAM s-audit-rpt UNFORMATTED "Store: " AT 3 ttbl_EDShipto2.By-code.
  END.
END.
IF NOT v_field_changed OR ttbl_EDShipto1.City NE ttbl_EDShipto2.City OR action NE "UPDATE" THEN
DO:
  PUT STREAM s-audit-rpt UNFORMATTED "?: " AT 3 ttbl_EDShipto1.City " (City)".
  IF action = "UPDATE" THEN
  DO:
    IF ttbl_EDShipto1.City NE ttbl_EDShipto2.City THEN
    PUT STREAM s-audit-rpt UNFORMATTED "*" AT 1.
    PUT STREAM s-audit-rpt UNFORMATTED "?: " AT 3 ttbl_EDShipto2.City.
  END.
END.
DO i = 1 TO 5:
IF NOT v_field_changed OR ttbl_EDShipto1.Comments[i] NE ttbl_EDShipto2.Comments[i] OR action NE "UPDATE" THEN
DO:
  PUT STREAM s-audit-rpt UNFORMATTED "?[" AT 3 i "]: " ttbl_EDShipto1.Comments[i] " (Comments[" i "])".
  IF action = "UPDATE" THEN
  DO:
    IF ttbl_EDShipto1.Comments[i] NE ttbl_EDShipto2.Comments[i] THEN
    PUT STREAM s-audit-rpt UNFORMATTED "*" AT 1.
    PUT STREAM s-audit-rpt UNFORMATTED "?[" AT 3 i "]: " ttbl_EDShipto2.Comments[i].
  END.
END.
END.
IF NOT v_field_changed OR ttbl_EDShipto1.Country NE ttbl_EDShipto2.Country OR action NE "UPDATE" THEN
DO:
  PUT STREAM s-audit-rpt UNFORMATTED "?: " AT 3 ttbl_EDShipto1.Country " (Country)".
  IF action = "UPDATE" THEN
  DO:
    IF ttbl_EDShipto1.Country NE ttbl_EDShipto2.Country THEN
    PUT STREAM s-audit-rpt UNFORMATTED "*" AT 1.
    PUT STREAM s-audit-rpt UNFORMATTED "?: " AT 3 ttbl_EDShipto2.Country.
  END.
END.
IF NOT v_field_changed OR ttbl_EDShipto1.Cust NE ttbl_EDShipto2.Cust OR action NE "UPDATE" THEN
DO:
  PUT STREAM s-audit-rpt UNFORMATTED "?: " AT 3 ttbl_EDShipto1.Cust " (Cust)".
  IF action = "UPDATE" THEN
  DO:
    IF ttbl_EDShipto1.Cust NE ttbl_EDShipto2.Cust THEN
    PUT STREAM s-audit-rpt UNFORMATTED "*" AT 1.
    PUT STREAM s-audit-rpt UNFORMATTED "?: " AT 3 ttbl_EDShipto2.Cust.
  END.
END.
IF NOT v_field_changed OR ttbl_EDShipto1.Cust-Region NE ttbl_EDShipto2.Cust-Region OR action NE "UPDATE" THEN
DO:
  PUT STREAM s-audit-rpt UNFORMATTED "?: " AT 3 ttbl_EDShipto1.Cust-Region " (Cust-Region)".
  IF action = "UPDATE" THEN
  DO:
    IF ttbl_EDShipto1.Cust-Region NE ttbl_EDShipto2.Cust-Region THEN
    PUT STREAM s-audit-rpt UNFORMATTED "*" AT 1.
    PUT STREAM s-audit-rpt UNFORMATTED "?: " AT 3 ttbl_EDShipto2.Cust-Region.
  END.
END.
IF NOT v_field_changed OR ttbl_EDShipto1.Description NE ttbl_EDShipto2.Description OR action NE "UPDATE" THEN
DO:
  PUT STREAM s-audit-rpt UNFORMATTED "?: " AT 3 ttbl_EDShipto1.Description " (Description)".
  IF action = "UPDATE" THEN
  DO:
    IF ttbl_EDShipto1.Description NE ttbl_EDShipto2.Description THEN
    PUT STREAM s-audit-rpt UNFORMATTED "*" AT 1.
    PUT STREAM s-audit-rpt UNFORMATTED "?: " AT 3 ttbl_EDShipto2.Description.
  END.
END.
IF NOT v_field_changed OR ttbl_EDShipto1.Dest-Zone NE ttbl_EDShipto2.Dest-Zone OR action NE "UPDATE" THEN
DO:
  PUT STREAM s-audit-rpt UNFORMATTED "?: " AT 3 ttbl_EDShipto1.Dest-Zone " (Dest-Zone)".
  IF action = "UPDATE" THEN
  DO:
    IF ttbl_EDShipto1.Dest-Zone NE ttbl_EDShipto2.Dest-Zone THEN
    PUT STREAM s-audit-rpt UNFORMATTED "*" AT 1.
    PUT STREAM s-audit-rpt UNFORMATTED "?: " AT 3 ttbl_EDShipto2.Dest-Zone.
  END.
END.
IF NOT v_field_changed OR ttbl_EDShipto1.Fax NE ttbl_EDShipto2.Fax OR action NE "UPDATE" THEN
DO:
  PUT STREAM s-audit-rpt UNFORMATTED "?: " AT 3 ttbl_EDShipto1.Fax " (Fax)".
  IF action = "UPDATE" THEN
  DO:
    IF ttbl_EDShipto1.Fax NE ttbl_EDShipto2.Fax THEN
    PUT STREAM s-audit-rpt UNFORMATTED "*" AT 1.
    PUT STREAM s-audit-rpt UNFORMATTED "?: " AT 3 ttbl_EDShipto2.Fax.
  END.
END.
IF NOT v_field_changed OR ttbl_EDShipto1.Name NE ttbl_EDShipto2.Name OR action NE "UPDATE" THEN
DO:
  PUT STREAM s-audit-rpt UNFORMATTED "?: " AT 3 ttbl_EDShipto1.Name " (Name)".
  IF action = "UPDATE" THEN
  DO:
    IF ttbl_EDShipto1.Name NE ttbl_EDShipto2.Name THEN
    PUT STREAM s-audit-rpt UNFORMATTED "*" AT 1.
    PUT STREAM s-audit-rpt UNFORMATTED "?: " AT 3 ttbl_EDShipto2.Name.
  END.
END.
IF NOT v_field_changed OR ttbl_EDShipto1.Opened NE ttbl_EDShipto2.Opened OR action NE "UPDATE" THEN
DO:
  PUT STREAM s-audit-rpt UNFORMATTED "?: " AT 3 ttbl_EDShipto1.Opened FORMAT "99/99/99" " (Opened)".
  IF action = "UPDATE" THEN
  DO:
    IF ttbl_EDShipto1.Opened NE ttbl_EDShipto2.Opened THEN
    PUT STREAM s-audit-rpt UNFORMATTED "*" AT 1.
    PUT STREAM s-audit-rpt UNFORMATTED "?: " AT 3 ttbl_EDShipto2.Opened FORMAT "99/99/99".
  END.
END.
IF NOT v_field_changed OR ttbl_EDShipto1.Partner NE ttbl_EDShipto2.Partner OR action NE "UPDATE" THEN
DO:
  PUT STREAM s-audit-rpt UNFORMATTED "?: " AT 3 ttbl_EDShipto1.Partner " (Partner)".
  IF action = "UPDATE" THEN
  DO:
    IF ttbl_EDShipto1.Partner NE ttbl_EDShipto2.Partner THEN
    PUT STREAM s-audit-rpt UNFORMATTED "*" AT 1.
    PUT STREAM s-audit-rpt UNFORMATTED "?: " AT 3 ttbl_EDShipto2.Partner.
  END.
END.
IF NOT v_field_changed OR ttbl_EDShipto1.Phone NE ttbl_EDShipto2.Phone OR action NE "UPDATE" THEN
DO:
  PUT STREAM s-audit-rpt UNFORMATTED "?: " AT 3 ttbl_EDShipto1.Phone " (Phone)".
  IF action = "UPDATE" THEN
  DO:
    IF ttbl_EDShipto1.Phone NE ttbl_EDShipto2.Phone THEN
    PUT STREAM s-audit-rpt UNFORMATTED "*" AT 1.
    PUT STREAM s-audit-rpt UNFORMATTED "?: " AT 3 ttbl_EDShipto2.Phone.
  END.
END.
IF NOT v_field_changed OR ttbl_EDShipto1.Ref-type NE ttbl_EDShipto2.Ref-type OR action NE "UPDATE" THEN
DO:
  PUT STREAM s-audit-rpt UNFORMATTED "Type: " AT 3 ttbl_EDShipto1.Ref-type " (Ref-type)".
  IF action = "UPDATE" THEN
  DO:
    IF ttbl_EDShipto1.Ref-type NE ttbl_EDShipto2.Ref-type THEN
    PUT STREAM s-audit-rpt UNFORMATTED "*" AT 1.
    PUT STREAM s-audit-rpt UNFORMATTED "Type: " AT 3 ttbl_EDShipto2.Ref-type.
  END.
END.
IF NOT v_field_changed OR ttbl_EDShipto1.Ship-to NE ttbl_EDShipto2.Ship-to OR action NE "UPDATE" THEN
DO:
  PUT STREAM s-audit-rpt UNFORMATTED "?: " AT 3 ttbl_EDShipto1.Ship-to " (Ship-to)".
  IF action = "UPDATE" THEN
  DO:
    IF ttbl_EDShipto1.Ship-to NE ttbl_EDShipto2.Ship-to THEN
    PUT STREAM s-audit-rpt UNFORMATTED "*" AT 1.
    PUT STREAM s-audit-rpt UNFORMATTED "?: " AT 3 ttbl_EDShipto2.Ship-to.
  END.
END.
IF NOT v_field_changed OR ttbl_EDShipto1.St-code NE ttbl_EDShipto2.St-code OR action NE "UPDATE" THEN
DO:
  PUT STREAM s-audit-rpt UNFORMATTED "DC Code: " AT 3 ttbl_EDShipto1.St-code " (St-code)".
  IF action = "UPDATE" THEN
  DO:
    IF ttbl_EDShipto1.St-code NE ttbl_EDShipto2.St-code THEN
    PUT STREAM s-audit-rpt UNFORMATTED "*" AT 1.
    PUT STREAM s-audit-rpt UNFORMATTED "DC Code: " AT 3 ttbl_EDShipto2.St-code.
  END.
END.
IF NOT v_field_changed OR ttbl_EDShipto1.State NE ttbl_EDShipto2.State OR action NE "UPDATE" THEN
DO:
  PUT STREAM s-audit-rpt UNFORMATTED "?: " AT 3 ttbl_EDShipto1.State " (State)".
  IF action = "UPDATE" THEN
  DO:
    IF ttbl_EDShipto1.State NE ttbl_EDShipto2.State THEN
    PUT STREAM s-audit-rpt UNFORMATTED "*" AT 1.
    PUT STREAM s-audit-rpt UNFORMATTED "?: " AT 3 ttbl_EDShipto2.State.
  END.
END.
IF NOT v_field_changed OR ttbl_EDShipto1.Zip NE ttbl_EDShipto2.Zip OR action NE "UPDATE" THEN
DO:
  PUT STREAM s-audit-rpt UNFORMATTED "?: " AT 3 ttbl_EDShipto1.Zip " (Zip)".
  IF action = "UPDATE" THEN
  DO:
    IF ttbl_EDShipto1.Zip NE ttbl_EDShipto2.Zip THEN
    PUT STREAM s-audit-rpt UNFORMATTED "*" AT 1.
    PUT STREAM s-audit-rpt UNFORMATTED "?: " AT 3 ttbl_EDShipto2.Zip.
  END.
END.
IF v_show_index THEN
DO:
  PUT STREAM s-audit-rpt UNFORMATTED "Index Fields - Label: Value (database field-name)" AT 5.
  PUT STREAM s-audit-rpt UNFORMATTED "?: " AT 7.
  IF action = "UPDATE" THEN
  PUT STREAM s-audit-rpt UNFORMATTED ttbl_EDShipto2.Partner " (Partner)".
  ELSE
  PUT STREAM s-audit-rpt UNFORMATTED ttbl_EDShipto1.Partner " (Partner)".
  PUT STREAM s-audit-rpt UNFORMATTED "Type: " AT 7.
  IF action = "UPDATE" THEN
  PUT STREAM s-audit-rpt UNFORMATTED ttbl_EDShipto2.Ref-type " (Ref-type)".
  ELSE
  PUT STREAM s-audit-rpt UNFORMATTED ttbl_EDShipto1.Ref-type " (Ref-type)".
  PUT STREAM s-audit-rpt UNFORMATTED "Store: " AT 7.
  IF action = "UPDATE" THEN
  PUT STREAM s-audit-rpt UNFORMATTED ttbl_EDShipto2.By-code " (By-code)".
  ELSE
  PUT STREAM s-audit-rpt UNFORMATTED ttbl_EDShipto1.By-code " (By-code)".
END.
PUT STREAM s-audit-rpt UNFORMATTED SKIP(1).
