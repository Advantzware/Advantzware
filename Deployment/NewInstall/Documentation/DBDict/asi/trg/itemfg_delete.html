<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
  <meta name="generator" content="HtmlDict.w version 11">
  <meta name="author"    content="Patrick Tingen [patrick at tingen dot nl]">
  <link rel="stylesheet" title="Default" type="text/css" href="../../default.css">
  <link rel="alternate stylesheet" title="blue" type="text/css" href="../../blue.css">
  <link rel="alternate stylesheet" title="default" type="text/css" href="../../default.css">
  <link rel="alternate stylesheet" title="green" type="text/css" href="../../green.css">
  <link rel="alternate stylesheet" title="oldstyle" type="text/css" href="../../oldstyle.css">
  <link rel="alternate stylesheet" title="red" type="text/css" href="../../red.css">
  <link rel="shortcut icon" href="../../htmldict.ico">
  <link rel="stylesheet" media="print" type="text/css" href="../../print.css">
  <script src="../../swapstyle.js"    type="text/javascript"></script>
  <script src="../../stylechooser.js" type="text/javascript"></script>
  <script src="../../dbchooser.js"    type="text/javascript"></script>
  <script src="../../htmldict.js"     type="text/javascript"></script>
  <title> Trigger code: delete of itemfg</title>
</head>
<body onload="useStyleAgain('HtmlDict');" onunload="rememberStyle('HtmlDict',10);">
<div><a name="top"></a></div>
<table style="width:100%;">
  <tr>
    <td class="navbar" style="width:80%;"><a href="../../../00-index.html"target="_top">DB</a>
 | <a href="../../00-area.html"target="main">Areas</a>
 | <a href="../../00-cross.html"target="main">X-idx</a>
 | <a href="../../00-main.html"target="main">Tables</a>
 | <a href="../../00-sequences.html"target="main">Sequences</a>
</td>
    <td class="navbar" style="width:20%; text-align:right;"><a href="../../htmldict.html"target="_top">HtmlDict 11</a></td>
  </tr>
</table>
 
<h1>Trigger code: delete of itemfg</h1>
<div class="progressCode">
<span class="src-prep">&amp;Scoped-define</span><!--src-prep--> ACTION <span class="src-keyword">DELETE</span><!--src-keyword-->
<span class="src-prep">&amp;Scoped-define</span><!--src-prep--> <span class="src-keyword">DBNAME</span><!--src-keyword--> ASI
<span class="src-prep">&amp;Scoped-define</span><!--src-prep--> TABLENAME itemfg
 
<span class="src-keyword">TRIGGER PROCEDURE FOR DELETE OF</span><!--src-keyword--> <span class="src-prep">{&amp;TABLENAME}</span><!--src-prep-->.
 
<span class="src-prep">{methods/<span class="src-keyword">triggers</span><!--src-keyword-->/<span class="src-keyword">delete</span><!--src-keyword-->.i}</span><!--src-prep-->
 
<span class="src-keyword">DEF BUFFER</span><!--src-keyword--> set-<span class="src-prep">{&amp;TABLENAME}</span><!--src-prep--> <span class="src-keyword">FOR</span><!--src-keyword--> <span class="src-prep">{&amp;TABLENAME}</span><!--src-prep-->.
 
<span class="src-keyword">DEF VAR</span><!--src-keyword--> v-msg <span class="src-keyword">AS CHAR INIT</span><!--src-keyword--> <span class="src-char">""</span><!--src-char--> <span class="src-keyword">NO-UNDO</span><!--src-keyword-->.
<span class="src-keyword">DEF VAR</span><!--src-keyword--> choice <span class="src-keyword">AS LOG INIT NO NO-UNDO</span><!--src-keyword-->.
 
<span class="src-keyword">IF</span><!--src-keyword--> <span class="src-prep">{&amp;TABLENAME}</span><!--src-prep-->.i-no <span class="src-keyword">NE</span><!--src-keyword--> <span class="src-char">""</span><!--src-char--> <span class="src-keyword">THEN DO</span><!--src-keyword-->:
 
  <span class="src-prep">{delete.trg\<span class="src-prep">{&amp;TABLENAME}</span><!--src-prep-->.i <span class="src-prep">&amp;fil</span><!--src-prep-->=eb        <span class="src-prep">&amp;fld</span><!--src-prep-->=stock-no   <span class="src-prep">&amp;msg</span><!--src-prep-->=<span class="src-char">"Estimate"</span><!--src-char-->}</span><!--src-prep-->
 
  <span class="src-prep">{delete.trg\<span class="src-prep">{&amp;TABLENAME}</span><!--src-prep-->.i <span class="src-prep">&amp;fil</span><!--src-prep-->=job-hdr   <span class="src-prep">&amp;fld</span><!--src-prep-->=i-no       <span class="src-prep">&amp;msg</span><!--src-prep-->=<span class="src-char">"Job"</span><!--src-char-->}</span><!--src-prep-->
 
  <span class="src-prep">{delete.trg\<span class="src-prep">{&amp;TABLENAME}</span><!--src-prep-->.i <span class="src-prep">&amp;fil</span><!--src-prep-->=oe-ordl   <span class="src-prep">&amp;fld</span><!--src-prep-->=i-no       <span class="src-prep">&amp;msg</span><!--src-prep-->=<span class="src-char">"Order"</span><!--src-char-->}</span><!--src-prep-->
 
<span class="src-comment">/* wfk - 05161319 - unindexed search, if oe-ordl is not there, oe-rel should not */</span><!--src-comment-->
<span class="src-comment">/*  {delete.trg\{&amp;TABLENAME}.i &amp;fil=oe-rel    &amp;fld=i-no       &amp;msg="Scheduled Release"} */</span><!--src-comment-->
 
  <span class="src-prep">{delete.trg\<span class="src-prep">{&amp;TABLENAME}</span><!--src-prep-->.i <span class="src-prep">&amp;fil</span><!--src-prep-->=oe-rell   <span class="src-prep">&amp;fld</span><!--src-prep-->=i-no       <span class="src-prep">&amp;msg</span><!--src-prep-->=<span class="src-char">"Actual Release"</span><!--src-char-->}</span><!--src-prep-->
 
  <span class="src-prep">{delete.trg\<span class="src-prep">{&amp;TABLENAME}</span><!--src-prep-->.i <span class="src-prep">&amp;fil</span><!--src-prep-->=oe-boll   <span class="src-prep">&amp;fld</span><!--src-prep-->=i-no       <span class="src-prep">&amp;msg</span><!--src-prep-->=<span class="src-char">"BOL"</span><!--src-char-->}</span><!--src-prep-->
 
  <span class="src-prep">{delete.trg\<span class="src-prep">{&amp;TABLENAME}</span><!--src-prep-->.i <span class="src-prep">&amp;fil</span><!--src-prep-->=inv-line  <span class="src-prep">&amp;fld</span><!--src-prep-->=i-no       <span class="src-prep">&amp;msg</span><!--src-prep-->=<span class="src-char">"Unposted Invoice"</span><!--src-char-->}</span><!--src-prep-->
 
  <span class="src-prep">{delete.trg\<span class="src-prep">{&amp;TABLENAME}</span><!--src-prep-->.i <span class="src-prep">&amp;fil</span><!--src-prep-->=ar-invl   <span class="src-prep">&amp;fld</span><!--src-prep-->=i-no       <span class="src-prep">&amp;msg</span><!--src-prep-->=<span class="src-char">"Posted Invoice"</span><!--src-char-->}</span><!--src-prep-->
<span class="src-keyword">END</span><!--src-keyword-->.
 
<span class="src-keyword">IF</span><!--src-keyword--> v-msg <span class="src-keyword">NE</span><!--src-keyword--> <span class="src-char">""</span><!--src-char--> <span class="src-keyword">THEN DO</span><!--src-keyword-->:
  <span class="src-keyword">MESSAGE</span><!--src-keyword--> v-msg <span class="src-keyword">VIEW-AS ALERT-BOX ERROR</span><!--src-keyword-->.
  <span class="src-keyword">RETURN ERROR</span><!--src-keyword-->.
<span class="src-keyword">END</span><!--src-keyword-->.
 
delete-children: <span class="src-keyword">DO TRANSACTION</span><!--src-keyword-->.
  <span class="src-keyword">IF</span><!--src-keyword--> <span class="src-prep">{&amp;TABLENAME}</span><!--src-prep-->.i-no <span class="src-keyword">NE</span><!--src-keyword--> <span class="src-char">""</span><!--src-char--> <span class="src-keyword">THEN</span><!--src-keyword-->
  <span class="src-keyword">FOR EACH</span><!--src-keyword--> fg-set
      <span class="src-keyword">WHERE</span><!--src-keyword--> fg-set.company <span class="src-keyword">EQ</span><!--src-keyword--> <span class="src-prep">{&amp;TABLENAME}</span><!--src-prep-->.company
        <span class="src-keyword">AND</span><!--src-keyword--> fg-set.part-no <span class="src-keyword">EQ</span><!--src-keyword--> <span class="src-prep">{&amp;TABLENAME}</span><!--src-prep-->.i-no
      <span class="src-keyword">BREAK BY</span><!--src-keyword--> fg-set.part-no:
 
    <span class="src-keyword">IF FIRST</span><!--src-keyword-->(fg-set.part-no) <span class="src-keyword">THEN DO</span><!--src-keyword-->:
      choice = <span class="src-keyword">NO</span><!--src-keyword-->.
      <span class="src-keyword">MESSAGE</span><!--src-keyword--> <span class="src-char">"This item is part of a set, delete anyway?"</span><!--src-char-->
              <span class="src-keyword">VIEW-AS ALERT-BOX QUESTION BUTTON YES-NO</span><!--src-keyword-->
              <span class="src-keyword">UPDATE</span><!--src-keyword--> choice.
      <span class="src-keyword">IF NOT</span><!--src-keyword--> choice <span class="src-keyword">THEN UNDO</span><!--src-keyword--> delete-children, <span class="src-keyword">RETURN ERROR</span><!--src-keyword-->.
    <span class="src-keyword">END</span><!--src-keyword-->.
 
    <span class="src-keyword">DELETE</span><!--src-keyword--> fg-set.
  <span class="src-keyword">END</span><!--src-keyword-->.
 
  <span class="src-keyword">IF</span><!--src-keyword--> <span class="src-prep">{&amp;TABLENAME}</span><!--src-prep-->.i-no <span class="src-keyword">NE</span><!--src-keyword--> <span class="src-char">""</span><!--src-char--> <span class="src-keyword">THEN</span><!--src-keyword-->
  <span class="src-keyword">FOR EACH</span><!--src-keyword--> fg-set
      <span class="src-keyword">WHERE</span><!--src-keyword--> fg-set.company <span class="src-keyword">EQ</span><!--src-keyword--> <span class="src-prep">{&amp;TABLENAME}</span><!--src-prep-->.company
        <span class="src-keyword">AND</span><!--src-keyword--> fg-set.set-no  <span class="src-keyword">EQ</span><!--src-keyword--> <span class="src-prep">{&amp;TABLENAME}</span><!--src-prep-->.i-no
      <span class="src-keyword">BREAK BY</span><!--src-keyword--> fg-set.set-no:
 
    <span class="src-keyword">IF FIRST</span><!--src-keyword-->(fg-set.set-no) <span class="src-keyword">THEN DO</span><!--src-keyword-->:
      choice = <span class="src-keyword">NO</span><!--src-keyword-->.
      <span class="src-keyword">MESSAGE</span><!--src-keyword--> <span class="src-char">"This item is a set, delete all components?"</span><!--src-char-->
              <span class="src-keyword">VIEW-AS ALERT-BOX QUESTION BUTTON YES-NO</span><!--src-keyword-->
              <span class="src-keyword">UPDATE</span><!--src-keyword--> choice.
    <span class="src-keyword">END</span><!--src-keyword-->.
 
    <span class="src-keyword">IF</span><!--src-keyword--> choice <span class="src-keyword">THEN DO</span><!--src-keyword-->:
      <span class="src-keyword">FIND FIRST</span><!--src-keyword--> set-<span class="src-prep">{&amp;TABLENAME}</span><!--src-prep-->
          <span class="src-keyword">WHERE</span><!--src-keyword--> set-<span class="src-prep">{&amp;TABLENAME}</span><!--src-prep-->.company <span class="src-keyword">EQ</span><!--src-keyword--> <span class="src-prep">{&amp;TABLENAME}</span><!--src-prep-->.company
            <span class="src-keyword">AND</span><!--src-keyword--> set-<span class="src-prep">{&amp;TABLENAME}</span><!--src-prep-->.i-no    <span class="src-keyword">EQ</span><!--src-keyword--> fg-set.part-no  
          <span class="src-keyword">NO-ERROR</span><!--src-keyword-->.
      <span class="src-keyword">IF AVAIL</span><!--src-keyword--> set-<span class="src-prep">{&amp;TABLENAME}</span><!--src-prep--> <span class="src-keyword">THEN DO</span><!--src-keyword-->:
        <span class="src-keyword">DISABLE TRIGGERS FOR LOAD OF</span><!--src-keyword--> set-<span class="src-prep">{&amp;TABLENAME}</span><!--src-prep-->.
        <span class="src-keyword">RUN</span><!--src-keyword--> fg/delkids.p (<span class="src-keyword">BUFFER</span><!--src-keyword--> set-<span class="src-prep">{&amp;TABLENAME}</span><!--src-prep-->).
        <span class="src-keyword">DELETE</span><!--src-keyword--> set-<span class="src-prep">{&amp;TABLENAME}</span><!--src-prep-->.
      <span class="src-keyword">END</span><!--src-keyword-->.
    <span class="src-keyword">END</span><!--src-keyword-->.
 
    <span class="src-keyword">DELETE</span><!--src-keyword--> fg-set.
  <span class="src-keyword">END</span><!--src-keyword-->.  <span class="src-comment">/* for each fg-set */</span><!--src-comment-->
  <span class="src-keyword">RUN</span><!--src-keyword--> fg/delkids.p (<span class="src-keyword">BUFFER</span><!--src-keyword--> <span class="src-prep">{&amp;TABLENAME}</span><!--src-prep-->).
<span class="src-keyword">END</span><!--src-keyword-->.  <span class="src-comment">/* delete-children */</span><!--src-comment-->
</div><!--progresscode-->
</body>
</html>
