<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
  <meta name="generator" content="HtmlDict.w version 11">
  <meta name="author"    content="Patrick Tingen [patrick at tingen dot nl]">
  <link rel="stylesheet" title="Default" type="text/css" href="../../default.css">
  <link rel="alternate stylesheet" title="blue" type="text/css" href="../../blue.css">
  <link rel="alternate stylesheet" title="default" type="text/css" href="../../default.css">
  <link rel="alternate stylesheet" title="green" type="text/css" href="../../green.css">
  <link rel="alternate stylesheet" title="oldstyle" type="text/css" href="../../oldstyle.css">
  <link rel="alternate stylesheet" title="red" type="text/css" href="../../red.css">
  <link rel="shortcut icon" href="../../htmldict.ico">
  <link rel="stylesheet" media="print" type="text/css" href="../../print.css">
  <script src="../../swapstyle.js"    type="text/javascript"></script>
  <script src="../../stylechooser.js" type="text/javascript"></script>
  <script src="../../dbchooser.js"    type="text/javascript"></script>
  <script src="../../htmldict.js"     type="text/javascript"></script>
  <title> Trigger code: write of eb</title>
</head>
<body onload="useStyleAgain('HtmlDict');" onunload="rememberStyle('HtmlDict',10);">
<div><a name="top"></a></div>
<table style="width:100%;">
  <tr>
    <td class="navbar" style="width:80%;"><a href="../../../00-index.html"target="_top">DB</a>
 | <a href="../../00-area.html"target="main">Areas</a>
 | <a href="../../00-cross.html"target="main">X-idx</a>
 | <a href="../../00-main.html"target="main">Tables</a>
 | <a href="../../00-sequences.html"target="main">Sequences</a>
</td>
    <td class="navbar" style="width:20%; text-align:right;"><a href="../../htmldict.html"target="_top">HtmlDict 11</a></td>
  </tr>
</table>
 
<h1>Trigger code: write of eb</h1>
<div class="progressCode">
<span class="src-prep">&amp;Scoped-define</span><!--src-prep--> ACTION <span class="src-keyword">UPDATE</span><!--src-keyword-->
<span class="src-prep">&amp;Scoped-define</span><!--src-prep--> <span class="src-keyword">DBNAME</span><!--src-keyword--> ASI
<span class="src-prep">&amp;Scoped-define</span><!--src-prep--> TABLENAME eb
 
<span class="src-keyword">TRIGGER PROCEDURE FOR WRITE OF</span><!--src-keyword--> <span class="src-prep">{&amp;TABLENAME}</span><!--src-prep--> <span class="src-keyword">OLD BUFFER</span><!--src-keyword--> old-<span class="src-prep">{&amp;TABLENAME}</span><!--src-prep-->.
 
<span class="src-prep">{methods/<span class="src-keyword">triggers</span><!--src-keyword-->/<span class="src-keyword">write</span><!--src-keyword-->.i}</span><!--src-prep-->
 
<span class="src-prep">{sys/inc/<span class="src-keyword">var</span><!--src-keyword-->.i <span class="src-keyword">NEW</span><!--src-keyword--> SHARED}</span><!--src-p<span class="src-keyword">SHARED</span><!--src-keyword-->
 
<span class="src-keyword">DEF BUFFER</span><!--src-keyword--> b-<span class="src-prep">{&amp;TABLENAME}</span><!--src-prep--> <span class="src-keyword">FOR</span><!--src-keyword--> <span class="src-prep">{&amp;TABLENAME}</span><!--src-prep-->.
<span class="src-keyword">DEF BUFFER</span><!--src-keyword--> xeb <span class="src-keyword">FOR</span><!--src-keyword--> <span class="src-prep">{&amp;TABLENAME}</span><!--src-prep-->.
<span class="src-keyword">DEF BUFFER</span><!--src-keyword--> b-ef <span class="src-keyword">FOR</span><!--src-keyword--> ef.
<span class="src-keyword">DEF BUFFER</span><!--src-keyword--> b-est-op <span class="src-keyword">FOR</span><!--src-keyword--> est-op.
<span class="src-keyword">DEF BUFFER</span><!--src-keyword--> b-itemfg <span class="src-keyword">FOR</span><!--src-keyword--> itemfg.
<span class="src-keyword">DEF BUFFER</span><!--src-keyword--> b-style <span class="src-keyword">FOR</span><!--src-keyword--> style.
 
<span class="src-keyword">DEF VAR</span><!--src-keyword--> ll-tandem <span class="src-keyword">AS LOG NO-UNDO</span><!--src-keyword-->.
<span class="src-keyword">DEF VAR</span><!--src-keyword--> li <span class="src-keyword">AS INT NO-UNDO</span><!--src-keyword-->.
<span class="src-keyword">DEF VAR</span><!--src-keyword--> lv-hld-cust <span class="src-keyword">LIKE</span><!--src-keyword--> <span class="src-prep">{&amp;TABLENAME}</span><!--src-prep-->.cust-no <span class="src-keyword">NO-UNDO</span><!--src-keyword-->.
<span class="src-keyword">DEF VAR</span><!--src-keyword--> lv-hld-ship <span class="src-keyword">LIKE</span><!--src-keyword--> <span class="src-prep">{&amp;TABLENAME}</span><!--src-prep-->.ship-id <span class="src-keyword">NO-UNDO</span><!--src-keyword-->.
<span class="src-keyword">DEF VAR</span><!--src-keyword--> lv-hld-board <span class="src-keyword">LIKE</span><!--src-keyword--> ef.board <span class="src-keyword">NO-UNDO</span><!--src-keyword-->.
<span class="src-keyword">DEF VAR</span><!--src-keyword--> lv-die-in <span class="src-keyword">LIKE</span><!--src-keyword--> ef.die-in <span class="src-keyword">NO-UNDO</span><!--src-keyword-->.
<span class="src-keyword">DEF VAR</span><!--src-keyword--> ll-inked <span class="src-keyword">AS LOG NO-UNDO</span><!--src-keyword-->.
<span class="src-keyword">DEF VAR</span><!--src-keyword--> ll-web <span class="src-keyword">AS LOG NO-UNDO</span><!--src-keyword-->.
<span class="src-keyword">DEF VAR</span><!--src-keyword--> ll <span class="src-keyword">AS LOG NO-UNDO</span><!--src-keyword-->.
<span class="src-keyword">DEF VAR</span><!--src-keyword--> ld-len <span class="src-keyword">AS DEC NO-UNDO</span><!--src-keyword-->.
<span class="src-keyword">DEF VAR</span><!--src-keyword--> ld-wid <span class="src-keyword">AS DEC NO-UNDO</span><!--src-keyword-->.
<span class="src-keyword">DEF VAR</span><!--src-keyword--> ld-dep <span class="src-keyword">AS DEC NO-UNDO</span><!--src-keyword-->.
<span class="src-keyword">DEF VAR</span><!--src-keyword--> rec-list <span class="src-keyword">AS CHAR NO-UNDO</span><!--src-keyword-->.
<span class="src-keyword">DEF VAR</span><!--src-keyword--> K_FRAC <span class="src-keyword">AS DEC INIT</span><!--src-keyword--> <span class="src-number">6</span><!--src-number-->.<span class="src-number">25</span><!--src-number--> <span class="src-keyword">NO-UNDO</span><!--src-keyword-->.
 
<span class="src-keyword">DEF TEMP-TABLE</span><!--src-keyword--> w-itemfg-ink <span class="src-keyword">LIKE</span><!--src-keyword--> itemfg-ink
    <span class="src-keyword">FIELD</span><!--src-keyword--> old-rm-i-no <span class="src-keyword">LIKE</span><!--src-keyword--> itemfg-ink.rm-i-no
    <span class="src-keyword">FIELD</span><!--src-keyword--> old-pass    <span class="src-keyword">LIKE</span><!--src-keyword--> itemfg-ink.pass.
 
 
<span class="src-keyword">DISABLE TRIGGERS FOR LOAD OF</span><!--src-keyword--> est.
<span class="src-keyword">DISABLE TRIGGERS FOR LOAD OF</span><!--src-keyword--> ef.
<span class="src-keyword">DISABLE TRIGGERS FOR LOAD OF</span><!--src-keyword--> est-op.
<span class="src-keyword">DISABLE TRIGGERS FOR LOAD OF</span><!--src-keyword--> b-<span class="src-prep">{&amp;TABLENAME}</span><!--src-prep-->.
<span class="src-keyword">DISABLE TRIGGERS FOR LOAD OF</span><!--src-keyword--> xeb.
<span class="src-keyword">DISABLE TRIGGERS FOR LOAD OF</span><!--src-keyword--> itemfg.
<span class="src-keyword">DISABLE TRIGGERS FOR LOAD OF</span><!--src-keyword--> itemfg-ink.
 
cocode = <span class="src-prep">{&amp;TABLENAME}</span><!--src-prep-->.company.
 
<span class="src-prep">{ce/msfcalc.i}</span><!--src-prep-->
 
<span class="src-prep">{sys/inc/f16to32.i}</span><!--src-prep-->
 
<span class="src-prep">{&amp;TABLENAME}</span><!--src-prep-->.est-no = <span class="src-keyword">FILL</span><!--src-keyword-->(<span class="src-char">" "</span><!--src-char-->,<span class="src-number">8</span><!--src-number--> <span class="src-keyword">- LENGTH</span><!--src-keyword-->(<span class="src-keyword">TRIM</span><!--src-keyword-->(<span class="src-prep">{&amp;TABLENAME}</span><!--src-prep-->.est-no))) +
                      <span class="src-keyword">TRIM</span><!--src-keyword-->(<span class="src-prep">{&amp;TABLENAME}</span><!--src-prep-->.est-no).
 
<span class="src-keyword">IF</span><!--src-keyword--> <span class="src-prep">{&amp;TABLENAME}</span><!--src-prep-->.est-type <span class="src-keyword">EQ</span><!--src-keyword--> <span class="src-number">?</span><!--src-number--> <span class="src-keyword">THEN</span><!--src-keyword-->
  <span class="src-keyword">RUN</span><!--src-keyword--> est/resettyp.p (<span class="src-keyword">ROWID</span><!--src-keyword-->(<span class="src-prep">{&amp;TABLENAME}</span><!--src-prep-->), <span class="src-keyword">OUTPUT</span><!--src-keyword--> <span class="src-prep">{&amp;TABLENAME}</span><!--src-prep-->.est-type).
 
<span class="src-keyword">IF</span><!--src-keyword--> <span class="src-prep">{&amp;TABLENAME}</span><!--src-prep-->.est-type <span class="src-keyword">EQ</span><!--src-keyword--> <span class="src-number">3</span><!--src-number--> <span class="src-keyword">THEN</span><!--src-keyword--> <span class="src-prep">{&amp;TABLENAME}</span><!--src-prep-->.est-type = <span class="src-number">4</span><!--src-number-->.
 
<span class="src-keyword">find first</span><!--src-keyword--> b-style <span class="src-keyword">where</span><!--src-keyword--> b-style.company = cocode <span class="src-keyword">and</span><!--src-keyword-->
                         b-style.style = <span class="src-prep">{&amp;TABLENAME}</span><!--src-prep-->.style
                         <span class="src-keyword">no-lock no-error</span><!--src-keyword-->.
  <span class="src-keyword">if avail</span><!--src-keyword--> b-style <span class="src-keyword">and</span><!--src-keyword--> b-style.<span class="src-keyword">type &lt;&gt;</span><!--src-keyword--> <span class="src-char">"F"</span><!--src-char--> <span class="src-keyword">THEN</span><!--src-keyword-->
        <span class="src-prep">{&amp;TABLENAME}</span><!--src-prep-->.num-up = (<span class="src-keyword">IF</span><!--src-keyword--> <span class="src-prep">{&amp;TABLENAME}</span><!--src-prep-->.num-wid <span class="src-keyword">EQ</span><!--src-keyword--> <span class="src-number">0</span><!--src-number--> <span class="src-keyword">THEN</span><!--src-keyword--> <span class="src-number">1</span><!--src-number--> <span class="src-keyword">ELSE</span><!--src-keyword--> <span class="src-prep">{&amp;TABLENAME}</span><!--src-prep-->.num-wid) <span class="src-keyword">*</span><!--src-keyword-->
                      (<span class="src-keyword">IF</span><!--src-keyword--> <span class="src-prep">{&amp;TABLENAME}</span><!--src-prep-->.num-len <span class="src-keyword">EQ</span><!--src-keyword--> <span class="src-number">0</span><!--src-number--> <span class="src-keyword">THEN</span><!--src-keyword--> <span class="src-number">1</span><!--src-number--> <span class="src-keyword">ELSE</span><!--src-keyword--> <span class="src-prep">{&amp;TABLENAME}</span><!--src-prep-->.num-len) <span class="src-keyword">*</span><!--src-keyword-->
                      (<span class="src-keyword">IF</span><!--src-keyword--> <span class="src-prep">{&amp;TABLENAME}</span><!--src-prep-->.num-dep <span class="src-keyword">EQ</span><!--src-keyword--> <span class="src-number">0</span><!--src-number--> <span class="src-keyword">THEN</span><!--src-keyword--> <span class="src-number">1</span><!--src-number--> <span class="src-keyword">ELSE</span><!--src-keyword--> <span class="src-prep">{&amp;TABLENAME}</span><!--src-prep-->.num-dep).
 
<span class="src-keyword">IF</span><!--src-keyword--> <span class="src-prep">{&amp;TABLENAME}</span><!--src-prep-->.est-type <span class="src-keyword">EQ</span><!--src-keyword--> <span class="src-number">2</span><!--src-number--> <span class="src-keyword">AND</span><!--src-keyword-->
   <span class="src-prep">{&amp;TABLENAME}</span><!--src-prep-->.cust-% <span class="src-keyword">EQ</span><!--src-keyword--> <span class="src-number">0</span><!--src-number-->   <span class="src-keyword">THEN</span><!--src-keyword--> <span class="src-prep">{&amp;TABLENAME}</span><!--src-prep-->.cust-%  = <span class="src-number">1</span><!--src-number-->.
<span class="src-keyword">ELSE</span><!--src-keyword-->
<span class="src-keyword">IF</span><!--src-keyword--> <span class="src-prep">{&amp;TABLENAME}</span><!--src-prep-->.est-type <span class="src-keyword">GE</span><!--src-keyword--> <span class="src-number">5</span><!--src-number--> <span class="src-keyword">AND</span><!--src-keyword--> <span class="src-prep">{&amp;TABLENAME}</span><!--src-prep-->.est-type <span class="src-keyword">LE</span><!--src-keyword--> <span class="src-number">6</span><!--src-number--> <span class="src-keyword">AND</span><!--src-keyword--> 
   <span class="src-prep">{&amp;TABLENAME}</span><!--src-prep-->.quantityPerSet <span class="src-keyword">EQ</span><!--src-keyword--> <span class="src-number">0</span><!--src-number-->  <span class="src-keyword">THEN</span><!--src-keyword--> <span class="src-prep">{&amp;TABLENAME}</span><!--src-prep-->.quantityPerSet = <span class="src-number">1</span><!--src-number-->.
 
<span class="src-keyword">IF</span><!--src-keyword--> <span class="src-prep">{&amp;TABLENAME}</span><!--src-prep-->.part-no     <span class="src-keyword">NE</span><!--src-keyword--> <span class="src-char">""</span><!--src-char--> <span class="src-keyword">AND</span><!--src-keyword-->
   old-<span class="src-prep">{&amp;TABLENAME}</span><!--src-prep-->.part-no <span class="src-keyword">NE</span><!--src-keyword--> <span class="src-char">""</span><!--src-char--> <span class="src-keyword">THEN RUN</span><!--src-keyword--> est/validset.p (<span class="src-keyword">BUFFER</span><!--src-keyword--> <span class="src-prep">{&amp;TABLENAME}</span><!--src-prep-->).
 
<span class="src-keyword">IF</span><!--src-keyword--> <span class="src-prep">{&amp;TABLENAME}</span><!--src-prep-->.part-no <span class="src-keyword">NE</span><!--src-keyword--> old-<span class="src-prep">{&amp;TABLENAME}</span><!--src-prep-->.part-no <span class="src-keyword">AND</span><!--src-keyword-->
   old-<span class="src-prep">{&amp;tablename}</span><!--src-prep-->.part-no <span class="src-keyword">NE</span><!--src-keyword--> <span class="src-char">""</span><!--src-char--> <span class="src-keyword">THEN</span><!--src-keyword-->
   <span class="src-keyword">FOR EACH</span><!--src-keyword--> probeit <span class="src-keyword">WHERE</span><!--src-keyword-->
       probeit.company <span class="src-keyword">EQ</span><!--src-keyword--> <span class="src-prep">{&amp;tablename}</span><!--src-prep-->.company <span class="src-keyword">AND</span><!--src-keyword-->
       probeit.est-no <span class="src-keyword">EQ</span><!--src-keyword--> <span class="src-prep">{&amp;tablename}</span><!--src-prep-->.est-no <span class="src-keyword">AND</span><!--src-keyword-->
       probeit.part-no <span class="src-keyword">EQ</span><!--src-keyword--> old-<span class="src-prep">{&amp;tablename}</span><!--src-prep-->.part-no:
 
       probeit.part-no = <span class="src-prep">{&amp;tablename}</span><!--src-prep-->.part-no.
   <span class="src-keyword">END</span><!--src-keyword-->.
 
 
<span class="src-keyword">IF</span><!--src-keyword--> <span class="src-prep">{&amp;TABLENAME}</span><!--src-prep-->.form-no <span class="src-keyword">EQ</span><!--src-keyword--> <span class="src-number">0</span><!--src-number-->                                      <span class="src-keyword">AND</span><!--src-keyword-->
   <span class="src-prep">{&amp;TABLENAME}</span><!--src-prep-->.stock-no <span class="src-keyword">NE</span><!--src-keyword--> <span class="src-char">""</span><!--src-char-->                                    <span class="src-keyword">AND</span><!--src-keyword-->
   <span class="src-keyword">CAN-FIND</span><!--src-keyword-->(<span class="src-keyword">FIRST</span><!--src-keyword--> b-<span class="src-prep">{&amp;TABLENAME}</span><!--src-prep-->
            <span class="src-keyword">WHERE</span><!--src-keyword--> b-<span class="src-prep">{&amp;TABLENAME}</span><!--src-prep-->.company  <span class="src-keyword">EQ</span><!--src-keyword--> <span class="src-prep">{&amp;TABLENAME}</span><!--src-prep-->.company
              <span class="src-keyword">AND</span><!--src-keyword--> b-<span class="src-prep">{&amp;TABLENAME}</span><!--src-prep-->.est-no   <span class="src-keyword">EQ</span><!--src-keyword--> <span class="src-prep">{&amp;TABLENAME}</span><!--src-prep-->.est-no
              <span class="src-keyword">AND</span><!--src-keyword--> b-<span class="src-prep">{&amp;TABLENAME}</span><!--src-prep-->.stock-no <span class="src-keyword">EQ</span><!--src-keyword--> <span class="src-prep">{&amp;TABLENAME}</span><!--src-prep-->.stock-no
              <span class="src-keyword">AND ROWID</span><!--src-keyword-->(b-<span class="src-prep">{&amp;TABLENAME}</span><!--src-prep-->)   <span class="src-keyword">NE ROWID</span><!--src-keyword-->(<span class="src-prep">{&amp;TABLENAME}</span><!--src-prep-->)) <span class="src-keyword">AND</span><!--src-keyword-->
   <span class="src-keyword">CAN-FIND</span><!--src-keyword-->(<span class="src-keyword">FIRST</span><!--src-keyword--> b-<span class="src-prep">{&amp;TABLENAME}</span><!--src-prep-->
            <span class="src-keyword">WHERE</span><!--src-keyword--> b-<span class="src-prep">{&amp;TABLENAME}</span><!--src-prep-->.company  <span class="src-keyword">EQ</span><!--src-keyword--> <span class="src-prep">{&amp;TABLENAME}</span><!--src-prep-->.company
              <span class="src-keyword">AND</span><!--src-keyword--> b-<span class="src-prep">{&amp;TABLENAME}</span><!--src-prep-->.est-no   <span class="src-keyword">EQ</span><!--src-keyword--> <span class="src-prep">{&amp;TABLENAME}</span><!--src-prep-->.est-no
              <span class="src-keyword">AND</span><!--src-keyword--> b-<span class="src-prep">{&amp;TABLENAME}</span><!--src-prep-->.stock-no <span class="src-keyword">NE</span><!--src-keyword--> <span class="src-prep">{&amp;TABLENAME}</span><!--src-prep-->.stock-no
              <span class="src-keyword">AND ROWID</span><!--src-keyword-->(b-<span class="src-prep">{&amp;TABLENAME}</span><!--src-prep-->)   <span class="src-keyword">NE ROWID</span><!--src-keyword-->(<span class="src-prep">{&amp;TABLENAME}</span><!--src-prep-->)) <span class="src-keyword">THEN</span><!--src-keyword-->
<span class="src-keyword">FOR EACH</span><!--src-keyword--> itemfg <span class="src-keyword">NO-LOCK</span><!--src-keyword-->
    <span class="src-keyword">WHERE</span><!--src-keyword--> itemfg.company <span class="src-keyword">EQ</span><!--src-keyword--> <span class="src-prep">{&amp;TABLENAME}</span><!--src-prep-->.company
      <span class="src-keyword">AND</span><!--src-keyword--> itemfg.est-no  <span class="src-keyword">EQ</span><!--src-keyword--> <span class="src-prep">{&amp;TABLENAME}</span><!--src-prep-->.est-no
      <span class="src-keyword">AND</span><!--src-keyword--> itemfg.i-no    <span class="src-keyword">NE</span><!--src-keyword--> <span class="src-prep">{&amp;TABLENAME}</span><!--src-prep-->.stock-no
      <span class="src-keyword">AND</span><!--src-keyword--> itemfg.isaset
    <span class="src-keyword">BREAK BY</span><!--src-keyword--> itemfg.rec_key <span class="src-keyword">DESC</span><!--src-keyword-->:
  <span class="src-keyword">IF LAST</span><!--src-keyword-->(itemfg.rec_key)                   <span class="src-keyword">OR</span><!--src-keyword-->
     itemfg.part-no <span class="src-keyword">EQ</span><!--src-keyword--> <span class="src-prep">{&amp;TABLENAME}</span><!--src-prep-->.part-no <span class="src-keyword">THEN DO</span><!--src-keyword-->:
    <span class="src-keyword">IF AVAIL</span><!--src-keyword--> itemfg <span class="src-keyword">THEN</span><!--src-keyword--> <span class="src-prep">{&amp;TABLENAME}</span><!--src-prep-->.stock-no = itemfg.i-no.
    <span class="src-keyword">LEAVE</span><!--src-keyword-->.
  <span class="src-keyword">END</span><!--src-keyword-->.
<span class="src-keyword">END</span><!--src-keyword-->.
 
<span class="src-keyword">IF INDEX</span><!--src-keyword-->(<span class="src-keyword">PROGRAM-NAME</span><!--src-keyword-->(<span class="src-number">5</span><!--src-number-->),<span class="src-char">"v-est3"</span><!--src-char-->) <span class="src-keyword">EQ</span><!--src-keyword--> <span class="src-number">0</span><!--src-number--> <span class="src-keyword">AND</span><!--src-keyword-->
   <span class="src-keyword">INDEX</span><!--src-keyword-->(<span class="src-keyword">PROGRAM-NAME</span><!--src-keyword-->(<span class="src-number">3</span><!--src-number-->),<span class="src-char">"v-est3"</span><!--src-char-->) <span class="src-keyword">EQ</span><!--src-keyword--> <span class="src-number">0</span><!--src-number--> <span class="src-keyword">AND</span><!--src-keyword-->
   <span class="src-keyword">index</span><!--src-keyword-->(<span class="src-keyword">program-name</span><!--src-keyword-->(<span class="src-number">2</span><!--src-number-->),<span class="src-char">"updest3"</span><!--src-char-->) <span class="src-keyword">EQ</span><!--src-keyword--> <span class="src-number">0</span><!--src-number--> <span class="src-keyword">THEN</span><!--src-keyword-->
   <span class="src-keyword">DO</span><!--src-keyword-->:
      <span class="src-keyword">FOR EACH item FIELDS</span><!--src-keyword-->(case-l case-w case-d avg-w)
          <span class="src-keyword">WHERE item</span><!--src-keyword-->.company <span class="src-keyword">EQ</span><!--src-keyword--> <span class="src-prep">{&amp;TABLENAME}</span><!--src-prep-->.company
            <span class="src-keyword">AND item</span><!--src-keyword-->.i-no    <span class="src-keyword">EQ</span><!--src-keyword--> <span class="src-prep">{&amp;TABLENAME}</span><!--src-prep-->.cas-no
            <span class="src-keyword">AND item</span><!--src-keyword-->.i-code  <span class="src-keyword">EQ</span><!--src-keyword--> <span class="src-char">"R"</span><!--src-char-->
          <span class="src-keyword">NO-LOCK</span><!--src-keyword-->:
 
          <span class="src-keyword">ASSIGN</span><!--src-keyword-->
            <span class="src-prep">{&amp;TABLENAME}</span><!--src-prep-->.cas-len = <span class="src-keyword">item</span><!--src-keyword-->.case-l
            <span class="src-prep">{&amp;TABLENAME}</span><!--src-prep-->.cas-wid = <span class="src-keyword">item</span><!--src-keyword-->.case-w
            <span class="src-prep">{&amp;TABLENAME}</span><!--src-prep-->.cas-dep = <span class="src-keyword">item</span><!--src-keyword-->.case-d
            <span class="src-prep">{&amp;TABLENAME}</span><!--src-prep-->.cas-wt  = <span class="src-keyword">item</span><!--src-keyword-->.avg-w.
          <span class="src-keyword">LEAVE</span><!--src-keyword-->.
      <span class="src-keyword">END</span><!--src-keyword-->.
 
      <span class="src-keyword">FOR EACH item FIELDS</span><!--src-keyword-->(case-l case-w case-d) <span class="src-keyword">WHERE</span><!--src-keyword-->
          <span class="src-keyword">item</span><!--src-keyword-->.company <span class="src-keyword">EQ</span><!--src-keyword--> <span class="src-prep">{&amp;TABLENAME}</span><!--src-prep-->.company <span class="src-keyword">AND</span><!--src-keyword-->
          <span class="src-keyword">item</span><!--src-keyword-->.i-no    <span class="src-keyword">EQ</span><!--src-keyword--> <span class="src-prep">{&amp;TABLENAME}</span><!--src-prep-->.tr-no <span class="src-keyword">AND</span><!--src-keyword-->
          <span class="src-keyword">item</span><!--src-keyword-->.i-code  <span class="src-keyword">EQ</span><!--src-keyword--> <span class="src-char">"R"</span><!--src-char-->
          <span class="src-keyword">NO-LOCK</span><!--src-keyword-->:
 
          <span class="src-keyword">ASSIGN</span><!--src-keyword-->
             <span class="src-prep">{&amp;TABLENAME}</span><!--src-prep-->.tr-len = <span class="src-keyword">item</span><!--src-keyword-->.case-l
             <span class="src-prep">{&amp;TABLENAME}</span><!--src-prep-->.tr-wid = <span class="src-keyword">item</span><!--src-keyword-->.case-w
             <span class="src-prep">{&amp;TABLENAME}</span><!--src-prep-->.tr-dep = <span class="src-keyword">item</span><!--src-keyword-->.case-d.
          <span class="src-keyword">LEAVE</span><!--src-keyword-->.
      <span class="src-keyword">END</span><!--src-keyword-->.
   <span class="src-keyword">END</span><!--src-keyword-->.
 
<span class="src-keyword">IF</span><!--src-keyword--> <span class="src-prep">{&amp;TABLENAME}</span><!--src-prep-->.style   <span class="src-keyword">NE</span><!--src-keyword--> old-<span class="src-prep">{&amp;TABLENAME}</span><!--src-prep-->.style   <span class="src-keyword">OR</span><!--src-keyword-->
   <span class="src-prep">{&amp;TABLENAME}</span><!--src-prep-->.len     <span class="src-keyword">NE</span><!--src-keyword--> old-<span class="src-prep">{&amp;TABLENAME}</span><!--src-prep-->.len     <span class="src-keyword">OR</span><!--src-keyword--> 
   <span class="src-prep">{&amp;TABLENAME}</span><!--src-prep-->.wid     <span class="src-keyword">NE</span><!--src-keyword--> old-<span class="src-prep">{&amp;TABLENAME}</span><!--src-prep-->.wid     <span class="src-keyword">OR</span><!--src-keyword-->
   <span class="src-prep">{&amp;TABLENAME}</span><!--src-prep-->.dep     <span class="src-keyword">NE</span><!--src-keyword--> old-<span class="src-prep">{&amp;TABLENAME}</span><!--src-prep-->.dep     <span class="src-keyword">OR</span><!--src-keyword-->
   <span class="src-prep">{&amp;TABLENAME}</span><!--src-prep-->.t-len   <span class="src-keyword">NE</span><!--src-keyword--> old-<span class="src-prep">{&amp;TABLENAME}</span><!--src-prep-->.t-len   <span class="src-keyword">OR</span><!--src-keyword--> 
   <span class="src-prep">{&amp;TABLENAME}</span><!--src-prep-->.t-wid   <span class="src-keyword">NE</span><!--src-keyword--> old-<span class="src-prep">{&amp;TABLENAME}</span><!--src-prep-->.t-wid   <span class="src-keyword">OR</span><!--src-keyword-->
   <span class="src-prep">{&amp;TABLENAME}</span><!--src-prep-->.t-dep   <span class="src-keyword">NE</span><!--src-keyword--> old-<span class="src-prep">{&amp;TABLENAME}</span><!--src-prep-->.t-dep   <span class="src-keyword">OR</span><!--src-keyword-->
   <span class="src-prep">{&amp;TABLENAME}</span><!--src-prep-->.k-len   <span class="src-keyword">NE</span><!--src-keyword--> old-<span class="src-prep">{&amp;TABLENAME}</span><!--src-prep-->.k-len   <span class="src-keyword">OR</span><!--src-keyword-->
   <span class="src-prep">{&amp;TABLENAME}</span><!--src-prep-->.k-wid   <span class="src-keyword">NE</span><!--src-keyword--> old-<span class="src-prep">{&amp;TABLENAME}</span><!--src-prep-->.k-wid   <span class="src-keyword">OR</span><!--src-keyword-->
   <span class="src-prep">{&amp;TABLENAME}</span><!--src-prep-->.tuck    <span class="src-keyword">NE</span><!--src-keyword--> old-<span class="src-prep">{&amp;TABLENAME}</span><!--src-prep-->.tuck    <span class="src-keyword">OR</span><!--src-keyword-->
   <span class="src-prep">{&amp;TABLENAME}</span><!--src-prep-->.gluelap <span class="src-keyword">NE</span><!--src-keyword--> old-<span class="src-prep">{&amp;TABLENAME}</span><!--src-prep-->.gluelap <span class="src-keyword">OR</span><!--src-keyword-->
   <span class="src-prep">{&amp;TABLENAME}</span><!--src-prep-->.fpanel  <span class="src-keyword">NE</span><!--src-keyword--> old-<span class="src-prep">{&amp;TABLENAME}</span><!--src-prep-->.fpanel  <span class="src-keyword">OR</span><!--src-keyword-->
   <span class="src-prep">{&amp;TABLENAME}</span><!--src-prep-->.dust    <span class="src-keyword">NE</span><!--src-keyword--> old-<span class="src-prep">{&amp;TABLENAME}</span><!--src-prep-->.dust    <span class="src-keyword">OR</span><!--src-keyword-->
   <span class="src-prep">{&amp;TABLENAME}</span><!--src-prep-->.lock    <span class="src-keyword">NE</span><!--src-keyword--> old-<span class="src-prep">{&amp;TABLENAME}</span><!--src-prep-->.lock    <span class="src-keyword">OR</span><!--src-keyword-->
   <span class="src-prep">{&amp;TABLENAME}</span><!--src-prep-->.num-up  <span class="src-keyword">NE</span><!--src-keyword--> old-<span class="src-prep">{&amp;TABLENAME}</span><!--src-prep-->.num-up  <span class="src-keyword">THEN DO</span><!--src-keyword-->:
  <span class="src-keyword">RUN</span><!--src-keyword--> est/upddiein.p (<span class="src-keyword">ROWID</span><!--src-keyword-->(<span class="src-prep">{&amp;TABLENAME}</span><!--src-prep-->)).
  <span class="src-keyword">FIND CURRENT</span><!--src-keyword--> <span class="src-prep">{&amp;TABLENAME}</span><!--src-prep--> <span class="src-keyword">NO-ERROR</span><!--src-keyword-->.
<span class="src-keyword">END</span><!--src-keyword-->.
 
<span class="src-keyword">IF</span><!--src-keyword--> <span class="src-prep">{&amp;TABLENAME}</span><!--src-prep-->.est-type <span class="src-keyword">NE</span><!--src-keyword--> <span class="src-number">4</span><!--src-number--> <span class="src-keyword">AND</span><!--src-keyword-->
   <span class="src-prep">{&amp;TABLENAME}</span><!--src-prep-->.est-type <span class="src-keyword">NE</span><!--src-keyword--> <span class="src-number">8</span><!--src-number--> <span class="src-keyword">THEN DO</span><!--src-keyword-->:
  <span class="src-keyword">IF</span><!--src-keyword--> <span class="src-prep">{&amp;TABLENAME}</span><!--src-prep-->.i-col + <span class="src-prep">{&amp;TABLENAME}</span><!--src-prep-->.i-coat <span class="src-keyword">EQ</span><!--src-keyword--> <span class="src-number">0</span><!--src-number--> <span class="src-keyword">THEN</span><!--src-keyword-->
  <span class="src-keyword">FOR EACH</span><!--src-keyword--> est-prep
      <span class="src-keyword">WHERE</span><!--src-keyword--> est-prep.company  <span class="src-keyword">EQ</span><!--src-keyword--> <span class="src-prep">{&amp;TABLENAME}</span><!--src-prep-->.company
        <span class="src-keyword">AND</span><!--src-keyword--> est-prep.est-no   <span class="src-keyword">EQ</span><!--src-keyword--> <span class="src-prep">{&amp;TABLENAME}</span><!--src-prep-->.est-no
        <span class="src-keyword">AND</span><!--src-keyword--> est-prep.s-num    <span class="src-keyword">EQ</span><!--src-keyword--> <span class="src-prep">{&amp;TABLENAME}</span><!--src-prep-->.form-no
        <span class="src-keyword">AND</span><!--src-keyword--> est-prep.mat-type <span class="src-keyword">EQ</span><!--src-keyword--> <span class="src-char">"P"</span><!--src-char-->,
 
      <span class="src-keyword">FIRST</span><!--src-keyword--> prep
      <span class="src-keyword">WHERE</span><!--src-keyword--> prep.company <span class="src-keyword">EQ</span><!--src-keyword--> est-prep.company
        <span class="src-keyword">AND</span><!--src-keyword--> prep.<span class="src-keyword">code    EQ</span><!--src-keyword--> est-prep.<span class="src-keyword">code</span><!--src-keyword-->
        <span class="src-keyword">AND</span><!--src-keyword--> prep.dfault  <span class="src-keyword">EQ YES</span><!--src-keyword-->
      <span class="src-keyword">NO-LOCK</span><!--src-keyword-->:
 
    <span class="src-keyword">DELETE</span><!--src-keyword--> est-prep.  
  <span class="src-keyword">END</span><!--src-keyword-->.
 
  <span class="src-keyword">IF</span><!--src-keyword--> <span class="src-prep">{&amp;TABLENAME}</span><!--src-prep-->.i-col    <span class="src-keyword">NE</span><!--src-keyword--> old-<span class="src-prep">{&amp;TABLENAME}</span><!--src-prep-->.i-col    <span class="src-keyword">OR</span><!--src-keyword-->
     <span class="src-prep">{&amp;TABLENAME}</span><!--src-prep-->.i-coat   <span class="src-keyword">NE</span><!--src-keyword--> old-<span class="src-prep">{&amp;TABLENAME}</span><!--src-prep-->.i-coat   <span class="src-keyword">OR</span><!--src-keyword-->
     <span class="src-prep">{&amp;TABLENAME}</span><!--src-prep-->.i-pass   <span class="src-keyword">NE</span><!--src-keyword--> old-<span class="src-prep">{&amp;TABLENAME}</span><!--src-prep-->.i-pass   <span class="src-keyword">OR</span><!--src-keyword-->
     <span class="src-prep">{&amp;TABLENAME}</span><!--src-prep-->.i-coat-p <span class="src-keyword">NE</span><!--src-keyword--> old-<span class="src-prep">{&amp;TABLENAME}</span><!--src-prep-->.i-coat-p <span class="src-keyword">THEN</span><!--src-keyword-->
  <span class="src-keyword">FOR EACH</span><!--src-keyword--> est-prep
      <span class="src-keyword">WHERE</span><!--src-keyword--> est-prep.company <span class="src-keyword">EQ</span><!--src-keyword--> <span class="src-prep">{&amp;TABLENAME}</span><!--src-prep-->.company
        <span class="src-keyword">AND</span><!--src-keyword--> est-prep.est-no  <span class="src-keyword">EQ</span><!--src-keyword--> <span class="src-prep">{&amp;TABLENAME}</span><!--src-prep-->.est-no
        <span class="src-keyword">AND</span><!--src-keyword--> est-prep.s-num   <span class="src-keyword">EQ</span><!--src-keyword--> <span class="src-prep">{&amp;TABLENAME}</span><!--src-prep-->.form-no
	    <span class="src-keyword">AND</span><!--src-keyword--> (est-prep.mat-type <span class="src-keyword">EQ</span><!--src-keyword--> <span class="src-char">"F"</span><!--src-char--> <span class="src-keyword">OR</span><!--src-keyword-->
             est-prep.mat-type <span class="src-keyword">EQ</span><!--src-keyword--> <span class="src-char">"P"</span><!--src-char-->),
 
      <span class="src-keyword">FIRST</span><!--src-keyword--> est
      <span class="src-keyword">WHERE</span><!--src-keyword--> est.company <span class="src-keyword">EQ</span><!--src-keyword--> est-prep.company
        <span class="src-keyword">AND</span><!--src-keyword--> est.est-no  <span class="src-keyword">EQ</span><!--src-keyword--> est-prep.est-no
      <span class="src-keyword">NO-LOCK</span><!--src-keyword-->:
      <span class="src-keyword">RUN</span><!--src-keyword--> est/GetPrepQty.p(<span class="src-keyword">INPUT ROWID</span><!--src-keyword-->(est),
                           <span class="src-keyword">INPUT</span><!--src-keyword--> est-prep.mat-type,
                           <span class="src-keyword">INPUT</span><!--src-keyword--> est-prep.s-num,
                           <span class="src-keyword">OUTPUT</span><!--src-keyword--> est-prep.qty).
<span class="src-comment">/*     RUN sys/inc/flm-prep.p (RECID(est), est-prep.s-num, OUTPUT est-prep.qty). */</span><!--src-comment-->
  <span class="src-keyword">END</span><!--src-keyword-->.
<span class="src-keyword">END</span><!--src-keyword-->.
 
<span class="src-keyword">IF INT</span><!--src-keyword-->(<span class="src-prep">{&amp;TABLENAME}</span><!--src-prep-->.master-est-no) <span class="src-keyword">NE</span><!--src-keyword--> <span class="src-number">0</span><!--src-number--> <span class="src-keyword">AND</span><!--src-keyword-->
   <span class="src-prep">{&amp;TABLENAME}</span><!--src-prep-->.stock-no           <span class="src-keyword">NE</span><!--src-keyword--> <span class="src-char">""</span><!--src-char--> <span class="src-keyword">THEN</span><!--src-keyword-->
<span class="src-keyword">FOR EACH</span><!--src-keyword--> b-<span class="src-prep">{&amp;TABLENAME}</span><!--src-prep-->
    <span class="src-keyword">WHERE</span><!--src-keyword--> b-<span class="src-prep">{&amp;TABLENAME}</span><!--src-prep-->.company  <span class="src-keyword">EQ</span><!--src-keyword--> <span class="src-prep">{&amp;TABLENAME}</span><!--src-prep-->.company
      <span class="src-keyword">AND</span><!--src-keyword--> b-<span class="src-prep">{&amp;TABLENAME}</span><!--src-prep-->.est-no   <span class="src-keyword">EQ</span><!--src-keyword--> <span class="src-prep">{&amp;TABLENAME}</span><!--src-prep-->.master-est-no
      <span class="src-keyword">AND</span><!--src-keyword--> b-<span class="src-prep">{&amp;TABLENAME}</span><!--src-prep-->.part-no  <span class="src-keyword">EQ</span><!--src-keyword--> <span class="src-prep">{&amp;TABLENAME}</span><!--src-prep-->.part-no
      <span class="src-keyword">AND</span><!--src-keyword--> b-<span class="src-prep">{&amp;TABLENAME}</span><!--src-prep-->.stock-no <span class="src-keyword">EQ</span><!--src-keyword--> <span class="src-char">""</span><!--src-char-->:
  b-<span class="src-prep">{&amp;TABLENAME}</span><!--src-prep-->.stock-no = <span class="src-prep">{&amp;TABLENAME}</span><!--src-prep-->.stock-no.
<span class="src-keyword">END</span><!--src-keyword-->.
 
<span class="src-keyword">FIND FIRST</span><!--src-keyword--> est
    <span class="src-keyword">WHERE</span><!--src-keyword--> est.company <span class="src-keyword">EQ</span><!--src-keyword--> <span class="src-prep">{&amp;TABLENAME}</span><!--src-prep-->.company
      <span class="src-keyword">AND</span><!--src-keyword--> est.est-no  <span class="src-keyword">EQ</span><!--src-keyword--> <span class="src-prep">{&amp;TABLENAME}</span><!--src-prep-->.est-no
    <span class="src-keyword">NO-ERROR</span><!--src-keyword-->.
 
<span class="src-keyword">IF AVAIL</span><!--src-keyword--> est <span class="src-keyword">THEN DO</span><!--src-keyword-->:
  <span class="src-keyword">ASSIGN</span><!--src-keyword-->
   est.updated-date = <span class="src-keyword">TODAY</span><!--src-keyword-->
   est.updated-id   = <span class="src-keyword">USERID</span><!--src-keyword-->(<span class="src-char">"nosweat"</span><!--src-char-->)
   est.mod-date     = est.updated-date.
 
  <span class="src-comment">/*IF (est.est-type EQ 4 OR est.est-type EQ 8)           AND
     CAN-FIND(FIRST ef OF est
              WHERE ef.form-no NE {&amp;TABLENAME}.form-no) THEN DO:
    RUN ce/com/istandem.p (ROWID(est), OUTPUT ll-tandem).
    IF ll-tandem THEN {&amp;TABLENAME}.yld-qty = {&amp;TABLENAME}.bl-qty.
  END.*/</span><!--src-comment-->
<span class="src-keyword">END</span><!--src-keyword-->.
 
<span class="src-keyword">FOR EACH</span><!--src-keyword--> ef
    <span class="src-keyword">WHERE</span><!--src-keyword--> ef.company <span class="src-keyword">EQ</span><!--src-keyword--> <span class="src-prep">{&amp;TABLENAME}</span><!--src-prep-->.company
      <span class="src-keyword">AND</span><!--src-keyword--> ef.est-no  <span class="src-keyword">EQ</span><!--src-keyword--> <span class="src-prep">{&amp;TABLENAME}</span><!--src-prep-->.est-no
      <span class="src-keyword">AND</span><!--src-keyword--> ef.form-no <span class="src-keyword">EQ</span><!--src-keyword--> <span class="src-prep">{&amp;TABLENAME}</span><!--src-prep-->.form-no:
 
  <span class="src-keyword">IF</span><!--src-keyword--> <span class="src-prep">{&amp;TABLENAME}</span><!--src-prep-->.blank-no <span class="src-keyword">NE</span><!--src-keyword--> <span class="src-number">0</span><!--src-number-->                         <span class="src-keyword">AND</span><!--src-keyword-->
     old-<span class="src-prep">{&amp;TABLENAME}</span><!--src-prep-->.blank-no <span class="src-keyword">NE</span><!--src-keyword--> <span class="src-number">0</span><!--src-number-->                     <span class="src-keyword">AND</span><!--src-keyword-->
     <span class="src-prep">{&amp;TABLENAME}</span><!--src-prep-->.blank-no <span class="src-keyword">NE</span><!--src-keyword--> old-<span class="src-prep">{&amp;TABLENAME}</span><!--src-prep-->.blank-no <span class="src-keyword">THEN</span><!--src-keyword-->
  <span class="src-keyword">DO</span><!--src-keyword--> li = <span class="src-number">1</span><!--src-number--> <span class="src-keyword">TO EXTENT</span><!--src-keyword-->(ef.mis-cost):
    <span class="src-keyword">IF</span><!--src-keyword--> ef.mis-cost[li] <span class="src-keyword">NE</span><!--src-keyword--> <span class="src-char">""</span><!--src-char-->                        <span class="src-keyword">AND</span><!--src-keyword-->
       ef.mis-bnum[li] <span class="src-keyword">EQ</span><!--src-keyword--> old-<span class="src-prep">{&amp;TABLENAME}</span><!--src-prep-->.blank-no <span class="src-keyword">THEN</span><!--src-keyword-->
      ef.mis-bnum[li] = <span class="src-prep">{&amp;TABLENAME}</span><!--src-prep-->.blank-no.
  <span class="src-keyword">END</span><!--src-keyword-->.
 
  <span class="src-keyword">IF</span><!--src-keyword--> <span class="src-prep">{&amp;TABLENAME}</span><!--src-prep-->.est-type <span class="src-keyword">GE</span><!--src-keyword--> <span class="src-number">5</span><!--src-number--> <span class="src-keyword">THEN DO</span><!--src-keyword-->:
    <span class="src-keyword">IF</span><!--src-keyword--> <span class="src-prep">{&amp;TABLENAME}</span><!--src-prep-->.flute <span class="src-keyword">NE</span><!--src-keyword--> <span class="src-char">""</span><!--src-char--> <span class="src-keyword">THEN</span><!--src-keyword--> ef.flute = <span class="src-prep">{&amp;TABLENAME}</span><!--src-prep-->.flute.
    <span class="src-keyword">IF</span><!--src-keyword--> <span class="src-prep">{&amp;TABLENAME}</span><!--src-prep-->.test  <span class="src-keyword">NE</span><!--src-keyword--> <span class="src-char">""</span><!--src-char--> <span class="src-keyword">THEN</span><!--src-keyword--> ef.test  = <span class="src-prep">{&amp;TABLENAME}</span><!--src-prep-->.test.
  <span class="src-keyword">END</span><!--src-keyword-->.
 
  <span class="src-keyword">IF</span><!--src-keyword--> <span class="src-prep">{&amp;TABLENAME}</span><!--src-prep-->.blank-no <span class="src-keyword">EQ</span><!--src-keyword--> <span class="src-number">1</span><!--src-number--> <span class="src-keyword">THEN DO</span><!--src-keyword-->:
    <span class="src-keyword">IF</span><!--src-keyword--> ef.f-col <span class="src-keyword">EQ</span><!--src-keyword--> <span class="src-number">0</span><!--src-number--> <span class="src-keyword">THEN</span><!--src-keyword-->
      <span class="src-keyword">ASSIGN</span><!--src-keyword-->
       ef.f-col  = <span class="src-prep">{&amp;TABLENAME}</span><!--src-prep-->.i-col
       ef.f-pass = <span class="src-prep">{&amp;TABLENAME}</span><!--src-prep-->.i-pass.
    <span class="src-keyword">IF</span><!--src-keyword--> ef.f-coat <span class="src-keyword">EQ</span><!--src-keyword--> <span class="src-number">0</span><!--src-number--> <span class="src-keyword">THEN</span><!--src-keyword-->
      <span class="src-keyword">ASSIGN</span><!--src-keyword-->
       ef.f-coat   = <span class="src-prep">{&amp;TABLENAME}</span><!--src-prep-->.i-coat
       ef.f-coat-p = <span class="src-prep">{&amp;TABLENAME}</span><!--src-prep-->.i-coat-p.
  <span class="src-keyword">END</span><!--src-keyword-->.
 
  <span class="src-keyword">RUN</span><!--src-keyword--> est/forminks.p (<span class="src-keyword">BUFFER</span><!--src-keyword--> ef).
 
  <span class="src-keyword">IF</span><!--src-keyword--> <span class="src-prep">{&amp;TABLENAME}</span><!--src-prep-->.die-in <span class="src-keyword">NE</span><!--src-keyword--> old-<span class="src-prep">{&amp;TABLENAME}</span><!--src-prep-->.die-in <span class="src-keyword">THEN DO</span><!--src-keyword-->:
    lv-die-in = ef.die-in.
 
    <span class="src-keyword">RUN</span><!--src-keyword--> est/updefdie.p (<span class="src-keyword">ROWID</span><!--src-keyword-->(ef)).
 
    <span class="src-keyword">FIND</span><!--src-keyword--> b-ef <span class="src-keyword">WHERE ROWID</span><!--src-keyword-->(b-ef) <span class="src-keyword">EQ ROWID</span><!--src-keyword-->(ef) <span class="src-keyword">NO-LOCK NO-ERROR</span><!--src-keyword-->.
 
    <span class="src-keyword">IF AVAIL</span><!--src-keyword--> b-ef <span class="src-keyword">AND ROUND</span><!--src-keyword-->(b-ef.die-in,<span class="src-number">0</span><!--src-number-->) <span class="src-keyword">NE ROUND</span><!--src-keyword-->(lv-die-in,<span class="src-number">0</span><!--src-number-->) <span class="src-keyword">THEN</span><!--src-keyword-->
    <span class="src-keyword">FOR EACH</span><!--src-keyword--> est-prep
        <span class="src-keyword">WHERE</span><!--src-keyword--> est-prep.company  <span class="src-keyword">EQ</span><!--src-keyword--> b-ef.company
          <span class="src-keyword">AND</span><!--src-keyword--> est-prep.est-no   <span class="src-keyword">EQ</span><!--src-keyword--> b-ef.est-no
          <span class="src-keyword">AND</span><!--src-keyword--> est-prep.s-num    <span class="src-keyword">EQ</span><!--src-keyword--> b-ef.form-no
          <span class="src-keyword">AND</span><!--src-keyword--> est-prep.mat-type <span class="src-keyword">EQ</span><!--src-keyword--> <span class="src-char">"R"</span><!--src-char-->
        <span class="src-keyword">EXCLUSIVE</span><!--src-keyword-->:
 
      est-prep.qty = b-ef.die-in.
 
      <span class="src-keyword">IF</span><!--src-keyword--> est-prep.qty <span class="src-keyword">EQ</span><!--src-keyword--> <span class="src-number">0</span><!--src-number--> <span class="src-keyword">THEN DELETE</span><!--src-keyword--> est-prep.
    <span class="src-keyword">END</span><!--src-keyword-->.
  <span class="src-keyword">END</span><!--src-keyword-->.
 
  <span class="src-keyword">IF</span><!--src-keyword--> <span class="src-prep">{&amp;TABLENAME}</span><!--src-prep-->.pur-man <span class="src-keyword">NE</span><!--src-keyword--> old-<span class="src-prep">{&amp;TABLENAME}</span><!--src-prep-->.pur-man <span class="src-keyword">THEN</span><!--src-keyword--> 
   <span class="src-keyword">assign</span><!--src-keyword--> 
    ef.nc = <span class="src-keyword">NOT</span><!--src-keyword--> <span class="src-prep">{&amp;TABLENAME}</span><!--src-prep-->.pur-man
    <span class="src-prep">{&amp;TABLENAME}</span><!--src-prep-->.trNoCharge = <span class="src-prep">{&amp;TABLENAME}</span><!--src-prep-->.pur-man
    <span class="src-prep">{&amp;TABLENAME}</span><!--src-prep-->.casNoCharge = <span class="src-prep">{&amp;TABLENAME}</span><!--src-prep-->.pur-man
    <span class="src-prep">{&amp;TABLENAME}</span><!--src-prep-->.inkNoCharge = <span class="src-prep">{&amp;TABLENAME}</span><!--src-prep-->.pur-man
    .
  <span class="src-keyword">LEAVE</span><!--src-keyword-->.
<span class="src-keyword">END</span><!--src-keyword-->.
 
<span class="src-keyword">IF TRIM</span><!--src-keyword-->(<span class="src-prep">{&amp;TABLENAME}</span><!--src-prep-->.est-no) <span class="src-keyword">NE</span><!--src-keyword--> <span class="src-char">""</span><!--src-char-->                       <span class="src-keyword">AND</span><!--src-keyword-->
   <span class="src-prep">{&amp;TABLENAME}</span><!--src-prep-->.part-no      <span class="src-keyword">NE</span><!--src-keyword--> old-<span class="src-prep">{&amp;TABLENAME}</span><!--src-prep-->.part-no <span class="src-keyword">AND</span><!--src-keyword-->
   old-<span class="src-prep">{&amp;TABLENAME}</span><!--src-prep-->.part-no  <span class="src-keyword">NE</span><!--src-keyword--> <span class="src-char">""</span><!--src-char-->                       <span class="src-keyword">THEN</span><!--src-keyword-->
<span class="src-keyword">FOR EACH</span><!--src-keyword--> est
    <span class="src-keyword">WHERE</span><!--src-keyword--> est.company <span class="src-keyword">EQ</span><!--src-keyword--> <span class="src-prep">{&amp;TABLENAME}</span><!--src-prep-->.company
      <span class="src-keyword">AND</span><!--src-keyword--> est.est-no  <span class="src-keyword">EQ</span><!--src-keyword--> <span class="src-prep">{&amp;TABLENAME}</span><!--src-prep-->.est-no
    <span class="src-keyword">NO-LOCK</span><!--src-keyword-->,
    <span class="src-keyword">EACH</span><!--src-keyword--> quotehd
    <span class="src-keyword">WHERE</span><!--src-keyword--> quotehd.company <span class="src-keyword">EQ</span><!--src-keyword--> est.company
      <span class="src-keyword">AND</span><!--src-keyword--> quotehd.loc     <span class="src-keyword">EQ</span><!--src-keyword--> est.loc
      <span class="src-keyword">AND</span><!--src-keyword--> quotehd.est-no  <span class="src-keyword">EQ</span><!--src-keyword--> est.est-no
    <span class="src-keyword">NO-LOCK</span><!--src-keyword-->,
    <span class="src-keyword">EACH</span><!--src-keyword--> quoteitm
    <span class="src-keyword">WHERE</span><!--src-keyword--> quoteitm.company <span class="src-keyword">EQ</span><!--src-keyword--> quotehd.company
      <span class="src-keyword">AND</span><!--src-keyword--> quoteitm.loc     <span class="src-keyword">EQ</span><!--src-keyword--> quotehd.loc
      <span class="src-keyword">AND</span><!--src-keyword--> quoteitm.q-no    <span class="src-keyword">EQ</span><!--src-keyword--> quotehd.q-no
      <span class="src-keyword">AND</span><!--src-keyword--> quoteitm.part-no <span class="src-keyword">EQ</span><!--src-keyword--> old-<span class="src-prep">{&amp;TABLENAME}</span><!--src-prep-->.part-no:
  quoteitm.part-no = <span class="src-prep">{&amp;TABLENAME}</span><!--src-prep-->.part-no.
<span class="src-keyword">END</span><!--src-keyword-->.
 
<span class="src-keyword">IF TRIM</span><!--src-keyword-->(old-<span class="src-prep">{&amp;TABLENAME}</span><!--src-prep-->.est-no) <span class="src-keyword">NE</span><!--src-keyword--> <span class="src-char">""</span><!--src-char--> <span class="src-keyword">AND</span><!--src-keyword-->
   <span class="src-prep">{&amp;TABLENAME}</span><!--src-prep-->.eqty <span class="src-keyword">NE</span><!--src-keyword--> <span class="src-number">0</span><!--src-number-->              <span class="src-keyword">THEN DO</span><!--src-keyword-->:
  <span class="src-keyword">IF</span><!--src-keyword--> <span class="src-prep">{&amp;TABLENAME}</span><!--src-prep-->.est-type <span class="src-keyword">EQ</span><!--src-keyword--> <span class="src-number">1</span><!--src-number--> <span class="src-keyword">OR</span><!--src-keyword-->
     <span class="src-prep">{&amp;TABLENAME}</span><!--src-prep-->.est-type <span class="src-keyword">EQ</span><!--src-keyword--> <span class="src-number">5</span><!--src-number--> <span class="src-keyword">OR</span><!--src-keyword-->
     <span class="src-prep">{&amp;TABLENAME}</span><!--src-prep-->.est-type <span class="src-keyword">EQ</span><!--src-keyword--> <span class="src-number">6</span><!--src-number--> <span class="src-keyword">THEN</span><!--src-keyword-->
    <span class="src-keyword">IF NOT CAN-FIND</span><!--src-keyword-->(<span class="src-keyword">FIRST</span><!--src-keyword--> b-est-op
                    <span class="src-keyword">WHERE</span><!--src-keyword--> b-est-op.company <span class="src-keyword">EQ</span><!--src-keyword--> <span class="src-prep">{&amp;TABLENAME}</span><!--src-prep-->.company
                      <span class="src-keyword">AND</span><!--src-keyword--> b-est-op.est-no  <span class="src-keyword">EQ</span><!--src-keyword--> <span class="src-prep">{&amp;TABLENAME}</span><!--src-prep-->.est-no
                      <span class="src-keyword">AND</span><!--src-keyword--> b-est-op.qty     <span class="src-keyword">EQ</span><!--src-keyword--> <span class="src-prep">{&amp;TABLENAME}</span><!--src-prep-->.eqty)
    <span class="src-keyword">THEN</span><!--src-keyword-->
    <span class="src-keyword">FOR EACH</span><!--src-keyword--> est-op
        <span class="src-keyword">WHERE</span><!--src-keyword--> est-op.company <span class="src-keyword">EQ</span><!--src-keyword--> <span class="src-prep">{&amp;TABLENAME}</span><!--src-prep-->.company
          <span class="src-keyword">AND</span><!--src-keyword--> est-op.est-no  <span class="src-keyword">EQ</span><!--src-keyword--> <span class="src-prep">{&amp;TABLENAME}</span><!--src-prep-->.est-no
          <span class="src-keyword">AND</span><!--src-keyword--> est-op.qty     <span class="src-keyword">EQ</span><!--src-keyword--> old-<span class="src-prep">{&amp;TABLENAME}</span><!--src-prep-->.eqty:
      est-op.qty = <span class="src-prep">{&amp;TABLENAME}</span><!--src-prep-->.eqty.
    <span class="src-keyword">END</span><!--src-keyword-->.
 
    <span class="src-keyword">ELSE</span><!--src-keyword-->.
 
  <span class="src-keyword">ELSE DO</span><!--src-keyword-->:
    <span class="src-keyword">FOR EACH</span><!--src-keyword--> est-qty
        <span class="src-keyword">WHERE</span><!--src-keyword--> est-qty.company <span class="src-keyword">EQ</span><!--src-keyword--> <span class="src-prep">{&amp;TABLENAME}</span><!--src-prep-->.company
          <span class="src-keyword">AND</span><!--src-keyword--> est-qty.est-no  <span class="src-keyword">EQ</span><!--src-keyword--> <span class="src-prep">{&amp;TABLENAME}</span><!--src-prep-->.est-no
        <span class="src-keyword">BY</span><!--src-keyword--> est-qty.eqty:
      est-qty.eqty = <span class="src-prep">{&amp;TABLENAME}</span><!--src-prep-->.eqty.
      <span class="src-keyword">LEAVE</span><!--src-keyword-->.
    <span class="src-keyword">END</span><!--src-keyword-->.
    <span class="src-keyword">FOR EACH</span><!--src-keyword--> est-qty
        <span class="src-keyword">WHERE</span><!--src-keyword--> est-qty.company <span class="src-keyword">EQ</span><!--src-keyword--> <span class="src-prep">{&amp;TABLENAME}</span><!--src-prep-->.company
          <span class="src-keyword">AND</span><!--src-keyword--> est-qty.est-no  <span class="src-keyword">EQ</span><!--src-keyword--> <span class="src-prep">{&amp;TABLENAME}</span><!--src-prep-->.est-no
        <span class="src-keyword">BREAK BY</span><!--src-keyword--> est-qty.eqty:
      <span class="src-keyword">IF NOT FIRST</span><!--src-keyword-->(est-qty.eqty) <span class="src-keyword">THEN DELETE</span><!--src-keyword--> est-qty.
    <span class="src-keyword">END</span><!--src-keyword-->.
  <span class="src-keyword">END</span><!--src-keyword-->.
<span class="src-keyword">END</span><!--src-keyword-->.
 
<span class="src-keyword">IF</span><!--src-keyword--> <span class="src-prep">{&amp;TABLENAME}</span><!--src-prep-->.est-type      <span class="src-keyword">LE</span><!--src-keyword--> <span class="src-number">4</span><!--src-number-->  <span class="src-keyword">AND</span><!--src-keyword-->
   old-<span class="src-prep">{&amp;TABLENAME}</span><!--src-prep-->.est-no    <span class="src-keyword">EQ</span><!--src-keyword--> <span class="src-char">""</span><!--src-char--> <span class="src-keyword">AND</span><!--src-keyword-->
   <span class="src-prep">{&amp;TABLENAME}</span><!--src-prep-->.est-no        <span class="src-keyword">NE</span><!--src-keyword--> <span class="src-char">""</span><!--src-char--> <span class="src-keyword">AND</span><!--src-keyword-->
   <span class="src-prep">{&amp;TABLENAME}</span><!--src-prep-->.master-est-no <span class="src-keyword">EQ</span><!--src-keyword--> <span class="src-char">""</span><!--src-char--> <span class="src-keyword">THEN</span><!--src-keyword-->
  <span class="src-prep">{&amp;TABLENAME}</span><!--src-prep-->.master-est-no = <span class="src-prep">{&amp;TABLENAME}</span><!--src-prep-->.est-no.
 
<span class="src-keyword">IF</span><!--src-keyword--> <span class="src-prep">{&amp;TABLENAME}</span><!--src-prep-->.company <span class="src-keyword">NE</span><!--src-keyword--> <span class="src-char">""</span><!--src-char-->                           <span class="src-keyword">AND</span><!--src-keyword-->
   <span class="src-prep">{&amp;TABLENAME}</span><!--src-prep-->.cust-no <span class="src-keyword">NE</span><!--src-keyword--> <span class="src-char">"TEMP"</span><!--src-char-->                       <span class="src-keyword">AND</span><!--src-keyword-->
   (<span class="src-prep">{&amp;TABLENAME}</span><!--src-prep-->.cust-no <span class="src-keyword">NE</span><!--src-keyword--> old-<span class="src-prep">{&amp;TABLENAME}</span><!--src-prep-->.cust-no <span class="src-keyword">OR</span><!--src-keyword-->
    <span class="src-prep">{&amp;TABLENAME}</span><!--src-prep-->.ship-id <span class="src-keyword">NE</span><!--src-keyword--> old-<span class="src-prep">{&amp;TABLENAME}</span><!--src-prep-->.ship-id)   <span class="src-keyword">THEN DO</span><!--src-keyword-->:
 
  <span class="src-keyword">FIND FIRST</span><!--src-keyword--> shipto <span class="src-keyword">NO-LOCK</span><!--src-keyword-->
      <span class="src-keyword">WHERE</span><!--src-keyword--> shipto.company <span class="src-keyword">EQ</span><!--src-keyword--> <span class="src-prep">{&amp;TABLENAME}</span><!--src-prep-->.company
        <span class="src-keyword">AND</span><!--src-keyword--> shipto.cust-no <span class="src-keyword">EQ</span><!--src-keyword--> <span class="src-prep">{&amp;TABLENAME}</span><!--src-prep-->.cust-no
        <span class="src-keyword">AND</span><!--src-keyword--> shipto.ship-id <span class="src-keyword">EQ</span><!--src-keyword--> <span class="src-prep">{&amp;TABLENAME}</span><!--src-prep-->.ship-id
      <span class="src-keyword">NO-ERROR</span><!--src-keyword-->.
 
  <span class="src-keyword">IF AVAIL</span><!--src-keyword--> shipto <span class="src-keyword">THEN</span><!--src-keyword-->
    <span class="src-keyword">ASSIGN</span><!--src-keyword-->
     <span class="src-prep">{&amp;TABLENAME}</span><!--src-prep-->.ship-no      = shipto.ship-no
     <span class="src-prep">{&amp;TABLENAME}</span><!--src-prep-->.ship-name    = shipto.ship-name
     <span class="src-prep">{&amp;TABLENAME}</span><!--src-prep-->.ship-addr[1] = shipto.ship-addr[1]
     <span class="src-prep">{&amp;TABLENAME}</span><!--src-prep-->.ship-addr[2] = shipto.ship-addr[2]
     <span class="src-prep">{&amp;TABLENAME}</span><!--src-prep-->.ship-city    = shipto.ship-city
     <span class="src-prep">{&amp;TABLENAME}</span><!--src-prep-->.ship-state   = shipto.ship-state
     <span class="src-prep">{&amp;TABLENAME}</span><!--src-prep-->.ship-zip     = shipto.ship-zip.
<span class="src-keyword">END</span><!--src-keyword-->.
 
<span class="src-keyword">IF</span><!--src-keyword--> <span class="src-prep">{&amp;TABLENAME}</span><!--src-prep-->.carrier <span class="src-keyword">EQ</span><!--src-keyword--> <span class="src-char">""</span><!--src-char--> <span class="src-keyword">AND</span><!--src-keyword-->
   <span class="src-prep">{&amp;TABLENAME}</span><!--src-prep-->.cust-no <span class="src-keyword">NE</span><!--src-keyword--> <span class="src-char">""</span><!--src-char--> <span class="src-keyword">AND</span><!--src-keyword-->
   <span class="src-prep">{&amp;TABLENAME}</span><!--src-prep-->.ship-id <span class="src-keyword">NE</span><!--src-keyword--> <span class="src-char">""</span><!--src-char--> <span class="src-keyword">THEN DO</span><!--src-keyword-->:
  <span class="src-keyword">ASSIGN</span><!--src-keyword-->
   lv-hld-cust = <span class="src-prep">{&amp;TABLENAME}</span><!--src-prep-->.cust-no
   lv-hld-ship = <span class="src-prep">{&amp;TABLENAME}</span><!--src-prep-->.ship-id.
  <span class="src-keyword">IF AVAIL</span><!--src-keyword-->(ef) <span class="src-keyword">THEN</span><!--src-keyword-->
      lv-hld-board = ef.board.
 
  <span class="src-prep">{ce/uship-id.i YES}</span><!--src-prep<span class="src-keyword">YES</span><!--src-keyword-->
<span class="src-keyword">END</span><!--src-keyword-->.
 
<span class="src-keyword">DO</span><!--src-keyword--> li = <span class="src-number">1</span><!--src-number--> <span class="src-keyword">TO EXTENT</span><!--src-keyword-->(<span class="src-prep">{&amp;TABLENAME}</span><!--src-prep-->.i-code):
  <span class="src-keyword">IF</span><!--src-keyword--> <span class="src-prep">{&amp;TABLENAME}</span><!--src-prep-->.i-code[li] <span class="src-keyword">EQ</span><!--src-keyword--> <span class="src-char">""</span><!--src-char--> <span class="src-keyword">OR</span><!--src-keyword--> <span class="src-prep">{&amp;TABLENAME}</span><!--src-prep-->.est-type <span class="src-keyword">LE</span><!--src-keyword--> <span class="src-number">4</span><!--src-number--> <span class="src-keyword">THEN</span><!--src-keyword-->
    <span class="src-keyword">ASSIGN</span><!--src-keyword-->
     <span class="src-prep">{&amp;TABLENAME}</span><!--src-prep-->.i-code[li] = <span class="src-char">""</span><!--src-char-->
     <span class="src-prep">{&amp;TABLENAME}</span><!--src-prep-->.i-ps[li]   = <span class="src-number">0</span><!--src-number-->
     <span class="src-prep">{&amp;TABLENAME}</span><!--src-prep-->.i-dscr[li] = <span class="src-char">""</span><!--src-char-->
     <span class="src-prep">{&amp;TABLENAME}</span><!--src-prep-->.i-%[li]    = <span class="src-number">0</span><!--src-number-->.
<span class="src-keyword">END</span><!--src-keyword-->.
 
<span class="src-keyword">DO</span><!--src-keyword--> li = <span class="src-number">1</span><!--src-number--> <span class="src-keyword">TO EXTENT</span><!--src-keyword-->(<span class="src-prep">{&amp;TABLENAME}</span><!--src-prep-->.i-code2):
  <span class="src-keyword">IF</span><!--src-keyword--> <span class="src-prep">{&amp;TABLENAME}</span><!--src-prep-->.i-code2[li] <span class="src-keyword">EQ</span><!--src-keyword--> <span class="src-char">""</span><!--src-char--> <span class="src-keyword">OR</span><!--src-keyword--> <span class="src-prep">{&amp;TABLENAME}</span><!--src-prep-->.est-type <span class="src-keyword">GT</span><!--src-keyword--> <span class="src-number">4</span><!--src-number--> <span class="src-keyword">THEN</span><!--src-keyword-->
    <span class="src-keyword">ASSIGN</span><!--src-keyword-->
     <span class="src-prep">{&amp;TABLENAME}</span><!--src-prep-->.i-code2[li] = <span class="src-char">""</span><!--src-char-->
     <span class="src-prep">{&amp;TABLENAME}</span><!--src-prep-->.i-ps2[li]   = <span class="src-number">0</span><!--src-number-->
     <span class="src-prep">{&amp;TABLENAME}</span><!--src-prep-->.i-dscr2[li] = <span class="src-char">""</span><!--src-char-->
     <span class="src-prep">{&amp;TABLENAME}</span><!--src-prep-->.i-%2[li]    = <span class="src-number">0</span><!--src-number-->.
<span class="src-keyword">END</span><!--src-keyword-->.
 
<span class="src-keyword">IF</span><!--src-keyword--> cocode <span class="src-keyword">NE</span><!--src-keyword--> <span class="src-char">""</span><!--src-char--> <span class="src-keyword">THEN DO</span><!--src-keyword-->:
  <span class="src-prep">{sys/inc/fgcolors.i}</span><!--src-prep-->
 
  <span class="src-keyword">IF</span><!--src-keyword--> fgcolors-log <span class="src-keyword">AND</span><!--src-keyword--> <span class="src-prep">{&amp;TABLENAME}</span><!--src-prep-->.stock-no <span class="src-keyword">NE</span><!--src-keyword--> <span class="src-char">""</span><!--src-char--> <span class="src-keyword">THEN DO</span><!--src-keyword-->:
    ll-inked = <span class="src-keyword">NO</span><!--src-keyword-->.
 
    <span class="src-keyword">IF</span><!--src-keyword--> <span class="src-prep">{&amp;TABLENAME}</span><!--src-prep-->.est-type <span class="src-keyword">GT</span><!--src-keyword--> <span class="src-number">4</span><!--src-number--> <span class="src-keyword">THEN</span><!--src-keyword-->
    <span class="src-keyword">DO</span><!--src-keyword--> li = <span class="src-number">1</span><!--src-number--> <span class="src-keyword">TO EXTENT</span><!--src-keyword-->(<span class="src-prep">{&amp;TABLENAME}</span><!--src-prep-->.i-code):
      <span class="src-keyword">IF</span><!--src-keyword--> <span class="src-prep">{&amp;TABLENAME}</span><!--src-prep-->.i-ps[li]   <span class="src-keyword">NE</span><!--src-keyword--> old-<span class="src-prep">{&amp;TABLENAME}</span><!--src-prep-->.i-ps[li]   <span class="src-keyword">OR</span><!--src-keyword-->
         <span class="src-prep">{&amp;TABLENAME}</span><!--src-prep-->.i-code[li] <span class="src-keyword">NE</span><!--src-keyword--> old-<span class="src-prep">{&amp;TABLENAME}</span><!--src-prep-->.i-code[li] <span class="src-keyword">OR</span><!--src-keyword-->
         <span class="src-prep">{&amp;TABLENAME}</span><!--src-prep-->.i-dscr[li] <span class="src-keyword">NE</span><!--src-keyword--> old-<span class="src-prep">{&amp;TABLENAME}</span><!--src-prep-->.i-dscr[li] <span class="src-keyword">OR</span><!--src-keyword--> 
         <span class="src-prep">{&amp;TABLENAME}</span><!--src-prep-->.i-%[li]    <span class="src-keyword">NE</span><!--src-keyword--> old-<span class="src-prep">{&amp;TABLENAME}</span><!--src-prep-->.i-%[li]    <span class="src-keyword">THEN DO</span><!--src-keyword-->:
        ll-inked = <span class="src-keyword">YES</span><!--src-keyword-->.
        <span class="src-keyword">LEAVE</span><!--src-keyword-->.
      <span class="src-keyword">END</span><!--src-keyword-->.
    <span class="src-keyword">END</span><!--src-keyword-->.
 
    <span class="src-keyword">ELSE</span><!--src-keyword-->
    <span class="src-keyword">DO</span><!--src-keyword--> li = <span class="src-number">1</span><!--src-number--> <span class="src-keyword">TO EXTENT</span><!--src-keyword-->(<span class="src-prep">{&amp;TABLENAME}</span><!--src-prep-->.i-code2):
      <span class="src-keyword">IF</span><!--src-keyword--> <span class="src-prep">{&amp;TABLENAME}</span><!--src-prep-->.i-ps2[li]   <span class="src-keyword">NE</span><!--src-keyword--> old-<span class="src-prep">{&amp;TABLENAME}</span><!--src-prep-->.i-ps2[li]   <span class="src-keyword">OR</span><!--src-keyword-->
         <span class="src-prep">{&amp;TABLENAME}</span><!--src-prep-->.i-code2[li] <span class="src-keyword">NE</span><!--src-keyword--> old-<span class="src-prep">{&amp;TABLENAME}</span><!--src-prep-->.i-code2[li] <span class="src-keyword">OR</span><!--src-keyword-->
         <span class="src-prep">{&amp;TABLENAME}</span><!--src-prep-->.i-dscr2[li] <span class="src-keyword">NE</span><!--src-keyword--> old-<span class="src-prep">{&amp;TABLENAME}</span><!--src-prep-->.i-dscr2[li] <span class="src-keyword">OR</span><!--src-keyword--> 
         <span class="src-prep">{&amp;TABLENAME}</span><!--src-prep-->.i-%2[li]    <span class="src-keyword">NE</span><!--src-keyword--> old-<span class="src-prep">{&amp;TABLENAME}</span><!--src-prep-->.i-%2[li]    <span class="src-keyword">THEN DO</span><!--src-keyword-->:
        ll-inked = <span class="src-keyword">YES</span><!--src-keyword-->.
        <span class="src-keyword">LEAVE</span><!--src-keyword-->.
      <span class="src-keyword">END</span><!--src-keyword-->.
    <span class="src-keyword">END</span><!--src-keyword-->.
 
    <span class="src-keyword">IF</span><!--src-keyword--> ll-inked <span class="src-keyword">THEN DO</span><!--src-keyword-->:
      <span class="src-keyword">IF</span><!--src-keyword--> <span class="src-prep">{&amp;TABLENAME}</span><!--src-prep-->.est-type <span class="src-keyword">GT</span><!--src-keyword--> <span class="src-number">4</span><!--src-number--> <span class="src-keyword">THEN</span><!--src-keyword-->
      <span class="src-keyword">DO</span><!--src-keyword--> li = <span class="src-number">1</span><!--src-number--> <span class="src-keyword">TO EXTENT</span><!--src-keyword-->(<span class="src-prep">{&amp;TABLENAME}</span><!--src-prep-->.i-code):
        <span class="src-keyword">IF</span><!--src-keyword--> <span class="src-prep">{&amp;TABLENAME}</span><!--src-prep-->.i-code[li] <span class="src-keyword">NE</span><!--src-keyword--> <span class="src-char">""</span><!--src-char--> <span class="src-keyword">THEN DO</span><!--src-keyword-->:
          <span class="src-keyword">CREATE</span><!--src-keyword--> w-itemfg-ink.
          <span class="src-keyword">ASSIGN</span><!--src-keyword-->
           w-itemfg-ink.rm-i-no     = <span class="src-prep">{&amp;TABLENAME}</span><!--src-prep-->.i-code[li]
           w-itemfg-ink.dscr        = <span class="src-prep">{&amp;TABLENAME}</span><!--src-prep-->.i-dscr[li]
           w-itemfg-ink.pass        = <span class="src-prep">{&amp;TABLENAME}</span><!--src-prep-->.i-ps[li]
           w-itemfg-ink.cover%      = <span class="src-prep">{&amp;TABLENAME}</span><!--src-prep-->.i-%[li]
           w-itemfg-ink.old-rm-i-no = old-<span class="src-prep">{&amp;TABLENAME}</span><!--src-prep-->.i-code[li]
           w-itemfg-ink.old-pass    = old-<span class="src-prep">{&amp;TABLENAME}</span><!--src-prep-->.i-ps[li].
        <span class="src-keyword">END</span><!--src-keyword-->.
      <span class="src-keyword">END</span><!--src-keyword-->.
 
      <span class="src-keyword">ELSE</span><!--src-keyword-->
      <span class="src-keyword">DO</span><!--src-keyword--> li = <span class="src-number">1</span><!--src-number--> <span class="src-keyword">TO EXTENT</span><!--src-keyword-->(<span class="src-prep">{&amp;TABLENAME}</span><!--src-prep-->.i-code2):
        <span class="src-keyword">IF</span><!--src-keyword--> <span class="src-prep">{&amp;TABLENAME}</span><!--src-prep-->.i-code2[li] <span class="src-keyword">NE</span><!--src-keyword--> <span class="src-char">""</span><!--src-char--> <span class="src-keyword">THEN DO</span><!--src-keyword-->:
          <span class="src-keyword">CREATE</span><!--src-keyword--> w-itemfg-ink.
          <span class="src-keyword">ASSIGN</span><!--src-keyword-->
           w-itemfg-ink.rm-i-no     = <span class="src-prep">{&amp;TABLENAME}</span><!--src-prep-->.i-code2[li]
           w-itemfg-ink.dscr        = <span class="src-prep">{&amp;TABLENAME}</span><!--src-prep-->.i-dscr2[li]
           w-itemfg-ink.pass        = <span class="src-prep">{&amp;TABLENAME}</span><!--src-prep-->.i-ps2[li]
           w-itemfg-ink.cover%      = <span class="src-prep">{&amp;TABLENAME}</span><!--src-prep-->.i-%2[li]
           w-itemfg-ink.old-rm-i-no = old-<span class="src-prep">{&amp;TABLENAME}</span><!--src-prep-->.i-code2[li]
           w-itemfg-ink.old-pass    = old-<span class="src-prep">{&amp;TABLENAME}</span><!--src-prep-->.i-ps2[li].
        <span class="src-keyword">END</span><!--src-keyword-->.
      <span class="src-keyword">END</span><!--src-keyword-->.
 
      <span class="src-keyword">FOR EACH</span><!--src-keyword--> w-itemfg-ink:
        <span class="src-keyword">FIND FIRST item</span><!--src-keyword-->
             <span class="src-keyword">WHERE item</span><!--src-keyword-->.company <span class="src-keyword">EQ</span><!--src-keyword--> <span class="src-prep">{&amp;TABLENAME}</span><!--src-prep-->.company
               <span class="src-keyword">AND item</span><!--src-keyword-->.i-no    <span class="src-keyword">EQ</span><!--src-keyword--> w-itemfg-ink.rm-i-no
             <span class="src-keyword">NO-LOCK NO-ERROR</span><!--src-keyword-->.
        <span class="src-keyword">IF AVAIL item THEN DO</span><!--src-keyword-->:
          w-itemfg-ink.press-type = <span class="src-keyword">item</span><!--src-keyword-->.press-type.
          <span class="src-keyword">FIND FIRST</span><!--src-keyword--> itemfg-ink
              <span class="src-keyword">WHERE</span><!--src-keyword--> itemfg-ink.company <span class="src-keyword">EQ</span><!--src-keyword--> <span class="src-prep">{&amp;TABLENAME}</span><!--src-prep-->.company
                <span class="src-keyword">AND</span><!--src-keyword--> itemfg-ink.i-no    <span class="src-keyword">EQ</span><!--src-keyword--> <span class="src-prep">{&amp;TABLENAME}</span><!--src-prep-->.stock-no
                <span class="src-keyword">AND</span><!--src-keyword--> itemfg-ink.rm-i-no <span class="src-keyword">EQ</span><!--src-keyword--> w-itemfg-ink.old-rm-i-no
                <span class="src-keyword">AND</span><!--src-keyword--> itemfg-ink.pass    <span class="src-keyword">EQ</span><!--src-keyword--> w-itemfg-ink.old-pass
              <span class="src-keyword">NO-LOCK NO-ERROR</span><!--src-keyword-->.
          <span class="src-keyword">IF AVAIL</span><!--src-keyword--> itemfg-ink <span class="src-keyword">THEN</span><!--src-keyword--> w-itemfg-ink.in-out = itemfg-ink.in-out.
        <span class="src-keyword">END</span><!--src-keyword-->.
        <span class="src-keyword">ELSE DELETE</span><!--src-keyword--> w-itemfg-ink.
      <span class="src-keyword">END</span><!--src-keyword-->.
 
      <span class="src-keyword">FOR EACH</span><!--src-keyword--> w-itemfg-ink
          <span class="src-keyword">BREAK BY</span><!--src-keyword--> w-itemfg-ink.rm-i-no
                <span class="src-keyword">BY</span><!--src-keyword--> w-itemfg-ink.in-out:
        <span class="src-keyword">IF NOT FIRST-OF</span><!--src-keyword-->(w-itemfg-ink.in-out) <span class="src-keyword">THEN DELETE</span><!--src-keyword--> w-itemfg-ink.
      <span class="src-keyword">END</span><!--src-keyword-->.
 
      rec-list = <span class="src-char">""</span><!--src-char-->.
 
      <span class="src-keyword">FOR EACH</span><!--src-keyword--> w-itemfg-ink
          <span class="src-keyword">BREAK BY</span><!--src-keyword--> w-itemfg-ink.pass
                <span class="src-keyword">BY</span><!--src-keyword--> w-itemfg-ink.press-type:
 
        <span class="src-keyword">IF FIRST-OF</span><!--src-keyword-->(w-itemfg-ink.press-type) <span class="src-keyword">THEN</span><!--src-keyword-->
        <span class="src-keyword">FOR EACH</span><!--src-keyword--> itemfg-ink
            <span class="src-keyword">WHERE</span><!--src-keyword--> itemfg-ink.company <span class="src-keyword">EQ</span><!--src-keyword--> <span class="src-prep">{&amp;TABLENAME}</span><!--src-prep-->.company
              <span class="src-keyword">AND</span><!--src-keyword--> itemfg-ink.i-no    <span class="src-keyword">EQ</span><!--src-keyword--> <span class="src-prep">{&amp;TABLENAME}</span><!--src-prep-->.stock-no
              <span class="src-keyword">AND</span><!--src-keyword--> itemfg-ink.pass    <span class="src-keyword">EQ</span><!--src-keyword--> w-itemfg-ink.pass,
            <span class="src-keyword">FIRST item</span><!--src-keyword-->
            <span class="src-keyword">WHERE item</span><!--src-keyword-->.company    <span class="src-keyword">EQ</span><!--src-keyword--> itemfg-ink.company
              <span class="src-keyword">AND item</span><!--src-keyword-->.i-no       <span class="src-keyword">EQ</span><!--src-keyword--> itemfg-ink.rm-i-no
              <span class="src-keyword">AND item</span><!--src-keyword-->.press-type <span class="src-keyword">EQ</span><!--src-keyword--> w-itemfg-ink.press-type
            <span class="src-keyword">NO-LOCK</span><!--src-keyword-->:
          <span class="src-keyword">DELETE</span><!--src-keyword--> itemfg-ink.
        <span class="src-keyword">END</span><!--src-keyword-->.
 
        <span class="src-keyword">FIND FIRST</span><!--src-keyword--> itemfg-ink
            <span class="src-keyword">WHERE</span><!--src-keyword--> itemfg-ink.company <span class="src-keyword">EQ</span><!--src-keyword--> <span class="src-prep">{&amp;TABLENAME}</span><!--src-prep-->.company
              <span class="src-keyword">AND</span><!--src-keyword--> itemfg-ink.i-no    <span class="src-keyword">EQ</span><!--src-keyword--> <span class="src-prep">{&amp;TABLENAME}</span><!--src-prep-->.stock-no
              <span class="src-keyword">AND</span><!--src-keyword--> itemfg-ink.rm-i-no <span class="src-keyword">EQ</span><!--src-keyword--> w-itemfg-ink.rm-i-no
              <span class="src-keyword">AND</span><!--src-keyword--> itemfg-ink.in-out  <span class="src-keyword">EQ</span><!--src-keyword--> w-itemfg-ink.in-out
              <span class="src-keyword">AND</span><!--src-keyword--> itemfg-ink.pass    <span class="src-keyword">EQ</span><!--src-keyword--> w-itemfg-ink.pass
            <span class="src-keyword">NO-ERROR</span><!--src-keyword-->.
 
        <span class="src-keyword">IF NOT AVAIL</span><!--src-keyword--> itemfg-ink <span class="src-keyword">THEN CREATE</span><!--src-keyword--> itemfg-ink.
 
        <span class="src-keyword">RUN</span><!--src-keyword--> update-itemfg-ink.
 
 
        <span class="src-keyword">IF NOT CAN-DO</span><!--src-keyword-->(rec-list,itemfg-ink.rec_key) <span class="src-keyword">THEN</span><!--src-keyword-->
          <span class="src-keyword">ASSIGN</span><!--src-keyword-->
           rec-list        = <span class="src-keyword">TRIM</span><!--src-keyword-->(rec-list)                       +
                             (<span class="src-keyword">IF</span><!--src-keyword--> rec-list <span class="src-keyword">EQ</span><!--src-keyword--> <span class="src-char">""</span><!--src-char--> <span class="src-keyword">THEN</span><!--src-keyword--> <span class="src-char">""</span><!--src-char--> <span class="src-keyword">ELSE</span><!--src-keyword--> <span class="src-char">","</span><!--src-char-->) +
                             itemfg-ink.rec_key
           itemfg-ink.occurs = <span class="src-number">0</span><!--src-number-->.
 
        itemfg-ink.occurs = itemfg-ink.occurs + <span class="src-number">1</span><!--src-number-->.
      <span class="src-keyword">END</span><!--src-keyword-->.
    <span class="src-keyword">END</span><!--src-keyword-->.
  <span class="src-keyword">END</span><!--src-keyword-->.
<span class="src-keyword">END</span><!--src-keyword-->.
 
<span class="src-keyword">IF</span><!--src-keyword--> <span class="src-prep">{&amp;TABLENAME}</span><!--src-prep-->.stock-no <span class="src-keyword">NE</span><!--src-keyword--> <span class="src-char">""</span><!--src-char--> <span class="src-keyword">THEN</span><!--src-keyword-->
<span class="src-keyword">FOR EACH</span><!--src-keyword--> b-itemfg <span class="src-keyword">NO-LOCK</span><!--src-keyword-->
    <span class="src-keyword">WHERE</span><!--src-keyword--> b-itemfg.company <span class="src-keyword">EQ</span><!--src-keyword--> <span class="src-prep">{&amp;TABLENAME}</span><!--src-prep-->.company
      <span class="src-keyword">AND</span><!--src-keyword--> b-itemfg.i-no    <span class="src-keyword">EQ</span><!--src-keyword--> <span class="src-prep">{&amp;TABLENAME}</span><!--src-prep-->.stock-no:
 
 <span class="src-keyword">FIND</span><!--src-keyword--> itemfg <span class="src-keyword">WHERE ROWID</span><!--src-keyword-->(itemfg) <span class="src-keyword">EQ ROWID</span><!--src-keyword-->(b-itemfg)
     <span class="src-keyword">EXCLUSIVE-LOCK NO-WAIT NO-ERROR</span><!--src-keyword-->.
 
 <span class="src-keyword">IF AVAIL</span><!--src-keyword--> itemfg <span class="src-keyword">THEN DO</span><!--src-keyword-->:
  <span class="src-keyword">IF</span><!--src-keyword--> itemfg.est-no <span class="src-keyword">EQ</span><!--src-keyword--> <span class="src-char">""</span><!--src-char--> <span class="src-keyword">THEN</span><!--src-keyword--> itemfg.est-no = <span class="src-prep">{&amp;TABLENAME}</span><!--src-prep-->.est-no.
 
  <span class="src-keyword">IF</span><!--src-keyword--> itemfg.cust-no     <span class="src-keyword">EQ</span><!--src-keyword--> <span class="src-char">""</span><!--src-char--> <span class="src-keyword">OR</span><!--src-keyword--> itemfg.est-no <span class="src-keyword">EQ</span><!--src-keyword--> <span class="src-prep">{&amp;TABLENAME}</span><!--src-prep-->.est-no <span class="src-keyword">THEN</span><!--src-keyword-->
    itemfg.cust-no     = <span class="src-prep">{&amp;TABLENAME}</span><!--src-prep-->.cust-no.
  <span class="src-keyword">IF</span><!--src-keyword--> itemfg.part-no     <span class="src-keyword">EQ</span><!--src-keyword--> <span class="src-char">""</span><!--src-char--> <span class="src-keyword">OR</span><!--src-keyword--> itemfg.est-no <span class="src-keyword">EQ</span><!--src-keyword--> <span class="src-prep">{&amp;TABLENAME}</span><!--src-prep-->.est-no <span class="src-keyword">THEN</span><!--src-keyword-->
    itemfg.part-no     = <span class="src-prep">{&amp;TABLENAME}</span><!--src-prep-->.part-no.
  <span class="src-keyword">IF</span><!--src-keyword--> itemfg.i-name      <span class="src-keyword">EQ</span><!--src-keyword--> <span class="src-char">""</span><!--src-char--> <span class="src-keyword">OR</span><!--src-keyword--> itemfg.est-no <span class="src-keyword">EQ</span><!--src-keyword--> <span class="src-prep">{&amp;TABLENAME}</span><!--src-prep-->.est-no <span class="src-keyword">THEN</span><!--src-keyword-->
    itemfg.i-name      = <span class="src-prep">{&amp;TABLENAME}</span><!--src-prep-->.part-dscr1.
  <span class="src-keyword">IF</span><!--src-keyword--> itemfg.part-dscr1  <span class="src-keyword">EQ</span><!--src-keyword--> <span class="src-char">""</span><!--src-char--> <span class="src-keyword">OR</span><!--src-keyword--> itemfg.est-no <span class="src-keyword">EQ</span><!--src-keyword--> <span class="src-prep">{&amp;TABLENAME}</span><!--src-prep-->.est-no <span class="src-keyword">THEN</span><!--src-keyword-->
    itemfg.part-dscr1  = <span class="src-prep">{&amp;TABLENAME}</span><!--src-prep-->.part-dscr2.
  <span class="src-keyword">IF</span><!--src-keyword--> itemfg.style       <span class="src-keyword">EQ</span><!--src-keyword--> <span class="src-char">""</span><!--src-char--> <span class="src-keyword">OR</span><!--src-keyword--> itemfg.est-no <span class="src-keyword">EQ</span><!--src-keyword--> <span class="src-prep">{&amp;TABLENAME}</span><!--src-prep-->.est-no <span class="src-keyword">THEN</span><!--src-keyword-->
    itemfg.style       = <span class="src-prep">{&amp;TABLENAME}</span><!--src-prep-->.style.
  <span class="src-keyword">IF</span><!--src-keyword--> itemfg.procat      <span class="src-keyword">EQ</span><!--src-keyword--> <span class="src-char">""</span><!--src-char--> <span class="src-keyword">OR</span><!--src-keyword--> itemfg.est-no <span class="src-keyword">EQ</span><!--src-keyword--> <span class="src-prep">{&amp;TABLENAME}</span><!--src-prep-->.est-no <span class="src-keyword">THEN</span><!--src-keyword--> 
  <span class="src-keyword">DO</span><!--src-keyword-->:
    itemfg.procat      = <span class="src-prep">{&amp;TABLENAME}</span><!--src-prep-->.procat.
    <span class="src-keyword">FIND FIRST</span><!--src-keyword--> procat <span class="src-keyword">WHERE</span><!--src-keyword--> procat.company = itemfg.company 
        <span class="src-keyword">AND</span><!--src-keyword--> procat.procat = itemfg.procat <span class="src-keyword">NO-LOCK NO-ERROR</span><!--src-keyword-->.
    <span class="src-keyword">IF AVAIL</span><!--src-keyword--> procat <span class="src-keyword">THEN</span><!--src-keyword--> itemfg.procat-desc = procat.dscr.
  <span class="src-keyword">END</span><!--src-keyword-->.
  <span class="src-keyword">IF</span><!--src-keyword--> itemfg.die-no      <span class="src-keyword">EQ</span><!--src-keyword--> <span class="src-char">""</span><!--src-char--> <span class="src-keyword">OR</span><!--src-keyword--> itemfg.est-no <span class="src-keyword">EQ</span><!--src-keyword--> <span class="src-prep">{&amp;TABLENAME}</span><!--src-prep-->.est-no <span class="src-keyword">THEN</span><!--src-keyword-->
    itemfg.die-no      = <span class="src-prep">{&amp;TABLENAME}</span><!--src-prep-->.die-no.
  <span class="src-keyword">IF</span><!--src-keyword--> itemfg.plate-no    <span class="src-keyword">EQ</span><!--src-keyword--> <span class="src-char">""</span><!--src-char--> <span class="src-keyword">OR</span><!--src-keyword--> itemfg.est-no <span class="src-keyword">EQ</span><!--src-keyword--> <span class="src-prep">{&amp;TABLENAME}</span><!--src-prep-->.est-no <span class="src-keyword">THEN</span><!--src-keyword-->
    itemfg.plate-no    = <span class="src-prep">{&amp;TABLENAME}</span><!--src-prep-->.plate-no.
  <span class="src-keyword">IF</span><!--src-keyword--> itemfg.cad-no      <span class="src-keyword">EQ</span><!--src-keyword--> <span class="src-char">""</span><!--src-char--> <span class="src-keyword">OR</span><!--src-keyword--> itemfg.est-no <span class="src-keyword">EQ</span><!--src-keyword--> <span class="src-prep">{&amp;TABLENAME}</span><!--src-prep-->.est-no <span class="src-keyword">THEN</span><!--src-keyword-->
    itemfg.cad-no      = <span class="src-prep">{&amp;TABLENAME}</span><!--src-prep-->.cad-no.
  <span class="src-keyword">IF</span><!--src-keyword--> itemfg.upc-no      <span class="src-keyword">EQ</span><!--src-keyword--> <span class="src-char">""</span><!--src-char--> <span class="src-keyword">OR</span><!--src-keyword--> itemfg.est-no <span class="src-keyword">EQ</span><!--src-keyword--> <span class="src-prep">{&amp;TABLENAME}</span><!--src-prep-->.est-no <span class="src-keyword">THEN</span><!--src-keyword-->
    itemfg.upc-no      = <span class="src-prep">{&amp;TABLENAME}</span><!--src-prep-->.upc-no.
  <span class="src-keyword">IF</span><!--src-keyword--> itemfg.spc-no      <span class="src-keyword">EQ</span><!--src-keyword--> <span class="src-char">""</span><!--src-char--> <span class="src-keyword">OR</span><!--src-keyword--> itemfg.est-no <span class="src-keyword">EQ</span><!--src-keyword--> <span class="src-prep">{&amp;TABLENAME}</span><!--src-prep-->.est-no <span class="src-keyword">THEN</span><!--src-keyword-->
    itemfg.spc-no      = <span class="src-prep">{&amp;TABLENAME}</span><!--src-prep-->.spc-no.
 
  <span class="src-keyword">ASSIGN</span><!--src-keyword-->
   ld-len = itemfg.l-score[50]
   ld-wid = itemfg.w-score[50]
   ld-dep = itemfg.d-score[50].
 
  <span class="src-keyword">IF</span><!--src-keyword--> itemfg.l-score[50] <span class="src-keyword">EQ</span><!--src-keyword--> <span class="src-number">0</span><!--src-number--> <span class="src-keyword">OR</span><!--src-keyword--> itemfg.est-no <span class="src-keyword">EQ</span><!--src-keyword--> <span class="src-prep">{&amp;TABLENAME}</span><!--src-prep-->.est-no <span class="src-keyword">THEN</span><!--src-keyword-->
    itemfg.l-score[50] = <span class="src-prep">{&amp;TABLENAME}</span><!--src-prep-->.len.
  <span class="src-keyword">IF</span><!--src-keyword--> itemfg.w-score[50] <span class="src-keyword">EQ</span><!--src-keyword--> <span class="src-number">0</span><!--src-number--> <span class="src-keyword">OR</span><!--src-keyword--> itemfg.est-no <span class="src-keyword">EQ</span><!--src-keyword--> <span class="src-prep">{&amp;TABLENAME}</span><!--src-prep-->.est-no <span class="src-keyword">THEN</span><!--src-keyword-->
    itemfg.w-score[50] = <span class="src-prep">{&amp;TABLENAME}</span><!--src-prep-->.wid.
  <span class="src-keyword">IF</span><!--src-keyword--> itemfg.d-score[50] <span class="src-keyword">EQ</span><!--src-keyword--> <span class="src-number">0</span><!--src-number--> <span class="src-keyword">OR</span><!--src-keyword--> itemfg.est-no <span class="src-keyword">EQ</span><!--src-keyword--> <span class="src-prep">{&amp;TABLENAME}</span><!--src-prep-->.est-no <span class="src-keyword">THEN</span><!--src-keyword-->
    itemfg.d-score[50] = <span class="src-prep">{&amp;TABLENAME}</span><!--src-prep-->.dep.
 
  <span class="src-keyword">IF</span><!--src-keyword--> itemfg.l-score[50] <span class="src-keyword">NE</span><!--src-keyword--> ld-len <span class="src-keyword">OR</span><!--src-keyword-->
     itemfg.w-score[50] <span class="src-keyword">NE</span><!--src-keyword--> ld-wid <span class="src-keyword">OR</span><!--src-keyword-->
     itemfg.d-score[50] <span class="src-keyword">NE</span><!--src-keyword--> ld-dep <span class="src-keyword">THEN</span><!--src-keyword-->
    <span class="src-keyword">IF</span><!--src-keyword--> itemfg.isaset <span class="src-keyword">THEN RUN</span><!--src-keyword--> fg/updsetdm.p (<span class="src-keyword">RECID</span><!--src-keyword-->(<span class="src-prep">{&amp;TABLENAME}</span><!--src-prep-->)).
    <span class="src-keyword">ELSE DO</span><!--src-keyword-->:
      <span class="src-prep">{sys/inc/updfgdim.i <span class="src-prep">{&amp;TABLENAME}</span><!--src-prep-->}
    <span class="src-keyword">END</span><!--src-keyword-->.
 <span class="src-keyword">END</span><!--src-keyword-->.
<span class="src-keyword">END</span><!--src-keyword-->.
 
<span class="src-keyword">IF</span><!--src-keyword--> <span class="src-prep">{&amp;TABLENAME}</span><!--src-prep-->.stack-code <span class="src-keyword">NE</span><!--src-keyword--> <span class="src-char">""</span><!--src-char--> <span class="src-keyword">AND</span><!--src-keyword--> <span class="src-prep">{&amp;TABLENAME}</span><!--src-prep-->.stacks <span class="src-keyword">EQ</span><!--src-keyword--> <span class="src-number">0</span><!--src-number--> <span class="src-keyword">THEN DO</span><!--src-keyword-->:
  <span class="src-keyword">FIND FIRST</span><!--src-keyword--> stackPattern <span class="src-keyword">NO-LOCK</span><!--src-keyword-->
       <span class="src-keyword">WHERE</span><!--src-keyword--> stackPattern.stackCode <span class="src-keyword">EQ</span><!--src-keyword--> <span class="src-prep">{&amp;TABLENAME}</span><!--src-prep-->.stack-code
      <span class="src-keyword">NO-ERROR</span><!--src-keyword-->.
  <span class="src-keyword">IF AVAIL</span><!--src-keyword--> stackPattern <span class="src-keyword">THEN</span><!--src-keyword--> <span class="src-prep">{&amp;TABLENAME}</span><!--src-prep-->.stacks = stackPattern.stackCount.
<span class="src-keyword">END</span><!--src-keyword-->.
 
<span class="src-comment">/* Clear out any error-status from find with no-error that is false */</span><!--src-comment-->
<span class="src-keyword">DEF VAR</span><!--src-keyword--> ll-error <span class="src-keyword">AS LOG NO-UNDO</span><!--src-keyword-->.
ll-error = <span class="src-keyword">YES NO-ERROR</span><!--src-keyword-->.
 
<span class="src-keyword">RETURN</span><!--src-keyword-->.
 
<span class="src-keyword">PROCEDURE</span><!--src-keyword--> update-itemfg-ink.
 
  <span class="src-keyword">IF</span><!--src-keyword--> itemfg-ink.rec_key <span class="src-keyword">EQ</span><!--src-keyword--> <span class="src-char">""</span><!--src-char--> <span class="src-keyword">THEN DO</span><!--src-keyword-->:
    <span class="src-prep">{custom/rec_key.i itemfg-ink}</span><!--src-prep-->
  <span class="src-keyword">END</span><!--src-keyword-->.
 
  <span class="src-keyword">BUFFER-COPY</span><!--src-keyword--> w-itemfg-ink <span class="src-keyword">EXCEPT</span><!--src-keyword--> rec_key <span class="src-keyword">TO</span><!--src-keyword--> itemfg-ink
  <span class="src-keyword">ASSIGN</span><!--src-keyword-->
   itemfg-ink.company = <span class="src-prep">{&amp;TABLENAME}</span><!--src-prep-->.company
   itemfg-ink.i-no    = <span class="src-prep">{&amp;TABLENAME}</span><!--src-prep-->.stock-no.
 
<span class="src-keyword">END PROCEDURE</span><!--src-keyword-->.
</div><!--progresscode-->
</body>
</html>
