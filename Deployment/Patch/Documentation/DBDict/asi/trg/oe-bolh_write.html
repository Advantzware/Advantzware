<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
  <meta name="generator" content="HtmlDict.w version 11">
  <meta name="author"    content="Patrick Tingen [patrick at tingen dot nl]">
  <link rel="stylesheet" title="Default" type="text/css" href="../../default.css">
  <link rel="alternate stylesheet" title="blue" type="text/css" href="../../blue.css">
  <link rel="alternate stylesheet" title="default" type="text/css" href="../../default.css">
  <link rel="alternate stylesheet" title="green" type="text/css" href="../../green.css">
  <link rel="alternate stylesheet" title="oldstyle" type="text/css" href="../../oldstyle.css">
  <link rel="alternate stylesheet" title="red" type="text/css" href="../../red.css">
  <link rel="shortcut icon" href="../../htmldict.ico">
  <link rel="stylesheet" media="print" type="text/css" href="../../print.css">
  <script src="../../swapstyle.js"    type="text/javascript"></script>
  <script src="../../stylechooser.js" type="text/javascript"></script>
  <script src="../../dbchooser.js"    type="text/javascript"></script>
  <script src="../../htmldict.js"     type="text/javascript"></script>
  <title> Trigger code: write of oe-bolh</title>
</head>
<body onload="useStyleAgain('HtmlDict');" onunload="rememberStyle('HtmlDict',10);">
<div><a name="top"></a></div>
<table style="width:100%;">
  <tr>
    <td class="navbar" style="width:80%;"><a href="../../../00-index.html"target="_top">DB</a>
 | <a href="../../00-area.html"target="main">Areas</a>
 | <a href="../../00-cross.html"target="main">X-idx</a>
 | <a href="../../00-main.html"target="main">Tables</a>
 | <a href="../../00-sequences.html"target="main">Sequences</a>
</td>
    <td class="navbar" style="width:20%; text-align:right;"><a href="../../htmldict.html"target="_top">HtmlDict 11</a></td>
  </tr>
</table>
 
<h1>Trigger code: write of oe-bolh</h1>
<div class="progressCode">
<span class="src-prep">&amp;Scoped-define</span><!--src-prep--> ACTION <span class="src-keyword">UPDATE</span><!--src-keyword-->
<span class="src-prep">&amp;Scoped-define</span><!--src-prep--> <span class="src-keyword">DBNAME</span><!--src-keyword--> ASI
<span class="src-prep">&amp;Scoped-define</span><!--src-prep--> TABLENAME oe-bolh
 
<span class="src-keyword">TRIGGER PROCEDURE FOR WRITE OF</span><!--src-keyword--> <span class="src-prep">{&amp;TABLENAME}</span><!--src-prep--> <span class="src-keyword">OLD BUFFER</span><!--src-keyword--> old-<span class="src-prep">{&amp;TABLENAME}</span><!--src-prep-->.
 
<span class="src-prep">{methods/<span class="src-keyword">triggers</span><!--src-keyword-->/<span class="src-keyword">write</span><!--src-keyword-->.i}</span><!--src-prep-->
 
<span class="src-keyword">DEF VAR</span><!--src-keyword--> ll <span class="src-keyword">AS LOG NO-UNDO</span><!--src-keyword-->.
<span class="src-keyword">DEF VAR</span><!--src-keyword--> lv-bol-no <span class="src-keyword">LIKE</span><!--src-keyword--> <span class="src-prep">{&amp;TABLENAME}</span><!--src-prep-->.bol-no <span class="src-keyword">NO-UNDO</span><!--src-keyword-->.
<span class="src-keyword">DEF VAR</span><!--src-keyword--> v-nxt-r-no <span class="src-keyword">AS INT NO-UNDO</span><!--src-keyword-->.
 
<span class="src-keyword">DEF BUFFER</span><!--src-keyword--> b-oe-ordl <span class="src-keyword">FOR</span><!--src-keyword--> oe-ordl.
<span class="src-keyword">DEF BUFFER</span><!--src-keyword--> b-oe-rel  <span class="src-keyword">FOR</span><!--src-keyword--> oe-rel.
<span class="src-keyword">DEF BUFFER</span><!--src-keyword--> b-oe-relh <span class="src-keyword">FOR</span><!--src-keyword--> oe-relh.
<span class="src-keyword">DEF BUFFER</span><!--src-keyword--> b-oe-rell <span class="src-keyword">FOR</span><!--src-keyword--> oe-rell.
<span class="src-keyword">DEF BUFFER</span><!--src-keyword--> b-<span class="src-prep">{&amp;TABLENAME}</span><!--src-prep--> <span class="src-keyword">FOR</span><!--src-keyword--> <span class="src-prep">{&amp;TABLENAME}</span><!--src-prep-->.
<span class="src-keyword">DEF BUFFER</span><!--src-keyword--> b-oe-boll <span class="src-keyword">FOR</span><!--src-keyword--> oe-boll.
 
<span class="src-keyword">DEF VAR</span><!--src-keyword--> li <span class="src-keyword">AS INT NO-UNDO</span><!--src-keyword-->.
 
 
<span class="src-keyword">DISABLE TRIGGERS FOR LOAD OF</span><!--src-keyword--> b-oe-boll.
<span class="src-keyword">DISABLE TRIGGERS FOR LOAD OF</span><!--src-keyword--> b-oe-relh.
 
<span class="src-keyword">IF</span><!--src-keyword--> <span class="src-prep">{&amp;TABLENAME}</span><!--src-prep-->.company <span class="src-keyword">NE</span><!--src-keyword--> <span class="src-char">""</span><!--src-char--> <span class="src-keyword">AND</span><!--src-keyword--> <span class="src-prep">{&amp;TABLENAME}</span><!--src-prep-->.b-no <span class="src-keyword">NE</span><!--src-keyword--> <span class="src-number">0</span><!--src-number--> <span class="src-keyword">AND NOT</span><!--src-keyword--> <span class="src-prep">{&amp;TABLENAME}</span><!--src-prep-->.posted <span class="src-keyword">THEN</span><!--src-keyword-->
<span class="src-keyword">DO WHILE CAN-FIND</span><!--src-keyword-->(<span class="src-keyword">FIRST</span><!--src-keyword--> b-<span class="src-prep">{&amp;TABLENAME}</span><!--src-prep-->
                  <span class="src-keyword">WHERE</span><!--src-keyword--> b-<span class="src-prep">{&amp;TABLENAME}</span><!--src-prep-->.b-no   <span class="src-keyword">EQ</span><!--src-keyword--> <span class="src-prep">{&amp;TABLENAME}</span><!--src-prep-->.b-no
                    <span class="src-keyword">AND ROWID</span><!--src-keyword-->(b-<span class="src-prep">{&amp;TABLENAME}</span><!--src-prep-->) <span class="src-keyword">NE ROWID</span><!--src-keyword-->(<span class="src-prep">{&amp;TABLENAME}</span><!--src-prep-->)):
  li = <span class="src-number">0</span><!--src-number-->.
 
  <span class="src-keyword">FIND LAST</span><!--src-keyword--> b-<span class="src-prep">{&amp;TABLENAME}</span><!--src-prep--> <span class="src-keyword">USE-INDEX</span><!--src-keyword--> b-no <span class="src-keyword">NO-LOCK NO-ERROR</span><!--src-keyword-->.
  <span class="src-keyword">IF AVAIL</span><!--src-keyword--> b-<span class="src-prep">{&amp;TABLENAME}</span><!--src-prep--> <span class="src-keyword">AND</span><!--src-keyword--> b-<span class="src-prep">{&amp;TABLENAME}</span><!--src-prep-->.b-no <span class="src-keyword">GT</span><!--src-keyword--> li <span class="src-keyword">THEN</span><!--src-keyword--> li = b-<span class="src-prep">{&amp;TABLENAME}</span><!--src-prep-->.b-no.
 
  <span class="src-prep">{&amp;TABLENAME}</span><!--src-prep-->.b-no = li + <span class="src-number">1</span><!--src-number-->.
<span class="src-keyword">END</span><!--src-keyword-->.
<span class="src-comment">/*
IF {&amp;TABLENAME}.release# NE 0                                    AND
   NOT CAN-FIND(FIRST oe-relh
                WHERE oe-relh.company  EQ {&amp;TABLENAME}.company
                  AND oe-relh.release# EQ {&amp;TABLENAME}.release#) THEN DO:
  IF oe-bolh.r-no = 0 THEN DO:
     find last oe-relh use-index r-no no-lock no-error.
     v-nxt-r-no = if avail oe-relh then oe-relh.r-no else 0.
     oe-bolh.r-no = v-nxt-r-no + 1.
  END.
  CREATE oe-relh.
  BUFFER-COPY oe-bolh EXCEPT rec_key TO oe-relh
     ASSIGN oe-relh.posted = YES.
END.
  */</span><!--src-comment-->
<span class="src-keyword">IF</span><!--src-keyword--> <span class="src-prep">{&amp;TABLENAME}</span><!--src-prep-->.bol-no <span class="src-keyword">NE</span><!--src-keyword--> old-<span class="src-prep">{&amp;TABLENAME}</span><!--src-prep-->.bol-no <span class="src-keyword">AND</span><!--src-keyword-->
   <span class="src-prep">{&amp;TABLENAME}</span><!--src-prep-->.bol-no <span class="src-keyword">NE</span><!--src-keyword--> <span class="src-number">0</span><!--src-number-->                       <span class="src-keyword">AND</span><!--src-keyword-->
   old-<span class="src-prep">{&amp;TABLENAME}</span><!--src-prep-->.bol-no <span class="src-keyword">NE</span><!--src-keyword--> <span class="src-number">0</span><!--src-number-->                   <span class="src-keyword">THEN DO</span><!--src-keyword-->:
 
  <span class="src-keyword">FIND FIRST</span><!--src-keyword--> oe-ctrl <span class="src-keyword">WHERE</span><!--src-keyword--> oe-ctrl.company <span class="src-keyword">EQ</span><!--src-keyword--> <span class="src-prep">{&amp;TABLENAME}</span><!--src-prep-->.company <span class="src-keyword">EXCLUSIVE NO-ERROR</span><!--src-keyword-->.
  <span class="src-keyword">IF AVAIL</span><!--src-keyword--> oe-ctrl <span class="src-keyword">AND</span><!--src-keyword--> oe-ctrl.n-bol <span class="src-keyword">EQ</span><!--src-keyword--> old-<span class="src-prep">{&amp;TABLENAME}</span><!--src-prep-->.bol-no + <span class="src-number">1</span><!--src-number--> <span class="src-keyword">THEN</span><!--src-keyword-->
    oe-ctrl.n-bol = old-<span class="src-prep">{&amp;TABLENAME}</span><!--src-prep-->.bol-no.
 
  <span class="src-keyword">FIND FIRST</span><!--src-keyword--> oe-boll <span class="src-keyword">NO-LOCK</span><!--src-keyword-->
      <span class="src-keyword">WHERE</span><!--src-keyword--> oe-boll.company <span class="src-keyword">EQ</span><!--src-keyword--> <span class="src-prep">{&amp;TABLENAME}</span><!--src-prep-->.company
        <span class="src-keyword">AND</span><!--src-keyword--> oe-boll.b-no    <span class="src-keyword">EQ</span><!--src-keyword--> <span class="src-prep">{&amp;TABLENAME}</span><!--src-prep-->.b-no
        <span class="src-keyword">AND</span><!--src-keyword--> oe-boll.s-code  <span class="src-keyword">NE</span><!--src-keyword--> <span class="src-char">""</span><!--src-char-->
      <span class="src-keyword">NO-ERROR</span><!--src-keyword-->.
 
  ll = <span class="src-keyword">NO</span><!--src-keyword-->.
  <span class="src-keyword">IF</span><!--src-keyword--> oe-boll.s-code <span class="src-keyword">EQ</span><!--src-keyword--> <span class="src-char">"T"</span><!--src-char--> <span class="src-keyword">THEN</span><!--src-keyword-->
  <span class="src-keyword">FOR EACH</span><!--src-keyword--> b-<span class="src-prep">{&amp;TABLENAME}</span><!--src-prep-->
      <span class="src-keyword">WHERE</span><!--src-keyword--> b-<span class="src-prep">{&amp;TABLENAME}</span><!--src-prep-->.company  <span class="src-keyword">EQ</span><!--src-keyword--> <span class="src-prep">{&amp;TABLENAME}</span><!--src-prep-->.company
        <span class="src-keyword">AND</span><!--src-keyword--> b-<span class="src-prep">{&amp;TABLENAME}</span><!--src-prep-->.bol-no   <span class="src-keyword">EQ</span><!--src-keyword--> <span class="src-prep">{&amp;TABLENAME}</span><!--src-prep-->.bol-no
        <span class="src-keyword">AND ROWID</span><!--src-keyword-->(b-<span class="src-prep">{&amp;TABLENAME}</span><!--src-prep-->)   <span class="src-keyword">NE ROWID</span><!--src-keyword-->(<span class="src-prep">{&amp;TABLENAME}</span><!--src-prep-->)
        <span class="src-keyword">AND</span><!--src-keyword--> (b-<span class="src-prep">{&amp;TABLENAME}</span><!--src-prep-->.cust-no <span class="src-keyword">NE</span><!--src-keyword--> <span class="src-prep">{&amp;TABLENAME}</span><!--src-prep-->.cust-no <span class="src-keyword">OR</span><!--src-keyword-->
             b-<span class="src-prep">{&amp;TABLENAME}</span><!--src-prep-->.ship-id <span class="src-keyword">NE</span><!--src-keyword--> <span class="src-prep">{&amp;TABLENAME}</span><!--src-prep-->.ship-id <span class="src-keyword">OR</span><!--src-keyword-->
             b-<span class="src-prep">{&amp;TABLENAME}</span><!--src-prep-->.posted  <span class="src-keyword">EQ YES                  OR</span><!--src-keyword-->
             b-<span class="src-prep">{&amp;TABLENAME}</span><!--src-prep-->.deleted <span class="src-keyword">EQ YES                  OR</span><!--src-keyword-->
             (<span class="src-keyword">AVAIL</span><!--src-keyword--> oe-boll <span class="src-keyword">AND</span><!--src-keyword-->
              <span class="src-keyword">CAN-FIND</span><!--src-keyword-->(<span class="src-keyword">FIRST</span><!--src-keyword--> b-oe-boll
                       <span class="src-keyword">WHERE</span><!--src-keyword--> b-oe-boll.company <span class="src-keyword">EQ</span><!--src-keyword--> b-<span class="src-prep">{&amp;TABLENAME}</span><!--src-prep-->.company
                         <span class="src-keyword">AND</span><!--src-keyword--> b-oe-boll.b-no    <span class="src-keyword">EQ</span><!--src-keyword--> b-<span class="src-prep">{&amp;TABLENAME}</span><!--src-prep-->.b-no
                         <span class="src-keyword">AND</span><!--src-keyword--> b-oe-boll.s-code  <span class="src-keyword">NE</span><!--src-keyword--> oe-boll.s-code)))
      <span class="src-keyword">NO-LOCK</span><!--src-keyword-->:
    ll = <span class="src-keyword">YES</span><!--src-keyword-->.
    <span class="src-keyword">LEAVE</span><!--src-keyword-->.
  <span class="src-keyword">END</span><!--src-keyword-->.
 
  <span class="src-keyword">IF</span><!--src-keyword--> ll                                                                <span class="src-keyword">OR</span><!--src-keyword-->
     <span class="src-keyword">NOT CAN-FIND</span><!--src-keyword-->(<span class="src-keyword">FIRST</span><!--src-keyword--> b-<span class="src-prep">{&amp;TABLENAME}</span><!--src-prep-->
                  <span class="src-keyword">WHERE</span><!--src-keyword--> b-<span class="src-prep">{&amp;TABLENAME}</span><!--src-prep-->.company <span class="src-keyword">EQ</span><!--src-keyword--> <span class="src-prep">{&amp;TABLENAME}</span><!--src-prep-->.company
                    <span class="src-keyword">AND</span><!--src-keyword--> b-<span class="src-prep">{&amp;TABLENAME}</span><!--src-prep-->.bol-no  <span class="src-keyword">EQ</span><!--src-keyword--> <span class="src-prep">{&amp;TABLENAME}</span><!--src-prep-->.bol-no
                    <span class="src-keyword">AND ROWID</span><!--src-keyword-->(b-<span class="src-prep">{&amp;TABLENAME}</span><!--src-prep-->)  <span class="src-keyword">NE ROWID</span><!--src-keyword-->(<span class="src-prep">{&amp;TABLENAME}</span><!--src-prep-->)) <span class="src-keyword">THEN DO</span><!--src-keyword-->:
 
    <span class="src-keyword">IF</span><!--src-keyword--> old-<span class="src-prep">{&amp;TABLENAME}</span><!--src-prep-->.bol-no <span class="src-keyword">NE</span><!--src-keyword--> <span class="src-prep">{&amp;TABLENAME}</span><!--src-prep-->.bol-no <span class="src-keyword">AND</span><!--src-keyword-->
       old-<span class="src-prep">{&amp;TABLENAME}</span><!--src-prep-->.bol-no <span class="src-keyword">NE</span><!--src-keyword--> <span class="src-number">0</span><!--src-number-->                   <span class="src-keyword">THEN</span><!--src-keyword-->
      lv-bol-no = old-<span class="src-prep">{&amp;TABLENAME}</span><!--src-prep-->.bol-no.
 
    <span class="src-keyword">ELSE RUN</span><!--src-keyword--> oe/oe-bolno.p (<span class="src-prep">{&amp;TABLENAME}</span><!--src-prep-->.company, <span class="src-keyword">OUTPUT</span><!--src-keyword--> lv-bol-no).
 
    <span class="src-prep">{&amp;TABLENAME}</span><!--src-prep-->.bol-no = lv-bol-no.
  <span class="src-keyword">END</span><!--src-keyword-->.
 
  <span class="src-keyword">ELSE</span><!--src-keyword-->
  <span class="src-keyword">FOR EACH</span><!--src-keyword--> b-<span class="src-prep">{&amp;TABLENAME}</span><!--src-prep-->
      <span class="src-keyword">WHERE</span><!--src-keyword--> b-<span class="src-prep">{&amp;TABLENAME}</span><!--src-prep-->.company  <span class="src-keyword">EQ</span><!--src-keyword--> <span class="src-prep">{&amp;TABLENAME}</span><!--src-prep-->.company
        <span class="src-keyword">AND</span><!--src-keyword--> b-<span class="src-prep">{&amp;TABLENAME}</span><!--src-prep-->.bol-no   <span class="src-keyword">EQ</span><!--src-keyword--> <span class="src-prep">{&amp;TABLENAME}</span><!--src-prep-->.bol-no
        <span class="src-keyword">AND</span><!--src-keyword--> b-<span class="src-prep">{&amp;TABLENAME}</span><!--src-prep-->.cust-no  <span class="src-keyword">EQ</span><!--src-keyword--> <span class="src-prep">{&amp;TABLENAME}</span><!--src-prep-->.cust-no
        <span class="src-keyword">AND</span><!--src-keyword--> b-<span class="src-prep">{&amp;TABLENAME}</span><!--src-prep-->.ship-id  <span class="src-keyword">EQ</span><!--src-keyword--> <span class="src-prep">{&amp;TABLENAME}</span><!--src-prep-->.ship-id
        <span class="src-keyword">AND</span><!--src-keyword--> b-<span class="src-prep">{&amp;TABLENAME}</span><!--src-prep-->.posted   <span class="src-keyword">EQ NO</span><!--src-keyword-->
        <span class="src-keyword">AND</span><!--src-keyword--> b-<span class="src-prep">{&amp;TABLENAME}</span><!--src-prep-->.deleted  <span class="src-keyword">EQ NO</span><!--src-keyword-->
        <span class="src-keyword">AND ROWID</span><!--src-keyword-->(b-<span class="src-prep">{&amp;TABLENAME}</span><!--src-prep-->)   <span class="src-keyword">NE ROWID</span><!--src-keyword-->(<span class="src-prep">{&amp;TABLENAME}</span><!--src-prep-->)
      <span class="src-keyword">USE-INDEX</span><!--src-keyword--> bol-no,
 
      <span class="src-keyword">FIRST</span><!--src-keyword--> b-oe-relh
      <span class="src-keyword">WHERE</span><!--src-keyword--> b-oe-relh.company  <span class="src-keyword">EQ</span><!--src-keyword--> b-<span class="src-prep">{&amp;TABLENAME}</span><!--src-prep-->.company
        <span class="src-keyword">AND</span><!--src-keyword--> b-oe-relh.release# <span class="src-keyword">EQ</span><!--src-keyword--> b-<span class="src-prep">{&amp;TABLENAME}</span><!--src-prep-->.release#,
 
      <span class="src-keyword">FIRST</span><!--src-keyword--> oe-relh
      <span class="src-keyword">WHERE</span><!--src-keyword--> oe-relh.company  <span class="src-keyword">EQ</span><!--src-keyword--> <span class="src-prep">{&amp;TABLENAME}</span><!--src-prep-->.company
        <span class="src-keyword">AND</span><!--src-keyword--> oe-relh.release# <span class="src-keyword">EQ</span><!--src-keyword--> <span class="src-prep">{&amp;TABLENAME}</span><!--src-prep-->.release#
      <span class="src-keyword">NO-LOCK</span><!--src-keyword-->:
    <span class="src-comment">/*
    FOR EACH b-oe-rell
        WHERE b-oe-rell.company EQ b-oe-relh.company
          AND b-oe-rell.r-no    EQ b-oe-relh.r-no
        USE-INDEX r-no:
      FOR EACH b-oe-rel
          WHERE b-oe-rel.r-no    EQ b-oe-rell.link-no
            AND b-oe-rel.link-no NE 0:
        b-oe-rel.link-no = oe-relh.r-no.
      END.
      b-oe-rell.r-no = oe-relh.r-no.
    END.
 
    DELETE b-oe-relh.
    */</span><!--src-comment-->
    <span class="src-keyword">FOR EACH</span><!--src-keyword--> b-oe-boll
        <span class="src-keyword">WHERE</span><!--src-keyword--> b-oe-boll.company <span class="src-keyword">EQ</span><!--src-keyword--> b-<span class="src-prep">{&amp;TABLENAME}</span><!--src-prep-->.company
          <span class="src-keyword">AND</span><!--src-keyword--> b-oe-boll.b-no    <span class="src-keyword">EQ</span><!--src-keyword--> b-<span class="src-prep">{&amp;TABLENAME}</span><!--src-prep-->.b-no:
 
      <span class="src-keyword">ASSIGN</span><!--src-keyword-->
       b-oe-boll.b-no     = <span class="src-prep">{&amp;TABLENAME}</span><!--src-prep-->.b-no
       b-oe-boll.bol-no   = <span class="src-prep">{&amp;TABLENAME}</span><!--src-prep-->.bol-no
       b-oe-boll.bol-date = <span class="src-prep">{&amp;TABLENAME}</span><!--src-prep-->.bol-date
       <span class="src-comment">/*b-oe-boll.r-no     = oe-relh.r-no */</span><!--src-comment-->.
    <span class="src-keyword">END</span><!--src-keyword-->.
 
    <span class="src-keyword">FOR EACH</span><!--src-keyword--> b-oe-boll
        <span class="src-keyword">WHERE</span><!--src-keyword--> b-oe-boll.company <span class="src-keyword">EQ</span><!--src-keyword--> b-<span class="src-prep">{&amp;TABLENAME}</span><!--src-prep-->.company
          <span class="src-keyword">AND</span><!--src-keyword--> b-oe-boll.bol-no  <span class="src-keyword">EQ</span><!--src-keyword--> old-<span class="src-prep">{&amp;TABLENAME}</span><!--src-prep-->.bol-no:
 
        b-oe-boll.bol-no = b-<span class="src-prep">{&amp;TABLENAME}</span><!--src-prep-->.bol-no.
    <span class="src-keyword">END</span><!--src-keyword-->.
 
    <span class="src-keyword">ASSIGN</span><!--src-keyword-->
     <span class="src-prep">{&amp;TABLENAME}</span><!--src-prep-->.printed     = <span class="src-keyword">NO</span><!--src-keyword-->
     <span class="src-prep">{&amp;TABLENAME}</span><!--src-prep-->.freight     = <span class="src-prep">{&amp;TABLENAME}</span><!--src-prep-->.freight     + b-<span class="src-prep">{&amp;TABLENAME}</span><!--src-prep-->.freight
     <span class="src-prep">{&amp;TABLENAME}</span><!--src-prep-->.tot-wt      = <span class="src-prep">{&amp;TABLENAME}</span><!--src-prep-->.tot-wt      + b-<span class="src-prep">{&amp;TABLENAME}</span><!--src-prep-->.tot-wt 
     <span class="src-prep">{&amp;TABLENAME}</span><!--src-prep-->.tot-pallets = <span class="src-prep">{&amp;TABLENAME}</span><!--src-prep-->.tot-pallets + b-<span class="src-prep">{&amp;TABLENAME}</span><!--src-prep-->.tot-pallets.
 
    <span class="src-keyword">FOR EACH</span><!--src-keyword--> oe-boll
        <span class="src-keyword">WHERE</span><!--src-keyword--> oe-boll.company <span class="src-keyword">EQ</span><!--src-keyword--> <span class="src-prep">{&amp;TABLENAME}</span><!--src-prep-->.company
          <span class="src-keyword">AND</span><!--src-keyword--> oe-boll.b-no    <span class="src-keyword">EQ</span><!--src-keyword--> <span class="src-prep">{&amp;TABLENAME}</span><!--src-prep-->.b-no:
      oe-boll.printed = <span class="src-keyword">YES</span><!--src-keyword-->.
    <span class="src-keyword">END</span><!--src-keyword-->.
 
    <span class="src-keyword">DELETE</span><!--src-keyword--> b-<span class="src-prep">{&amp;TABLENAME}</span><!--src-prep-->.
  <span class="src-keyword">END</span><!--src-keyword-->.
<span class="src-keyword">END</span><!--src-keyword-->.
 
<span class="src-keyword">IF</span><!--src-keyword--> <span class="src-prep">{&amp;TABLENAME}</span><!--src-prep-->.posted <span class="src-keyword">NE</span><!--src-keyword--> old-<span class="src-prep">{&amp;TABLENAME}</span><!--src-prep-->.posted <span class="src-keyword">THEN</span><!--src-keyword-->
<span class="src-keyword">FOR EACH</span><!--src-keyword--> oe-boll <span class="src-keyword">OF</span><!--src-keyword--> <span class="src-prep">{&amp;TABLENAME}</span><!--src-prep--> <span class="src-keyword">EXCLUSIVE</span><!--src-keyword-->:
  oe-boll.posted = <span class="src-prep">{&amp;TABLENAME}</span><!--src-prep-->.posted.
 
  <span class="src-keyword">RUN</span><!--src-keyword--> oe/rel-stat-upd.p (<span class="src-keyword">ROWID</span><!--src-keyword-->(oe-boll)).
 
  <span class="src-keyword">IF NOT</span><!--src-keyword--> <span class="src-prep">{&amp;TABLENAME}</span><!--src-prep-->.posted <span class="src-keyword">THEN</span><!--src-keyword-->
  <span class="src-keyword">FOR EACH</span><!--src-keyword--> oe-ordl
      <span class="src-keyword">WHERE</span><!--src-keyword--> oe-ordl.company <span class="src-keyword">EQ</span><!--src-keyword--> oe-boll.company
        <span class="src-keyword">AND</span><!--src-keyword--> oe-ordl.ord-no  <span class="src-keyword">EQ</span><!--src-keyword--> oe-boll.ord-no
        <span class="src-keyword">AND</span><!--src-keyword--> oe-ordl.i-no    <span class="src-keyword">EQ</span><!--src-keyword--> oe-boll.i-no
        <span class="src-keyword">AND</span><!--src-keyword--> oe-ordl.<span class="src-keyword">line    EQ</span><!--src-keyword--> oe-boll.<span class="src-keyword">line</span><!--src-keyword-->
        <span class="src-keyword">AND</span><!--src-keyword--> oe-ordl.is-a-component <span class="src-keyword">EQ NO</span><!--src-keyword-->
        <span class="src-keyword">AND CAN-FIND</span><!--src-keyword-->(<span class="src-keyword">FIRST</span><!--src-keyword--> b-oe-ordl <span class="src-prep">{sys/inc/ordlcomp.i b-oe-ordl oe-ordl}</span><!--src-prep-->)
      <span class="src-keyword">NO-LOCK</span><!--src-keyword-->:
 
    <span class="src-keyword">FOR EACH</span><!--src-keyword--> oe-rell <span class="src-keyword">WHERE</span><!--src-keyword--> oe-rell.r-no <span class="src-keyword">EQ</span><!--src-keyword--> oe-boll.r-no
      <span class="src-keyword">AND</span><!--src-keyword--> oe-rell.i-no <span class="src-keyword">EQ</span><!--src-keyword--> oe-boll.i-no 
      <span class="src-keyword">AND</span><!--src-keyword--> oe-rell.loc  <span class="src-keyword">EQ</span><!--src-keyword--> oe-boll.loc <span class="src-keyword">EXCLUSIVE-LOCK</span><!--src-keyword-->:
 
      <span class="src-keyword">FOR EACH</span><!--src-keyword--> oe-rel <span class="src-keyword">WHERE</span><!--src-keyword--> oe-rel.company <span class="src-keyword">EQ</span><!--src-keyword--> oe-boll.company
          <span class="src-keyword">AND</span><!--src-keyword--> oe-rel.r-no <span class="src-keyword">EQ</span><!--src-keyword--> oe-rell.link-no 
          <span class="src-keyword">AND</span><!--src-keyword--> oe-rel.i-no    <span class="src-keyword">EQ</span><!--src-keyword--> oe-rell.i-no 
          <span class="src-keyword">EXCLUSIVE-LOCK USE-INDEX</span><!--src-keyword--> seq-no:
        <span class="src-keyword">DELETE</span><!--src-keyword--> oe-rel.
      <span class="src-keyword">END</span><!--src-keyword-->.
      <span class="src-keyword">DELETE</span><!--src-keyword--> oe-rell.
 
    <span class="src-keyword">END</span><!--src-keyword-->.
    <span class="src-keyword">DELETE</span><!--src-keyword--> oe-boll.
    <span class="src-keyword">LEAVE</span><!--src-keyword-->.
  <span class="src-keyword">END</span><!--src-keyword-->.
<span class="src-keyword">END</span><!--src-keyword-->.
 
<span class="src-keyword">IF</span><!--src-keyword--> <span class="src-prep">{&amp;TABLENAME}</span><!--src-prep-->.posted <span class="src-keyword">EQ NO THEN DO</span><!--src-keyword-->:
  <span class="src-keyword">ASSIGN</span><!--src-keyword-->
   <span class="src-prep">{&amp;TABLENAME}</span><!--src-prep-->.upd-date = <span class="src-keyword">TODAY</span><!--src-keyword-->
   <span class="src-prep">{&amp;TABLENAME}</span><!--src-prep-->.upd-time = <span class="src-keyword">TIME</span><!--src-keyword-->
   <span class="src-prep">{&amp;TABLENAME}</span><!--src-prep-->.<span class="src-keyword">user-id</span><!--src-keyword-->  = <span class="src-keyword">USERID</span><!--src-keyword-->(<span class="src-char">"nosweat"</span><!--src-char-->).
 
  <span class="src-keyword">IF</span><!--src-keyword--> <span class="src-prep">{&amp;TABLENAME}</span><!--src-prep-->.printed     <span class="src-keyword">EQ YES AND</span><!--src-keyword-->
     old-<span class="src-prep">{&amp;TABLENAME}</span><!--src-prep-->.printed <span class="src-keyword">EQ NO  THEN</span><!--src-keyword-->
    <span class="src-keyword">ASSIGN</span><!--src-keyword-->
     <span class="src-prep">{&amp;TABLENAME}</span><!--src-prep-->.prt-date  = <span class="src-keyword">TODAY</span><!--src-keyword-->
     <span class="src-prep">{&amp;TABLENAME}</span><!--src-prep-->.prt-time  = <span class="src-keyword">TIME</span><!--src-keyword-->.
<span class="src-keyword">END</span><!--src-keyword-->.
 
<span class="src-keyword">IF</span><!--src-keyword--> <span class="src-prep">{&amp;TABLENAME}</span><!--src-prep-->.prt-time <span class="src-keyword">NE</span><!--src-keyword--> <span class="src-number">0</span><!--src-number--> <span class="src-keyword">THEN</span><!--src-keyword-->
  <span class="src-prep">{&amp;TABLENAME}</span><!--src-prep-->.prt-timex = <span class="src-keyword">STRING</span><!--src-keyword-->(<span class="src-prep">{&amp;TABLENAME}</span><!--src-prep-->.prt-time,<span class="src-char">"HH:MM:SS"</span><!--src-char-->).
 
<span class="src-keyword">RUN</span><!--src-keyword--> oe/bolhtots.p (<span class="src-keyword">ROWID</span><!--src-keyword-->(<span class="src-prep">{&amp;TABLENAME}</span><!--src-prep-->)).
 
<span class="src-keyword">IF</span><!--src-keyword--> <span class="src-prep">{&amp;TABLENAME}</span><!--src-prep-->.tot-wt <span class="src-keyword">LT</span><!--src-keyword--> <span class="src-number">0</span><!--src-number--> <span class="src-keyword">THEN</span><!--src-keyword--> <span class="src-prep">{&amp;TABLENAME}</span><!--src-prep-->.tot-wt = <span class="src-prep">{&amp;TABLENAME}</span><!--src-prep-->.tot-wt <span class="src-keyword">*</span><!--src-keyword--> <span class="src-number">-1</span><!--src-number-->.
 
<span class="src-comment">/* Clear out any error-status from find with no-error that is false */</span><!--src-comment-->
<span class="src-keyword">DEF VAR</span><!--src-keyword--> ll-error <span class="src-keyword">AS LOG NO-UNDO</span><!--src-keyword-->.
ll-error = <span class="src-keyword">YES NO-ERROR</span><!--src-keyword-->.
 
</div><!--progresscode-->
</body>
</html>
