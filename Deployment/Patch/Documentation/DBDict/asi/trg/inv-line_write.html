<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
  <meta name="generator" content="HtmlDict.w version 11">
  <meta name="author"    content="Patrick Tingen [patrick at tingen dot nl]">
  <link rel="stylesheet" title="Default" type="text/css" href="../../default.css">
  <link rel="alternate stylesheet" title="blue" type="text/css" href="../../blue.css">
  <link rel="alternate stylesheet" title="default" type="text/css" href="../../default.css">
  <link rel="alternate stylesheet" title="green" type="text/css" href="../../green.css">
  <link rel="alternate stylesheet" title="oldstyle" type="text/css" href="../../oldstyle.css">
  <link rel="alternate stylesheet" title="red" type="text/css" href="../../red.css">
  <link rel="shortcut icon" href="../../htmldict.ico">
  <link rel="stylesheet" media="print" type="text/css" href="../../print.css">
  <script src="../../swapstyle.js"    type="text/javascript"></script>
  <script src="../../stylechooser.js" type="text/javascript"></script>
  <script src="../../dbchooser.js"    type="text/javascript"></script>
  <script src="../../htmldict.js"     type="text/javascript"></script>
  <title> Trigger code: write of inv-line</title>
</head>
<body onload="useStyleAgain('HtmlDict');" onunload="rememberStyle('HtmlDict',10);">
<div><a name="top"></a></div>
<table style="width:100%;">
  <tr>
    <td class="navbar" style="width:80%;"><a href="../../../00-index.html"target="_top">DB</a>
 | <a href="../../00-area.html"target="main">Areas</a>
 | <a href="../../00-cross.html"target="main">X-idx</a>
 | <a href="../../00-main.html"target="main">Tables</a>
 | <a href="../../00-sequences.html"target="main">Sequences</a>
</td>
    <td class="navbar" style="width:20%; text-align:right;"><a href="../../htmldict.html"target="_top">HtmlDict 11</a></td>
  </tr>
</table>
 
<h1>Trigger code: write of inv-line</h1>
<div class="progressCode">
<span class="src-prep">&amp;Scoped-define</span><!--src-prep--> ACTION <span class="src-keyword">UPDATE</span><!--src-keyword-->
<span class="src-prep">&amp;Scoped-define</span><!--src-prep--> <span class="src-keyword">DBNAME</span><!--src-keyword--> ASI
<span class="src-prep">&amp;Scoped-define</span><!--src-prep--> TABLENAME inv-line
 
<span class="src-keyword">TRIGGER PROCEDURE FOR WRITE OF</span><!--src-keyword--> <span class="src-prep">{&amp;TABLENAME}</span><!--src-prep--> <span class="src-keyword">OLD BUFFER</span><!--src-keyword--> old-<span class="src-prep">{&amp;TABLENAME}</span><!--src-prep-->.
 
<span class="src-prep">{methods/<span class="src-keyword">triggers</span><!--src-keyword-->/<span class="src-keyword">write</span><!--src-keyword-->.i}</span><!--src-prep-->
 
<span class="src-prep">{custom/globdefs.i}</span><!--src-prep-->
 
<span class="src-prep">{sys/inc/<span class="src-keyword">var</span><!--src-keyword-->.i <span class="src-keyword">NEW</span><!--src-keyword--> SHARED}</span><!--src-p<span class="src-keyword">SHARED</span><!--src-keyword-->
 
<span class="src-keyword">DEF VAR</span><!--src-keyword--> v-invlotline-int <span class="src-keyword">AS INT NO-UNDO</span><!--src-keyword-->.
 
<span class="src-keyword">DEF BUFFER</span><!--src-keyword--> b-<span class="src-prep">{&amp;TABLENAME}</span><!--src-prep--> <span class="src-keyword">FOR</span><!--src-keyword--> <span class="src-prep">{&amp;TABLENAME}</span><!--src-prep-->.
<span class="src-keyword">DEF VAR</span><!--src-keyword--> v-cost <span class="src-keyword">AS DEC EXTENT</span><!--src-keyword--> <span class="src-number">4</span><!--src-number-->.
<span class="src-keyword">DEF VAR</span><!--src-keyword--> v-basis <span class="src-keyword">LIKE</span><!--src-keyword--> sman.commbasis  <span class="src-keyword">INIT</span><!--src-keyword--> <span class="src-char">""</span><!--src-char--> <span class="src-keyword">NO-UNDO</span><!--src-keyword-->.
 
<span class="src-keyword">ASSIGN</span><!--src-keyword-->
 cocode             = g_company
 locode             = g_loc
 .
 
<span class="src-keyword">find first</span><!--src-keyword--> sys-ctrl <span class="src-keyword">where</span><!--src-keyword-->
    sys-ctrl.company <span class="src-keyword">eq</span><!--src-keyword--> cocode <span class="src-keyword">AND</span><!--src-keyword-->
    sys-ctrl.<span class="src-keyword">name    eq</span><!--src-keyword--> <span class="src-char">"INVLOTLINE"</span><!--src-char-->
    <span class="src-keyword">no-lock no-error</span><!--src-keyword-->.
 
<span class="src-keyword">IF AVAIL</span><!--src-keyword--> sys-ctrl <span class="src-keyword">THEN</span><!--src-keyword-->
   v-invlotline-int = sys-ctrl.int-fld.
 
<span class="src-keyword">FOR EACH</span><!--src-keyword--> inv-head <span class="src-keyword">WHERE</span><!--src-keyword--> inv-head.r-no <span class="src-keyword">EQ</span><!--src-keyword--> <span class="src-prep">{&amp;TABLENAME}</span><!--src-prep-->.r-no <span class="src-keyword">NO-LOCK</span><!--src-keyword-->:
  <span class="src-prep">{&amp;TABLENAME}</span><!--src-prep-->.cust-no = inv-head.cust-no.
  <span class="src-keyword">LEAVE</span><!--src-keyword-->.
<span class="src-keyword">END</span><!--src-keyword-->.
 
<span class="src-keyword">FOR EACH</span><!--src-keyword--> oe-ord
    <span class="src-keyword">WHERE</span><!--src-keyword--> oe-ord.company <span class="src-keyword">EQ</span><!--src-keyword--> <span class="src-prep">{&amp;TABLENAME}</span><!--src-prep-->.company
      <span class="src-keyword">AND</span><!--src-keyword--> oe-ord.ord-no  <span class="src-keyword">EQ</span><!--src-keyword--> <span class="src-prep">{&amp;TABLENAME}</span><!--src-prep-->.ord-no
    <span class="src-keyword">NO-LOCK</span><!--src-keyword-->:
 
  <span class="src-keyword">FIND</span><!--src-keyword--> oe-ordl <span class="src-keyword">OF</span><!--src-keyword--> oe-ord
      <span class="src-keyword">WHERE</span><!--src-keyword--> oe-ordl.i-no <span class="src-keyword">EQ</span><!--src-keyword--> <span class="src-prep">{&amp;TABLENAME}</span><!--src-prep-->.i-no
      <span class="src-keyword">NO-LOCK NO-ERROR</span><!--src-keyword-->.
  <span class="src-keyword">IF AVAIL</span><!--src-keyword--> oe-ordl <span class="src-keyword">THEN</span><!--src-keyword--> <span class="src-prep">{&amp;TABLENAME}</span><!--src-prep-->.<span class="src-keyword">line</span><!--src-keyword--> = oe-ordl.<span class="src-keyword">line</span><!--src-keyword-->.
 
  <span class="src-keyword">LEAVE</span><!--src-keyword-->.
<span class="src-keyword">END</span><!--src-keyword-->.
 
<span class="src-keyword">IF TRIM</span><!--src-keyword-->(<span class="src-prep">{&amp;TABLENAME}</span><!--src-prep-->.stat) <span class="src-keyword">EQ</span><!--src-keyword--> <span class="src-char">""</span><!--src-char--> <span class="src-keyword">THEN</span><!--src-keyword--> <span class="src-prep">{&amp;TABLENAME}</span><!--src-prep-->.stat = <span class="src-char">"B"</span><!--src-char-->.
 
<span class="src-keyword">IF</span><!--src-keyword--> <span class="src-prep">{&amp;TABLENAME}</span><!--src-prep-->.ord-no <span class="src-keyword">NE</span><!--src-keyword--> <span class="src-number">0</span><!--src-number-->  <span class="src-keyword">AND</span><!--src-keyword-->
   <span class="src-prep">{&amp;TABLENAME}</span><!--src-prep-->.i-no   <span class="src-keyword">NE</span><!--src-keyword--> <span class="src-char">""</span><!--src-char--> <span class="src-keyword">THEN</span><!--src-keyword-->
<span class="src-keyword">FOR EACH</span><!--src-keyword--> oe-rel
    <span class="src-keyword">WHERE</span><!--src-keyword--> oe-rel.company <span class="src-keyword">EQ</span><!--src-keyword--> <span class="src-prep">{&amp;TABLENAME}</span><!--src-prep-->.company
      <span class="src-keyword">AND</span><!--src-keyword--> oe-rel.ord-no  <span class="src-keyword">EQ</span><!--src-keyword--> <span class="src-prep">{&amp;TABLENAME}</span><!--src-prep-->.ord-no
      <span class="src-keyword">AND</span><!--src-keyword--> oe-rel.i-no    <span class="src-keyword">EQ</span><!--src-keyword--> <span class="src-prep">{&amp;TABLENAME}</span><!--src-prep-->.i-no
      <span class="src-keyword">AND</span><!--src-keyword--> oe-rel.<span class="src-keyword">line    EQ</span><!--src-keyword--> <span class="src-prep">{&amp;TABLENAME}</span><!--src-prep-->.<span class="src-keyword">line</span><!--src-keyword-->
      <span class="src-keyword">AND</span><!--src-keyword--> oe-rel.link-no <span class="src-keyword">EQ</span><!--src-keyword--> <span class="src-number">0</span><!--src-number-->
      <span class="src-keyword">AND</span><!--src-keyword--> oe-rel.rel-no  <span class="src-keyword">EQ</span><!--src-keyword--> <span class="src-number">0</span><!--src-number-->
      <span class="src-keyword">AND</span><!--src-keyword--> oe-rel.r-no    <span class="src-keyword">GT</span><!--src-keyword--> <span class="src-number">0</span><!--src-number-->
    <span class="src-keyword">USE-INDEX</span><!--src-keyword--> ord-item,
    <span class="src-keyword">FIRST</span><!--src-keyword--> oe-rell
    <span class="src-keyword">WHERE</span><!--src-keyword--> oe-rell.company <span class="src-keyword">EQ</span><!--src-keyword--> <span class="src-prep">{&amp;TABLENAME}</span><!--src-prep-->.company
      <span class="src-keyword">AND</span><!--src-keyword--> oe-rell.ord-no  <span class="src-keyword">EQ</span><!--src-keyword--> <span class="src-prep">{&amp;TABLENAME}</span><!--src-prep-->.ord-no
      <span class="src-keyword">AND</span><!--src-keyword--> oe-rell.i-no    <span class="src-keyword">EQ</span><!--src-keyword--> <span class="src-prep">{&amp;TABLENAME}</span><!--src-prep-->.i-no
      <span class="src-keyword">AND</span><!--src-keyword--> oe-rell.<span class="src-keyword">line    EQ</span><!--src-keyword--> <span class="src-prep">{&amp;TABLENAME}</span><!--src-prep-->.<span class="src-keyword">line</span><!--src-keyword-->
      <span class="src-keyword">AND</span><!--src-keyword--> oe-rell.link-no <span class="src-keyword">EQ</span><!--src-keyword--> oe-rel.r-no
      <span class="src-keyword">AND CAN-FIND</span><!--src-keyword-->(<span class="src-keyword">FIRST</span><!--src-keyword--> oe-relh
                   <span class="src-keyword">WHERE</span><!--src-keyword--> oe-relh.r-no <span class="src-keyword">EQ</span><!--src-keyword--> oe-rell.r-no
                     <span class="src-keyword">AND</span><!--src-keyword--> oe-relh.posted <span class="src-keyword">EQ YES</span><!--src-keyword-->)
    <span class="src-keyword">USE-INDEX</span><!--src-keyword--> ord-no <span class="src-keyword">NO-LOCK</span><!--src-keyword-->:
 
  <span class="src-keyword">ASSIGN</span><!--src-keyword-->
   oe-rel.link-no  = oe-rell.r-no
   oe-rel.rel-no   = oe-rell.rel-no
   oe-rel.b-ord-no = oe-rell.b-ord-no.
<span class="src-keyword">END</span><!--src-keyword-->.
 
<span class="src-comment">/* Change Customer PO on BOLs &amp; releases if changed on invoice */</span><!--src-comment-->
<span class="src-keyword">IF</span><!--src-keyword--> <span class="src-prep">{&amp;TABLENAME}</span><!--src-prep-->.po-no <span class="src-keyword">NE</span><!--src-keyword--> old-<span class="src-prep">{&amp;TABLENAME}</span><!--src-prep-->.po-no <span class="src-keyword">THEN</span><!--src-keyword-->
  <span class="src-keyword">RUN</span><!--src-keyword--> oe/invlinpo.p (<span class="src-keyword">BUFFER</span><!--src-keyword--> <span class="src-prep">{&amp;TABLENAME}</span><!--src-prep-->, old-<span class="src-prep">{&amp;TABLENAME}</span><!--src-prep-->.po-no).
 
 
<span class="src-keyword">FOR EACH</span><!--src-keyword--> inv-head <span class="src-keyword">OF</span><!--src-keyword--> <span class="src-prep">{&amp;TABLENAME}</span><!--src-prep-->
    <span class="src-keyword">WHERE NOT</span><!--src-keyword--> inv-head.multi-invoice <span class="src-keyword">NO-LOCK</span><!--src-keyword-->,
    <span class="src-keyword">FIRST</span><!--src-keyword--> cust
    <span class="src-keyword">WHERE</span><!--src-keyword--> cust.company <span class="src-keyword">EQ</span><!--src-keyword--> inv-head.company
      <span class="src-keyword">AND</span><!--src-keyword--> cust.cust-no <span class="src-keyword">EQ</span><!--src-keyword--> inv-head.cust-no
    <span class="src-keyword">NO-LOCK</span><!--src-keyword-->,
    <span class="src-keyword">FIRST</span><!--src-keyword--> itemfg
    <span class="src-prep">{sys/look/itemfgrlW.i}</span><!--src-prep-->
      <span class="src-keyword">AND</span><!--src-keyword--> itemfg.i-no <span class="src-keyword">eq</span><!--src-keyword--> <span class="src-prep">{&amp;TABLENAME}</span><!--src-prep-->.i-no
    <span class="src-keyword">NO-LOCK</span><!--src-keyword-->:
 
    <span class="src-keyword">RUN</span><!--src-keyword--> Conv_CalcTotalPrice(<span class="src-prep">{&amp;TABLENAME}</span><!--src-prep-->.company, 
                        <span class="src-prep">{&amp;TABLENAME}</span><!--src-prep-->.i-no,
                        <span class="src-prep">{&amp;TABLENAME}</span><!--src-prep-->.qty,
                        <span class="src-prep">{&amp;TABLENAME}</span><!--src-prep-->.price,
                        <span class="src-prep">{&amp;TABLENAME}</span><!--src-prep-->.pr-uom,
                        <span class="src-prep">{&amp;TABLENAME}</span><!--src-prep-->.disc,
                        <span class="src-prep">{&amp;TABLENAME}</span><!--src-prep-->.cas-cnt,    
                        <span class="src-keyword">OUTPUT</span><!--src-keyword--> <span class="src-prep">{&amp;TABLENAME}</span><!--src-prep-->.t-price).
<span class="src-comment">/*  {&amp;TABLENAME}.t-price = {&amp;TABLENAME}.inv-qty / 1000 * {&amp;TABLENAME}.price.                                      */</span><!--src-comment-->
<span class="src-comment">/*                                                                                                                */</span><!--src-comment-->
<span class="src-comment">/*  IF {&amp;TABLENAME}.pr-uom BEGINS "L" AND {&amp;TABLENAME}.pr-uom NE "LB" THEN                                        */</span><!--src-comment-->
<span class="src-comment">/*    {&amp;TABLENAME}.t-price = {&amp;TABLENAME}.price *                                                                 */</span><!--src-comment-->
<span class="src-comment">/*                           IF {&amp;TABLENAME}.inv-qty LT 0 THEN -1 ELSE IF {&amp;TABLENAME}.inv-qty EQ 0 THEN 0 ELSE 1.*/</span><!--src-comment-->
<span class="src-comment">/*                                                                                                                */</span><!--src-comment-->
<span class="src-comment">/*  ELSE                                                                                                          */</span><!--src-comment-->
<span class="src-comment">/*  IF {&amp;TABLENAME}.pr-uom EQ "CS" THEN                                                                           */</span><!--src-comment-->
<span class="src-comment">/*    {&amp;TABLENAME}.t-price = {&amp;TABLENAME}.inv-qty /                                                               */</span><!--src-comment-->
<span class="src-comment">/*                           (IF {&amp;TABLENAME}.cas-cnt NE 0 THEN                                                   */</span><!--src-comment-->
<span class="src-comment">/*                             {&amp;TABLENAME}.cas-cnt                                                               */</span><!--src-comment-->
<span class="src-comment">/*                            ELSE                                                                                */</span><!--src-comment-->
<span class="src-comment">/*                            IF itemfg.case-count NE 0 THEN                                                      */</span><!--src-comment-->
<span class="src-comment">/*                              itemfg.case-count ELSE 1) *                                                       */</span><!--src-comment-->
<span class="src-comment">/*                           {&amp;TABLENAME}.price.                                                                  */</span><!--src-comment-->
<span class="src-comment">/*  ELSE                                                                                                          */</span><!--src-comment-->
<span class="src-comment">/*  IF LOOKUP({&amp;TABLENAME}.pr-uom,fg-uom-list) GT 0 THEN                                                          */</span><!--src-comment-->
<span class="src-comment">/*    {&amp;TABLENAME}.t-price = {&amp;TABLENAME}.inv-qty * {&amp;TABLENAME}.price.                                           */</span><!--src-comment-->
<span class="src-comment">/*                                                                                                                */</span><!--src-comment-->
<span class="src-comment">/*  ELSE                                                                                                          */</span><!--src-comment-->
<span class="src-comment">/*  FOR EACH uom                                                                                                  */</span><!--src-comment-->
<span class="src-comment">/*      WHERE uom.uom  EQ {&amp;TABLENAME}.pr-uom                                                                     */</span><!--src-comment-->
<span class="src-comment">/*        AND uom.mult NE 0                                                                                       */</span><!--src-comment-->
<span class="src-comment">/*      NO-LOCK:                                                                                                  */</span><!--src-comment-->
<span class="src-comment">/*    {&amp;TABLENAME}.t-price = {&amp;TABLENAME}.inv-qty / uom.mult * {&amp;TABLENAME}.price.                                */</span><!--src-comment-->
<span class="src-comment">/*    LEAVE.                                                                                                      */</span><!--src-comment-->
<span class="src-comment">/*  END.                                                                                                          */</span><!--src-comment-->
<span class="src-comment">/*                                                                                                                */</span><!--src-comment-->
<span class="src-comment">/*  {&amp;TABLENAME}.t-price = ROUND({&amp;TABLENAME}.t-price,2).                                                         */</span><!--src-comment-->
<span class="src-comment">/*                                                                                                                */</span><!--src-comment-->
<span class="src-comment">/*                                                                                                                */</span><!--src-comment-->
<span class="src-comment">/*  IF {&amp;TABLENAME}.t-price NE 0                                              AND                                 */</span><!--src-comment-->
<span class="src-comment">/*     {&amp;TABLENAME}.pr-uom BEGINS "L"                                         AND                                 */</span><!--src-comment-->
<span class="src-comment">/*     {&amp;TABLENAME}.pr-uom NE "LB"                                            AND                                 */</span><!--src-comment-->
<span class="src-comment">/*     v-invlotline-int = 0                                                   AND                                 */</span><!--src-comment-->
<span class="src-comment">/*     AVAIL oe-ordl                                                          AND                                 */</span><!--src-comment-->
<span class="src-comment">/*     ((oe-ordl.qty GT 0 AND oe-ordl.inv-qty - {&amp;TABLENAME}.inv-qty GT 0) OR                                     */</span><!--src-comment-->
<span class="src-comment">/*      (oe-ordl.qty LT 0 AND oe-ordl.inv-qty - {&amp;TABLENAME}.inv-qty LT 0))                          THEN         */</span><!--src-comment-->
<span class="src-comment">/*    {&amp;TABLENAME}.t-price = 0.                                                                                   */</span><!--src-comment-->
<span class="src-comment">/*                                                                                                                */</span><!--src-comment-->
<span class="src-comment">/*  IF {&amp;TABLENAME}.disc NE 0 THEN                                                                                */</span><!--src-comment-->
<span class="src-comment">/*    {&amp;TABLENAME}.t-price =                                                                                      */</span><!--src-comment-->
<span class="src-comment">/*        IF ll-calc-disc-first THEN                                                                              */</span><!--src-comment-->
<span class="src-comment">/*          ({&amp;TABLENAME}.t-price - ROUND({&amp;TABLENAME}.t-price * {&amp;TABLENAME}.disc / 100,2))                      */</span><!--src-comment-->
<span class="src-comment">/*        ELSE                                                                                                    */</span><!--src-comment-->
<span class="src-comment">/*          ROUND({&amp;TABLENAME}.t-price * (1 - ({&amp;TABLENAME}.disc / 100)),2).                                      */</span><!--src-comment-->
 
  <span class="src-keyword">IF</span><!--src-keyword--> <span class="src-prep">{&amp;TABLENAME}</span><!--src-prep-->.ord-no <span class="src-keyword">NE</span><!--src-keyword--> <span class="src-number">0</span><!--src-number--> <span class="src-keyword">THEN</span><!--src-keyword-->
    <span class="src-keyword">RUN</span><!--src-keyword--> oe/GetCostInvl.p (<span class="src-keyword">ROWID</span><!--src-keyword-->(<span class="src-prep">{&amp;TABLENAME}</span><!--src-prep-->),
                       <span class="src-keyword">OUTPUT</span><!--src-keyword--> v-cost[1], <span class="src-keyword">OUTPUT</span><!--src-keyword--> v-cost[2],
                       <span class="src-keyword">OUTPUT</span><!--src-keyword--> v-cost[3], <span class="src-keyword">OUTPUT</span><!--src-keyword--> v-cost[4],
                       <span class="src-keyword">OUTPUT</span><!--src-keyword--> <span class="src-prep">{&amp;TABLENAME}</span><!--src-prep-->.cost, <span class="src-keyword">OUTPUT</span><!--src-keyword--> <span class="src-prep">{&amp;TABLENAME}</span><!--src-prep-->.spare-char-2, 
                       <span class="src-keyword">OUTPUT</span><!--src-keyword--> <span class="src-prep">{&amp;TABLENAME}</span><!--src-prep-->.t-cost, <span class="src-keyword">OUTPUT</span><!--src-keyword--> <span class="src-prep">{&amp;TABLENAME}</span><!--src-prep-->.spare-char-1,
                       <span class="src-keyword">OUTPUT</span><!--src-keyword--> <span class="src-prep">{&amp;TABLENAME}</span><!--src-prep-->.costStdFreight, <span class="src-keyword">OUTPUT</span><!--src-keyword--> <span class="src-prep">{&amp;TABLENAME}</span><!--src-prep-->.costStdWarehouse, <span class="src-keyword">OUTPUT</span><!--src-keyword--> <span class="src-prep">{&amp;TABLENAME}</span><!--src-prep-->.costStdDeviation, <span class="src-keyword">OUTPUT</span><!--src-keyword--> <span class="src-prep">{&amp;TABLENAME}</span><!--src-prep-->.costStdManufacture).
 
  <span class="src-keyword">DO</span><!--src-keyword--> i = <span class="src-number">1</span><!--src-number--> <span class="src-keyword">TO EXTENT</span><!--src-keyword-->(<span class="src-prep">{&amp;TABLENAME}</span><!--src-prep-->.sman):    <span class="src-comment">/** Calculate Commission Amount **/</span><!--src-comment-->
    <span class="src-keyword">RUN</span><!--src-keyword--> custom/combasis.p (cocode, <span class="src-prep">{&amp;TABLENAME}</span><!--src-prep-->.sman[i], cust.<span class="src-keyword">type</span><!--src-keyword-->, itemfg.procat, <span class="src-number">0</span><!--src-number-->,
                           cust.cust-no,
                           <span class="src-keyword">OUTPUT</span><!--src-keyword--> v-basis).
 
    <span class="src-keyword">IF</span><!--src-keyword--> v-basis <span class="src-keyword">EQ</span><!--src-keyword--> <span class="src-char">"G"</span><!--src-char--> <span class="src-keyword">THEN</span><!--src-keyword-->
      <span class="src-prep">{&amp;TABLENAME}</span><!--src-prep-->.comm-amt[i] = <span class="src-keyword">ROUND</span><!--src-keyword-->(((<span class="src-prep">{&amp;TABLENAME}</span><!--src-prep-->.t-price <span class="src-keyword">-</span><!--src-keyword--> <span class="src-prep">{&amp;TABLENAME}</span><!--src-prep-->.t-cost)
                                       <span class="src-keyword">*</span><!--src-keyword--> <span class="src-prep">{&amp;TABLENAME}</span><!--src-prep-->.s-comm[i]) / <span class="src-number">100</span><!--src-number-->,<span class="src-number">2</span><!--src-number-->).
 
    <span class="src-keyword">ELSE</span><!--src-keyword-->
      <span class="src-prep">{&amp;TABLENAME}</span><!--src-prep-->.comm-amt[i] = <span class="src-keyword">ROUND</span><!--src-keyword-->((((<span class="src-prep">{&amp;TABLENAME}</span><!--src-prep-->.t-price
                                       <span class="src-keyword">*</span><!--src-keyword--> <span class="src-prep">{&amp;TABLENAME}</span><!--src-prep-->.s-pct[i]) / <span class="src-number">100</span><!--src-number-->)
                                       <span class="src-keyword">*</span><!--src-keyword--> <span class="src-prep">{&amp;TABLENAME}</span><!--src-prep-->.s-comm[i]) / <span class="src-number">100</span><!--src-number-->,<span class="src-number">2</span><!--src-number-->).
  <span class="src-keyword">END</span><!--src-keyword-->.
 
  <span class="src-keyword">RUN</span><!--src-keyword--> oe/oeinvup2.p (<span class="src-keyword">ROWID</span><!--src-keyword-->(inv-head), <span class="src-keyword">INPUT NO</span><!--src-keyword-->).
 
  <span class="src-keyword">LEAVE</span><!--src-keyword-->.
<span class="src-keyword">END</span><!--src-keyword-->.
 
<span class="src-comment">/* Clear out any error-status from find with no-error that is false */</span><!--src-comment-->
<span class="src-keyword">DEF VAR</span><!--src-keyword--> ll-error <span class="src-keyword">AS LOG NO-UNDO</span><!--src-keyword-->.
ll-error = <span class="src-keyword">YES NO-ERROR</span><!--src-keyword-->.
</div><!--progresscode-->
</body>
</html>
